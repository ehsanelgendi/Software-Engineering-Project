Body-cleaned
"<p>In Swing, the password field has a <code>getPassword()</code> (returns <code>char[]</code>) method instead of the usual <code>getText()</code> (returns <code>String</code>) method. Similarly, I have come across a suggestion not to use <code>String</code> to handle passwords.</p><p>Why does <code>String</code> pose a threat to security when it comes to passwords?It feels inconvenient to use <code>char[]</code>.</p>"
"<p>What are the best workarounds for using a SQL <code>IN</code> clause with instances of <code>java.sql.PreparedStatement</code>, which is not supported for multiple values due to SQL injection attack security issues: One <code>?</code> placeholder represents one value, rather than a list of values.</p><p>Consider the following SQL statement:</p><pre><code>SELECT my_column FROM my_table where search_column IN (?)</code></pre><p>Using <code>preparedStatement.setString( 1, ""'A', 'B', 'C'"" );</code> is essentially a non-working attempt at a workaround of the reasons for using <code>?</code> in the first place.  </p><p>What workarounds are available?</p>"
<p>I'm trying to retrieve a file from a server using SFTP (as opposed to FTPS) using Java. How can I do this?</p>
"<p>My team got handed over some server side code (in Java) that generates random tokens and I have a question regarding the same -</p><p>The purpose of these tokens is fairly sensitive - used for session id, password reset links etc. So they do need to be cryptographically random to avoid somebody guessing them or brute force them feasibly. The token is a ""long"" so it is 64 bits long.</p><p>The code currently uses the <code>java.util.Random</code> class to generate these tokens. The documentation ([<a href=""http://docs.oracle.com/javase/7/docs/api/java/util/Random.html][1]"" rel=""noreferrer"">http://docs.oracle.com/javase/7/docs/api/java/util/Random.html][1]</a>) for <code>java.util.Random</code> clearly states the following: </p><blockquote>  <p>Instances of java.util.Random are not cryptographically secure. Consider instead using SecureRandom to get a cryptographically secure pseudo-random number generator for use by security-sensitive applications.</p></blockquote><p>However, the way the code is currently using <code>java.util.Random</code> is this - It instantiates the <code>java.security.SecureRandom</code> class and then uses the <code>SecureRandom.nextLong()</code> method to obtain the seed that is used for instantiating the <code>java.util.Random</code>class. Then it uses <code>java.util.Random.nextLong()</code> method to generate the token.</p><p>So my question now - Is it still insecure given that the <code>java.util.Random</code> is being seeded using <code>java.security.SecureRandom</code>? Do I need to modify the code so that it uses <code>java.security.SecureRandom</code> exclusively to generate the tokens?</p><p>Currently the code seed's the <code>Random</code> once at startup</p>"
"<p>If you want a cryptographically strong random number in Java, you use <code>SecureRandom</code>. Unfortunately, <code>SecureRandom</code> can be very slow. If it uses <code>/dev/random</code> on Linux, it can block waiting for sufficient entropy to build up. How do you avoid the performance penalty?</p><p>Has anyone used <a href=""https://uncommons-maths.dev.java.net/"" rel=""noreferrer"">Uncommon Maths</a> as a solution to this problem?</p><p>Can anybody confirm that this performance problem has been solved in JDK 6?</p>"
"<p>In the context of security frameworks, a few terms commonly occur <strong>subject</strong>, <strong>user</strong> and <strong>principal</strong>, of which I have not been able to find a clear definition and the difference between them. </p><p>So, what exactly do these terms mean, and why are these distinctions of <strong>subject</strong> and <strong>principal</strong> needed?</p>"
<p>I have a program that reads server information from a configuration file and would like to encrypt the password in that configuration that can be read by my program and decrypted.</p><p>Requirments:</p><ul><li>Encrypt plaintext password to be stored in the file</li><li>Decrypt the encrypted password read in from the file from my program</li></ul><p>Any reccomendations on how i would go about doing this? I was thinking of writing my own algorithm but i feel it would be terribly insecure.</p>
"<p>My company has been evaluating Spring MVC to determine if we should use it in one of our next projects. So far I love what I've seen, and right now I'm taking a look at the Spring Security module to determine if it's something we can/should use. </p><p>Our security requirements are pretty basic; a user just needs to be able to provide a username and password to be able to access certain parts of the site (such as to get info about their account); and there are a handful of pages on the site (FAQs, Support, etc) where an anonymous user should be given access.</p><p>In the prototype I've been creating, I have been storing a ""LoginCredentials"" object (which just contains username and password) in Session for an authenticated user; some of the controllers check to see if this object is in session to get a reference to the logged-in username, for example. I'm looking to replace this home-grown logic with Spring Security instead, which would have the nice benefit of removing any sort of ""how do we track logged in users?"" and ""how do we authenticate users?"" from my controller/business code. </p><p>It seems like Spring Security provides a (per-thread) ""context"" object to be able to access the username/principal info from anywhere in your app...</p><pre><code>Object principal = SecurityContextHolder.getContext().getAuthentication().getPrincipal();</code></pre><p>... which seems very un-Spring like as this object is a (global) singleton, in a way.</p><p>My question is this: if this is the standard way to access information about the authenticated user in Spring Security, what is the accepted way to inject an Authentication object into the SecurityContext so that it is available for my unit tests when the unit tests require an authenticated user?</p><p>Do I need to wire this up in the initialization method of each test case?</p><pre><code>protected void setUp() throws Exception {    ...    SecurityContextHolder.getContext().setAuthentication(        new UsernamePasswordAuthenticationToken(testUser.getLogin(), testUser.getPassword()));    ...}</code></pre><p>This seems overly verbose. Is there an easier way? </p><p>The <code>SecurityContextHolder</code> object itself seems very un-Spring-like...</p>"
"<p>By looking at the file <code>java.security</code> of my <code>JRE</code>, I see that the keystore type to use by default is set to <code>JKS</code>. <a href=""http://docs.oracle.com/javase/6/docs/technotes/guides/security/StandardNames.html#KeyStore"" rel=""noreferrer"">Here</a>, there is a list of the keystore types that can be used.</p><p>Is there a recommended keystore type? What are the pros/cons of the different keystore types?</p>"
<p>I am having a hard time understanding JAAS. It all seems more complicated than it should be (especially the Sun tutorials). I need a simple tutorial or example on how to implement security (authentication + authorization) in java application based on Struts + Spring + Hibernate with custom user repository. Can be implemented using ACEGI.</p>
<p>Java <code>.class</code> files can be decompiled fairly easily. How can I protect my database if I have to use the login data in the code?</p>
"<p>After reading Jeff's blog post on <a href=""http://www.codinghorror.com/blog/archives/001167.html"" rel=""noreferrer"">Protecting Your Cookies: HttpOnly</a>. I'd like to implement HttpOnly cookies in my web application.</p><p>How do you tell tomcat to use http only cookies for sessions?</p>"
"<p>When you google for this exception: <code>java.security.InvalidAlgorithmParameterException: the trustAnchors parameter must be non-empty</code>, multiple results appear. However there is no definitive solution, only guesses.</p><p>The problem arises (in my case at least) when I try to use open a connection over SSL. It works fine on my windows machine, but when I deploy it to the linux machine (with sun's jre installed) it fails with the above exception.</p><p>The problem is that the default truststore of the JRE is empty for some reason (size of only 32 bytes, whereas it is 80kb on windows).</p><p>When I copied my <code>jre/lib/security/cacerts</code> file from windows to linux, it worked fine.</p><p>The question is - why is the linux jre having an empty trust store?</p><p>Note that this happens on an Amazon EC2 instance, with the AMI linux, so it might be due to some amazon policies (I think java was pre-installed, but I'm not sure)</p>"
"<p>I'm trying to run this simple HelloWorld code written in Java from my browser (<a href=""http://en.wikipedia.org/wiki/Google_Chrome"">Chrome</a>):</p><pre><code>public class HelloWorld extends JApplet {public void init() {    try {        SwingUtilities.invokeAndWait(new Runnable() {            public void run() {                JLabel lbl = new JLabel(""Hello World"");                add(lbl);            }        });    }    catch (Exception e) {        System.err.println(""createGUI didn't complete successfully"");    }}</code></pre><p>I compiled it with <a href=""http://en.wikipedia.org/wiki/NetBeans"">NetBeans</a>, and then I created a WebApplication project. The <a href=""http://en.wikipedia.org/wiki/HTML"">HTML</a> code that runs the applet is:</p><pre><code>&lt;html&gt;    &lt;head&gt;        &lt;title&gt;&lt;/title&gt;        &lt;meta http-equiv=""Content-Type"" content=""text/html; charset=UTF-8""&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;p&gt;&lt;applet code=""HelloWorld"" archive=""applet_HelloWorld.jar""  width=""590"" height=""530""&gt;&lt;/applet&gt;&lt;/p&gt;    &lt;/body&gt;&lt;/html&gt;</code></pre><p>If run the applet from NetBeans it works. But when I run the HTML code by double clicking it, the following message pops up from the browser:</p><blockquote>  <p>Your security settings have blocked a local application from running. </p></blockquote><p>I tried with Internet&nbsp;Explorer and Firefox but nothing.</p><p>This message started to appear after the last update of Java. Where is the problem?</p>"
<p>How can I prevent XSS attacks in a JSP/Servlet web application?</p>
"<p>These may be phrased as separate questions for clarity, but they are all related to the same issue.</p><p>How are SSL certificate server names resolved?</p><p>Why do browsers seem to use the CN field of the certificate, but Java's mechanism seem to only look at ""subject alternative names"" only?</p><p>Is it possible to add alternative names to a SSL certificate using keytool?If not, is using openSSL instead a good option??</p><p><strong>Just a little background:</strong> I need to get a main server to communicate with several servers using HTTPS. Obviously, we don't want to buy SSL certificates for every server (there could be many), so I want to use self-signed certificates (I have been using keytool to generate them). After I add the certificates as trusted in the OS, the browsers (IE and Chrome) happily accept the connection as trusted. However, even after adding the certificates to Java's cacerts, Java still won't accept the connection as trusted and throws the following Exception:</p><blockquote>  <p>Caused by: java.security.cert.CertificateException: No subject alternative names   present          at sun.security.util.HostnameChecker.matchIP(HostnameChecker.java:142)          at sun.security.util.HostnameChecker.match(HostnameChecker.java:75)          at com.sun.net.ssl.internal.ssl.X509TrustManagerImpl.checkIdentity(X509T  rustManagerImpl.java:264)          at com.sun.net.ssl.internal.ssl.X509TrustManagerImpl.checkServerTrusted(  X509TrustManagerImpl.java:250)          at com.sun.net.ssl.internal.ssl.ClientHandshaker.serverCertificate(Clien  tHandshaker.java:1185)          ... 14 more</p></blockquote><p>I found that I can make Java trust the certificate implementing my own HostNameVerifier, which I copied from here: <a href=""http://searchcode.com/codesearch/view/43177932/"">com.sun.jbi.internal.security.https.DefaultHostnameVerifier</a> just to test (by the way, the hostname passed as an argument to the HostnameVerifier is correct, so I think it should have been accepted).</p><p>I have been using the certificate field CN as the hostname (usually the IP address).</p><p>Can anybody please tell me if I am doing something wrong and point me in the right direction? </p>"
"<p>I have a java application that connects to a database.<br>The user name and password for the database are stored in a properties file.<br>What is the common practice to avoid storing the password in cleartext in the properties file while still retaining the option to let the user change it?<br>The main motivation here is to prevent someone looking over the admin's shoulder and seeing the password while the admin is editing the properties file.<br>I read <a href=""https://stackoverflow.com/q/4155187/162056"">here</a> that there's a built in way to do it in C#.<br>Knowing java, I don't expect to find a built in solution but I'd like to hear what other people are doing.<br>If I don't find any good choice then I am probably going to encrypt it with a constant password that will be kept in the code. But I'd hate to do it this way because it feels wrong.</p><p><strong>Edit Dec 12th 2012</strong>Looks like there is no magic and I must store the password in the code or something similar.At the end we implemented something very similar to what Jasypt that was mentioned in one of the answers does.So I'm accepting the Jasypt answer because it is the closest thing to a definite answer.</p>"
"<p>I am looking on how how to obtain the location of <code>cacerts</code> of the default java installation, when you do not have <code>JAVA_HOME</code> or <code>JRE_HOME</code> defined.</p><p>I need a solution that works at least for <code>OS X</code> and <code>Linux</code>.</p><p>Yes. <code>java -v</code> is assumed to work :)</p>"
"<p>I've been working on a program to extract information from a dynamic web application, and the program worked fine until I set my tomcat server to use SSL using a self-signed(thus, untrusted) certificate. The stack trace of the error is:</p><pre><code>javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested targetError: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target        at com.sun.net.ssl.internal.ssl.Alerts.getSSLException(Alerts.java:150)        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.fatal(SSLSocketImpl.java:1584)        at com.sun.net.ssl.internal.ssl.Handshaker.fatalSE(Handshaker.java:174)        at com.sun.net.ssl.internal.ssl.Handshaker.fatalSE(Handshaker.java:168)        at com.sun.net.ssl.internal.ssl.ClientHandshaker.serverCertificate(ClientHandshaker.java:848)        at com.sun.net.ssl.internal.ssl.ClientHandshaker.processMessage(ClientHandshaker.java:106)        at com.sun.net.ssl.internal.ssl.Handshaker.processLoop(Handshaker.java:495)        at com.sun.net.ssl.internal.ssl.Handshaker.process_record(Handshaker.java:433)        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:877)        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.performInitialHandshake(SSLSocketImpl.java:1089)        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1116)        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1100)        at sun.net.www.protocol.https.HttpsClient.afterConnect(HttpsClient.java:402)        at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:170)        at sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:857)        at sun.net.www.protocol.https.HttpsURLConnectionImpl.getOutputStream(HttpsURLConnectionImpl.java:230)        at com.certicom.gls.glscs.nongui.URLReader$PostURL.setupURL(URLReader.java:34)        at com.certicom.gls.glscs.nongui.URLReader.getLogin(URLReader.java:227)        at com.certicom.gls.glscs.nongui.URLReader.testLogin(URLReader.java:436)        at com.certicom.gls.glscs.nongui.Controller.loginMenu(Controller.java:384)        at com.certicom.gls.glscs.nongui.Controller.menu(Controller.java:324)        at com.certicom.gls.glscs.nongui.Controller.&lt;init&gt;(Controller.java:49)        at com.certicom.gls.glscs.nongui.Controller.main(Controller.java:61)</code></pre><p>In a web browser, the user is prompted a warning when accessing a HTTPS site with an untrusted certificate, and asked to make an exception if he likes to proceed; I would like to implement a similar functionality for my command-line application... I admit that I am new to socket programming and networking in general; any advice solving this problem will be great!</p>"
"<p>It's common knowledge that Java <code>String</code>s are immutable. Immutable Strings are great addition to java since its inception. Immutability allows fast access and a lot of optimizations, significantly less error-prone compared to C-style strings, and helps enforce the security model.</p><p>It's possible to create a mutable one without using hacks, namely</p><ul><li><code>java.lang.reflect</code></li><li><code>sun.misc.Unsafe</code></li><li>Classes in bootstrap classloader</li><li>JNI (or JNA as it requires JNI)</li></ul><p>But is it possible in just plain Java, so that the string can be modified at any time? The question is <em>How</em>?</p>"
"<p>The jar (bcprov-jdk16-145.jar) has been added to the project, <code>Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider())</code> has been added to the class, and <code>BouncyCastleProvider.PROVIDER_NAME</code> does return ""BC"" but AesFileIo.writeFile() still throws <code>java.security.NoSuchProviderException No such provider: BC</code>. Any ideas?</p><pre><code>import java.io.FileOutputStream;import java.io.InputStreamReader;import java.io.ObjectOutputStream;import javax.crypto.Cipher;import javax.crypto.spec.IvParameterSpec;import javax.crypto.spec.SecretKeySpec;import org.bouncycastle.jce.provider.BouncyCastleProvider;public class AesFileIo {    private static final String AES_ALGORITHM = ""AES/CTR/NoPadding"";    private static final String PROVIDER = BouncyCastleProvider.PROVIDER_NAME;    private static final byte[] AES_KEY_128 = { // Hard coded for now        78, -90, 42, 70, -5, 20, -114, 103,        -99, -25, 76, 95, -85, 94, 57, 54};    private static final byte[] IV = { // Hard coded for now        -85, -67, -5, 88, 28, 49, 49, 85,        114, 83, -40, 119, -65, 91, 76, 108};    private static final SecretKeySpec secretKeySpec =            new SecretKeySpec(AES_KEY_128, ""AES"");    private static final IvParameterSpec ivSpec = new IvParameterSpec(IV);    public void AesFileIo() {        Security.addProvider(new org.bouncycastle.jce.provider                .BouncyCastleProvider());    }    public void writeFile(String fileName, String theFile) {        try {            Cipher cipher = Cipher.getInstance(AES_ALGORITHM, PROVIDER);            cipher.init(Cipher.ENCRYPT_MODE, secretKeySpec, ivSpec);            byte[] encrypted = cipher.doFinal(theFile.getBytes());            ObjectOutputStream os = new ObjectOutputStream(                new FileOutputStream(fileName));            os.write(encrypted);            os.flush();            os.close();        } catch (Exception e) {            StackTraceElement se = new Exception().getStackTrace()[0];            System.err.println(se.getFileName() + "" "" + se.getLineNumber()                    + "" "" + e);        }    }}</code></pre>"
"<p>I want to make my application to run other people's code, aka plugins. However, what options do I have to make this secure so they don't write malicious code. How do I control what they can or can not do?</p><p>I have stumbled around that JVM has a ""built in sandbox"" feature - what is it and is this the only way? Are there third-party Java libraries for making a sandbox?</p><p>What options do I have? Links to guides and examples is appreciated!</p>"
"<p>I have a pretty basic helper class that I'm using to do all my Http Get/Post stuff.  I'm using HttpGet, HttpPost, and HttpClient from the org.apache.http library.  All of my stuff works fine over HTTP, but as soon as I tried to consume a service that works over HTTPS, I get a ClientProtocolException when executing the request.  The only message in the exception is ""The server failed to respond with a valid HTTP response"".</p><p>To test, I sent the exact same payload from a browser using a simple html form and Fiddler2 using the RequestBuilder.  I've sent invalid and empty payloads and even sent all of the above with and without headers to see if there was something funky about the way the objects were building the request.</p><p>Everything I've used in testing gives me a valid 200 status HTTP response.  The service just gives me a structure describing the error if I give it something other than what it expects.</p><p>Is there something special I need to add to the HttpPost or HttpClient object(s) to tell it to use HTTPS?  Do I have to explicitly tell it to use a different port?</p><p><strong>EDIT:</strong></p><p>I indeed registered the wrong socket factory for https communication.  Here is the updated method that I use to create my HttpClient object with the correct socket factory just in case someone searches this kind of problem in the future:</p><pre><code>private HttpClient createHttpClient(){    HttpParams params = new BasicHttpParams();    HttpProtocolParams.setVersion(params, HttpVersion.HTTP_1_1);    HttpProtocolParams.setContentCharset(params, HTTP.DEFAULT_CONTENT_CHARSET);    HttpProtocolParams.setUseExpectContinue(params, true);    SchemeRegistry schReg = new SchemeRegistry();    schReg.register(new Scheme(""http"", PlainSocketFactory.getSocketFactory(), 80));    schReg.register(new Scheme(""https"", SSLSocketFactory.getSocketFactory(), 443));    ClientConnectionManager conMgr = new ThreadSafeClientConnManager(params, schReg);    return new DefaultHttpClient(conMgr, params);}</code></pre>"
"<p>How is SAML SSO typically implemented?</p><p>I've read <a href=""https://developers.google.com/google-apps/sso/saml_reference_implementation_web"" rel=""noreferrer"">this</a> (n.b. obsolete) about using SAML with Google Apps, and the wikipedia entry on <a href=""http://en.wikipedia.org/wiki/SAML"" rel=""noreferrer"">SAML</a>.</p><p>The wikipedia entry talks about responding with forms containing details of the SAMLRequest and SAMLResponse. Does this mean that the user has to physically submit the form in order to proceed with the single sign on?</p><p>The google entry talks about using redirects, which seems more seemless to me. However, it also talks about using a form for the response which the user must submit (although it does talk about using JavaScript to automatically submit the form).</p><p>Is this the standard way of doing this? Using redirects and JavaScript for form submission?</p><p>Does anyone know of any other good resources about how to go about implementing SSO between a Windows Domain and a J2EE web application. The web application is on a separate network/domain. My client wants to use <a href=""http://www.ca.com/us/internet-access-control.aspx"" rel=""noreferrer"">CA Siteminder</a> (with SAML).</p>"
"<p>I'm deploying an application using <a href=""https://en.wikipedia.org/wiki/Java_Web_Start"">JAWS</a>, and it worked until late 2013 when I got a warning, and then this morning Java completely blocked it. The message in French is:</p><p><strong><em>Application bloquÃ©e par les paramÃ¨tres de sÃ©curitÃ©</em></strong><br><em>Vos paramÃ¨tres de sÃ©curitÃ© ont bloquÃ© l'exÃ©cution d'une application auto-signÃ©e avec une version obsolete ou arrivÃ©e Ã  expiration de Java.</em></p><p>which would translate roughly as:</p><p><strong><em>Application blocked by the security settings</em></strong><br><em>Your security settings have blocked from running an application that has been self-signed with an obsolete or outdated Java.</em></p><p>The grammar is not that clear, the end of the sentence could be read as either:</p><ul><li><em>...blocked a self-signed application from running with an obsolete or outdated Java [runtime]</em>, meaning that the local runtime is too old, but the self-signature is fine</li><li><em>...blocked an application that has been self-signed with an obsolete or outdated Java [compiler]</em>, meaning that the Java compiler used is too old</li></ul><p>I searched online for the exact same message in English, but I couldn't find it. So the grammar is still unclear. Note that on the message there is no <code>Name: xyz / From: http://url/</code>, there's only the text I typed above, and a blue ""i"" icon.</p><p>Now, I don't really understand the exact meaning of this error message, but I know that there is an issue because my <a href=""http://en.wikipedia.org/wiki/JAR_%28file_format%29"">JAR</a> files are all self-signed. I have already faced this on other Windows clients, and it was easy:</p><ul><li>I extracted a <code>.cer</code> certificate from my keystore;</li><li>Downloaded it on the client machine, open it;</li><li>Made the customers install it as a trusted source on their local machine.</li></ul><p>It worked like a charm on my test setup and for one customer, but another one still has the issue and cannot run my software.</p><p>This is a big issue from me, and I don't know what to do. Should I upgrade my Java compiler, recompile everything, sign every JAR file again and cross fingers? How can I make that Windows box trust my certificate and let the Java application run?</p>"
"<p>I've been trying to get some working Java code to use for encrypting Paypal buttons. This is no easy task! Even when I get some code, from Paypal, I'm faced with errors..ugh..</p><p>So here is what I have so far, that I think will work eventually.</p><p>I downloaded the Java.zip file from Paypal's website. Within it are two classes - ClientSide.java and ButtonEncryption.java</p><p><strong>The Problem -</strong> I'm getting an <code>InvalidKeyException : Illegal key size</code> error.</p><p><strong>Questions</strong><br/>1) How do I resolve this issue? 2) What line of code is throwing the error?</p><pre><code>C:\jakarta-tomcat\webapps\PlanB\WEB-INF\classes&gt;java palmb.servlets.paypal.ButtonEncryptionjava.io.IOException: exception decrypting data - java.security.InvalidKeyException: Illegal key size        at org.bouncycastle.jce.provider.JDKPKCS12KeyStore.cryptData(Unknown Source)        at org.bouncycastle.jce.provider.JDKPKCS12KeyStore.engineLoad(Unknown Source)        at java.security.KeyStore.load(Unknown Source)        at palmb.servlets.paypal.ClientSide.getButtonEncryptionValue(ClientSide.java:63)        at palmb.servlets.paypal.ButtonEncryption.main(ButtonEncryption.java:81)</code></pre><p><br/></p><h1>ClientSide class</h1><pre><code>package palmb.servlets.paypal;import java.io.ByteArrayOutputStream;import java.io.FileInputStream;import java.io.IOException;import java.io.PrintWriter;import java.security.InvalidAlgorithmParameterException;import java.security.KeyStore;import java.security.KeyStoreException;import java.security.NoSuchAlgorithmException;import java.security.NoSuchProviderException;import java.security.PrivateKey;import java.security.UnrecoverableKeyException;import java.security.cert.CertStore;import java.security.cert.CertStoreException;import java.security.cert.CertificateException;import java.security.cert.CertificateFactory;import java.security.cert.CollectionCertStoreParameters;import java.security.cert.X509Certificate;import java.util.ArrayList;import java.util.Enumeration;import org.bouncycastle.cms.CMSEnvelopedData;import org.bouncycastle.cms.CMSEnvelopedDataGenerator;import org.bouncycastle.cms.CMSException;import org.bouncycastle.cms.CMSProcessableByteArray;import org.bouncycastle.cms.CMSSignedData;import org.bouncycastle.cms.CMSSignedDataGenerator;import org.bouncycastle.openssl.PEMReader;import org.bouncycastle.util.encoders.Base64;/** */public class ClientSide {    private String  keyPath;    private String  certPath;    private String  paypalCertPath;    private String  keyPass;    public ClientSide( String keyPath, String certPath, String paypalCertPath, String keyPass )    {        this.keyPath = keyPath;        this.certPath = certPath;        this.paypalCertPath = paypalCertPath;        this.keyPass = keyPass;    }       public String getButtonEncryptionValue(String _data, String _privateKeyPath, String _certPath, String _payPalCertPath,                                            String _keyPass) throws IOException,CertificateException,KeyStoreException,                                            UnrecoverableKeyException,InvalidAlgorithmParameterException,NoSuchAlgorithmException,                                            NoSuchProviderException,CertStoreException,CMSException {        _data = _data.replace(',', '\n');        CertificateFactory cf = CertificateFactory.getInstance(""X509"", ""BC"");        // Read the Private Key        KeyStore ks = KeyStore.getInstance(""PKCS12"", ""BC"");        ks.load( new FileInputStream(_privateKeyPath), _keyPass.toCharArray() );        String keyAlias = null;        Enumeration aliases = ks.aliases();        while (aliases.hasMoreElements()) {            keyAlias = (String) aliases.nextElement();        }        PrivateKey privateKey = (PrivateKey) ks.getKey( keyAlias, _keyPass.toCharArray() );        // Read the Certificate        X509Certificate certificate = (X509Certificate) cf.generateCertificate( new FileInputStream(_certPath) );        // Read the PayPal Cert        X509Certificate payPalCert = (X509Certificate) cf.generateCertificate( new FileInputStream(_payPalCertPath) );        // Create the Data        byte[] data = _data.getBytes();        // Sign the Data with my signing only key pair        CMSSignedDataGenerator signedGenerator = new CMSSignedDataGenerator();        signedGenerator.addSigner( privateKey, certificate, CMSSignedDataGenerator.DIGEST_SHA1 );        ArrayList certList = new ArrayList();        certList.add(certificate);        CertStore certStore = CertStore.getInstance( ""Collection"", new CollectionCertStoreParameters(certList) );        signedGenerator.addCertificatesAndCRLs(certStore);        CMSProcessableByteArray cmsByteArray = new CMSProcessableByteArray(data);        ByteArrayOutputStream baos = new ByteArrayOutputStream();        cmsByteArray.write(baos);        System.out.println( ""CMSProcessableByteArray contains ["" + baos.toString() + ""]"" );        CMSSignedData signedData = signedGenerator.generate(cmsByteArray, true, ""BC"");        byte[] signed = signedData.getEncoded();        CMSEnvelopedDataGenerator envGenerator = new CMSEnvelopedDataGenerator();        envGenerator.addKeyTransRecipient(payPalCert);        CMSEnvelopedData envData = envGenerator.generate( new CMSProcessableByteArray(signed),                CMSEnvelopedDataGenerator.DES_EDE3_CBC, ""BC"" );        byte[] pkcs7Bytes = envData.getEncoded();        return new String( DERtoPEM(pkcs7Bytes, ""PKCS7"") );    }    public static byte[] DERtoPEM(byte[] bytes, String headfoot)     {        ByteArrayOutputStream pemStream = new ByteArrayOutputStream();        PrintWriter writer = new PrintWriter(pemStream);        byte[] stringBytes = Base64.encode(bytes);        System.out.println(""Converting "" + stringBytes.length + "" bytes"");        String encoded = new String(stringBytes);        if (headfoot != null) {            writer.print(""-----BEGIN "" + headfoot + ""-----\n"");        }        // write 64 chars per line till done        int i = 0;        while ((i + 1) * 64 &lt; encoded.length()) {            writer.print(encoded.substring(i * 64, (i + 1) * 64));            writer.print(""\n"");            i++;        }        if (encoded.length() % 64 != 0) {            writer.print(encoded.substring(i * 64)); // write remainder            writer.print(""\n"");        }        if (headfoot != null) {            writer.print(""-----END "" + headfoot + ""-----\n"");        }        writer.flush();        return pemStream.toByteArray();    }}</code></pre><p><br/></p><h1>ButtonEncryption class</h1><pre><code>package palmb.servlets.paypal;//import com.paypal.crypto.sample.*;import palmb.servlets.paypal.ClientSide;import java.io.*;import java.security.InvalidAlgorithmParameterException;import java.security.KeyStoreException;import java.security.NoSuchAlgorithmException;import java.security.NoSuchProviderException;import java.security.Security;import java.security.UnrecoverableKeyException;import java.security.cert.CertStoreException;import java.security.cert.CertificateException;import org.bouncycastle.cms.CMSException;/** */public class ButtonEncryption {    //path to public cert    private static String certPath = ""C:/jakarta-tomcat/webapps/PlanB/Certs/public-cert.pem"";    //path to private key in PKCS12 format    private static String keyPath = ""C:/jakarta-tomcat/webapps/PlanB/Certs/my_pkcs12.p12"";    //path to Paypal's public cert    private static String paypalCertPath = ""C:/jakarta-tomcat/webapps/PlanB/Certs/paypal_cert_pem.txt"";    //private key password    private static String keyPass = ""password""; //will be replaced with actual password when compiled and executed    //the button command, properties/parameters    private static String cmdText = ""cmd=_xclick\nbusiness=buyer@hotmail.com\nitem_name=vase\nitemprice=25.00"";  //cmd=_xclick,business=sample@paypal.com,amount=1.00,currency_code=USD    //output file for form code    private static String output = ""test.html"";    public static void main(String[] args)     {        Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider());         String stage = ""sandbox"";        try         {            ClientSide client_side = new ClientSide( keyPath, certPath, paypalCertPath, keyPass );            String result = client_side.getButtonEncryptionValue( cmdText, keyPath, certPath, paypalCertPath, keyPass );            File outputFile = new File( output );            if ( outputFile.exists() )                outputFile.delete();            if ( result != null &amp;&amp; result != """")            {                try {                            OutputStream fout= new FileOutputStream( output );                    OutputStream bout= new BufferedOutputStream(fout);                    OutputStreamWriter out = new OutputStreamWriter(bout, ""US-ASCII"");                    out.write( ""&lt;form action=\""https://www."" );                    out.write( stage );                    out.write( ""paypal.com/cgi-bin/webscr\"" method=\""post\""&gt;"" );                      out.write( ""&lt;input type=\""hidden\"" name=\""cmd\"" value=\""_s-xclick\""&gt;"" );  ;                    out.write( ""&lt;input type=\""image\"" src=\""https://www."" );                    out.write( stage );                    out.write( ""paypal.com/en_US/i/btn/x-click-but23.gif\"" border=\""0\"" name=\""submit\"" "" );                    out.write( ""alt=\""Make payments with PayPal - it's fast, free and secure!\""&gt;"" );                    out.write( ""&lt;input type=\""hidden\"" name=\""encrypted\"" value=\"""" );                    out.write( result );                    out.write( ""\""&gt;"" );                    out.write( ""&lt;/form&gt;"");                    out.flush();  // Don't forget to flush!                    out.close();                  }                  catch (UnsupportedEncodingException e) {                    System.out.println(                     ""This VM does not support the ASCII character set.""                    );                  }                  catch (IOException e) {                    System.out.println(e.getMessage());                          }            }        }         catch (NoSuchAlgorithmException e)         {            // TODO Auto-generated catch block            e.printStackTrace();        }         catch (NoSuchProviderException e)         {            // TODO Auto-generated catch block            e.printStackTrace();        }         catch (IOException e)         {            // TODO Auto-generated catch block            e.printStackTrace();        }         catch (CMSException e)         {            // TODO Auto-generated catch block            e.printStackTrace();        }         catch (CertificateException e)         {            // TODO Auto-generated catch block            e.printStackTrace();        }         catch (KeyStoreException e)         {            // TODO Auto-generated catch block            e.printStackTrace();        }         catch (UnrecoverableKeyException e)         {            // TODO Auto-generated catch block            e.printStackTrace();        }         catch (InvalidAlgorithmParameterException e)         {            // TODO Auto-generated catch block            e.printStackTrace();        }         catch (CertStoreException e)         {            // TODO Auto-generated catch block            e.printStackTrace();        }    }}</code></pre><p><br/></p><h1>Edited : info about keys/certificates</h1><p>I generated the Private Key and Public Certificate with OpenSSL via the following commands.<br/><strong>Private Key</strong><br/>openssl genrsa -out private-key.pem 1024<br/><strong>Public Certificate</strong><br/>openssl req -new -key private-key.pem -x509 -days 1095 -out public-cert.pem<br/><strong>Created PKCS12 File</strong><br/>openssl pkcs12 -export -in public-cert.pem -inkey private-key.pem -out my_pkcs12.p12</p><p><br/>Additionally, I had to download the Paypal Public Certificate from the Paypal website.</p><p><br/></p><h1>Edited - adding compilation warnings - BouncyCastle</h1><pre><code>C:\jakarta-tomcat\webapps\PlanB\WEB-INF\classes&gt;javac .\palmb\servlets\paypal\ClientSide.java -Xlint.\palmb\servlets\paypal\ClientSide.java:85: warning: [deprecation] addSigner(java.security.PrivateKey,java.security.cert.X509Certificate,java.lang.String) in org.bouncycastle.cms.CMSSignedDataGenerator has been deprecated                signedGenerator.addSigner( privateKey, certificate, CMSSignedDataGenerator.DIGEST_SHA1 );                               ^.\palmb\servlets\paypal\ClientSide.java:88: warning: [unchecked] unchecked callto add(E) as a member of the raw type java.util.ArrayList                certList.add(certificate);                            ^.\palmb\servlets\paypal\ClientSide.java:90: warning: [deprecation] addCertificatesAndCRLs(java.security.cert.CertStore) in org.bouncycastle.cms.CMSSignedGenerator has been deprecated                signedGenerator.addCertificatesAndCRLs(certStore);                               ^.\palmb\servlets\paypal\ClientSide.java:97: warning: [deprecation] generate(org.bouncycastle.cms.CMSProcessable,boolean,java.lang.String) in org.bouncycastle.cms.CMSSignedDataGenerator has been deprecated                CMSSignedData signedData = signedGenerator.generate(cmsByteArray, true, ""BC"");                                                          ^.\palmb\servlets\paypal\ClientSide.java:102: warning: [deprecation] addKeyTransRecipient(java.security.cert.X509Certificate) in org.bouncycastle.cms.CMSEnvelopedGenerator has been deprecated                envGenerator.addKeyTransRecipient(payPalCert);                            ^.\palmb\servlets\paypal\ClientSide.java:103: warning: [deprecation] generate(org.bouncycastle.cms.CMSProcessable,java.lang.String,java.lang.String) in org.bouncycastle.cms.CMSEnvelopedDataGenerator has been deprecated                CMSEnvelopedData envData = envGenerator.generate( new CMSProcessableByteArray(signed),                                                       ^6 warnings</code></pre><p><br/></p><h1>JCE policy file installation steps</h1><p>These are the steps I took to installing the JCE Unlimited Strength Policy files:<br/>1) Went to <a href=""https://cds.sun.com/is-bin/INTERSHOP.enfinity/WFS/CDS-CDS_Developer-Site/en_US/-/USD/ViewProductDetail-Start?ProductRef=jce_policy-6-oth-JPR@CDS-CDS_Developer"" rel=""noreferrer"">Java JCE Download</a> Page on Oracle.<br/>2) Extracted files from zip.<br/>3) Placed local_policy.jar and US_export_policy.jar files in C:\Java\jdk1.6.0_22\jre\lib\security folder. <br/>Note: C:\Java\jdk1.6.0_22 is set as %JAVA_HOME% <br/>4) Updated system classpath to include location of jars.<br/>Note: There are other files, that came with the JDK 1.6 within the security folder, including : java.policy, java.security, javaws.policy, trusted.libraries - but those probably have nothing to do with the JCE files, right?<br/></p><hr/><h1>Edit 6/23/2011 - results after further configuration</h1><p>I went to Bouncy Castle page at <a href=""http://www.bouncycastle.org/specifications.html#install"" rel=""noreferrer"">http://www.bouncycastle.org/specifications.html#install</a><br/>Scroll down to <strong>5.0 Bouncy Castle Provider</strong> then read info under <strong>5.1 Example</strong>. It makes mention of adding a parameter for the Bouncy Castle Provider to the <code>java.security</code> file. My file is under C:\Java\jdk1.6.0_22\jre\lib\security.<br/><br/>I added the following line to my file - <code>security.provider.10=org.bouncycastle.jce.provider.BouncyCastleProvider</code> <br/></p><p>In addition, I discovered that I hadn't added the Bouncy Castle jars to the classpath, so I went ahead and did so.<br/></p><p>Now after making these changes, recompiling and attempting to execute <code>ClientSide.java</code> I'm given the same exception : but maybe the focus should be on the part of the exception where it says this about bouncycastle provider -</p><pre><code>at org.bouncycastle.jce.provider.JDKPKCS12KeyStore.cryptData(Unknown Source)at org.bouncycastle.jce.provider.JDKPKCS12KeyStore.engineLoad(Unknown Source)</code></pre><p><strong>@PeteyB - I'm certain that I installed the policy files correctly. Based on what I've stated here, is there anything else you can suggest I try? Can you look at the Bouncy Castle site @ <a href=""http://www.bouncycastle.org/specifications.html#install"" rel=""noreferrer"">http://www.bouncycastle.org/specifications.html#install</a> and see if there is something I'm missing?</strong></p>"
"<p>I've been looking around and the closest answer is : <a href=""https://stackoverflow.com/questions/41107/how-to-generate-a-random-alpha-numeric-string"">How to generate a random alpha-numeric string?</a></p><p>I want to follow this workflow according to this <a href=""https://crackstation.net/hashing-security.htm#salt"" rel=""noreferrer"">CrackStation tutorial</a>: </p><blockquote>  <p><strong>To Store a Password</strong></p>    <ol>  <li><p>Generate a long random salt using a CSPRNG.</p></li>  <li><p>Prepend the salt to the password and hash it with a standard cryptographic hash function such as SHA256.</p></li>  <li><p>Save both the salt and the hash in the user's database record.</p></li>  </ol>    <p><strong>To Validate a Password</strong></p>    <ol>  <li><p>Retrieve the user's salt and hash from the database.</p></li>  <li><p>Prepend the salt to the given password and hash it using the same hash function.</p></li>  <li><p>Compare the hash of the given password with the hash from the database. If they match, the password is correct. Otherwise, the password is incorrect.</p></li>  </ol></blockquote><p>I don't know how to generate a SALT. I figured out how to generate a hash using the MessageDigest. I tried using <em>SecureRandom</em> but nextByte method produces garbled code.</p><p><strong>Edit:</strong> I don't know which answer to choose, they're too complicated for me, I have decided to use jBCrypt; jBCript is easy to use, does all the complex stuff behind the scenes. so I'll let the community vote up for the best answer.</p>"
"<p>I have enabled https in tomcat and have a self-signed certificate for server auth. I have created an http client using Apache httpClient. I have set a trust manager loading the server certificate. The http client can connect with server no problem. To see what is going on I enabled debugging:  </p><pre><code>System.setProperty(""javax.net.debug"", ""ssl"");</code></pre><p>I saw the following which I can not understand at all:  </p><pre><code>***adding as trusted cert:  Subject: CN=Me, OU=MyHouse, O=Home, L=X, ST=X, C=BB  Issuer:  CN=Me, OU=MyHouse, O=Home, L=X, ST=X, C=BB  Algorithm: RSA; Serial number: 0x4d72356b  Valid from Sat Mar 05 15:06:51 EET 2011 until Fri Jun 03 16:06:51 EEST 2011 </code></pre><p>My certificate is displayed and is added to truststore (as I see). Then:  </p><pre><code>trigger seeding of SecureRandomdone seeding SecureRandom</code></pre><p>Here is the part from debugging traces I do not get:  </p><pre><code>trustStore is: C:\Program Files\Java\jre6\lib\security\cacertstrustStore type is : jkstrustStore provider is : init truststoreadding as trusted cert:  Subject: CN=SwissSign Platinum CA - G2, O=SwissSign AG, C=CH  Issuer:  CN=SwissSign Platinum CA - G2, O=SwissSign AG, C=CH  Algorithm: RSA; Serial number: 0x4eb200670c035d4f  Valid from Wed Oct 25 11:36:00 EEST 2006 until Sat Oct 25 11:36:00 EEST 2036adding as trusted cert:  Subject: EMAILADDRESS=info@valicert.com, CN=http://www.valicert.com/, OU=ValiCert Class 1 Policy Validation Authority, O=""ValiCert, Inc."", L=ValiCert Validation Network  Issuer:  EMAILADDRESS=info@valicert.com, CN=http://www.valicert.com/, OU=ValiCert Class 1 Policy Validation Authority, O=""ValiCert, Inc."", L=ValiCert Validation Network  Algorithm: RSA; Serial number: 0x1  Valid from Sat Jun 26 01:23:48 EEST 1999 until Wed Jun 26 01:23:48 EEST 2019</code></pre><p>It seems that it also uses the default java trust store! My question is why does this happen? </p><p>In my code I specify explicitly a specific trust-store to use (via truststoremanagers). I was expecting only this to be used. It seems that both my truststore and java's default is being used. Is this how it is supposed to work?  </p><p><strong>UPDATE:</strong><br>I tried the following:  </p><pre><code>System.out.println(""TMF No:""+tmf.getTrustManagers().length);System.out.println(""Class is ""+tmf.getTrustManagers()[0].getClass().getName());  </code></pre><p>I thought that I should see 2 trust managers, since 2 keystores (mine and java's default appear to be used).<br>But the result was only 1 trust manager!  </p><pre><code>TMF No:1Class is com.sun.net.ssl.internal.ssl.X509TrustManagerImpl  </code></pre><p><strong>UPDATE2:</strong>  As you see in the code bellow I specify my keystore.My expectation is that only this should be used (not this <strong>and</strong> cacert as well)</p><pre><code>    HttpClient client = new DefaultHttpClient();    SSLContext sslContext = SSLContext.getInstance(""TLS"");          TrustManagerFactory tmf = TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());    KeyStore ks = KeyStore.getInstance(""JKS"");    File trustFile = new File(""clientTrustStore.jks"");    ks.load(new FileInputStream(trustFile), null);    tmf.init(ks);    sslContext.init(null, tmf.getTrustManagers(),null);      SSLSocketFactory sf = new SSLSocketFactory(sslContext);     sf.setHostnameVerifier(SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER);    Scheme scheme = new Scheme(""https"", sf, 443);    client.getConnectionManager().getSchemeRegistry().register(scheme);    httpGet = new HttpGet(""https://localhost:8443/myApp"");    HttpResponse httpResponse = client.execute(httpGet);</code></pre><p>Does not make sense to me.</p>"
"<p>I have a Spring MVC application.<strong>It uses its own custom Login page</strong>. Upon successful login, a 'LOGGED_IN_USER' object is placed in the HTTPSession.</p><p>I want to allow only authenticated users to access URLs. I know i can achieve this by using a web filter. But, This part i want to do using Spring Security (my check will remain the same - look for 'LOGGED_IN_USER' object in HTTPSession, if present you are logged in).</p><p><em>My constraint is i cannot change Login behavior at present - that will not use Spring Security yet.</em></p><p><strong>What aspect of Spring Security can i use to achieve this part alone - check if the request is authenticated (from logged in user)?</strong> </p>"
"<p>I've built a Java program as a front end for a database on a server, and I'm trying to use SSL to encrypt traffic between clients and the server.  Here is the command I issued to create the server certificate:</p><pre><code>keytool -genkey -alias localhost -keyalg RSA -keypass kpass123 -storepass kpass123 -keystore keystore.jks</code></pre><p>Here is the relevant code:</p><pre><code>System.setProperty(""javax.net.ssl.keyStore"",                   ""G:/Data/Android_Project/keystore.jks"");System.setProperty(""javax.net.ssl.keyPassword"", ""kpass123"");SSLServerSocketFactory factory =     (SSLServerSocketFactory)SSLServerSocketFactory.getDefault();SSLServerSocket accessSocket =     (SSLServerSocket)factory.createServerSocket(DB_ACCESS_PORT);</code></pre><p>When I try to run this, I catch this:</p><blockquote>  <p>java.security.NoSuchAlgorithmException: Error constructing implementation (algorithm: Default, provider: SunJSSE, class: com.sun.net.ssl.internal.ssl.DefaultSSLContextImpl)</p></blockquote><p>I've also found that the ""KeyPairGenerator"" service has algorithms DIFFIEHELLMAN, DSA, RSA available to it, while ""SSLContext"" has algorithms SSL, TLS, SSLV3, DEFAULT, TLSV1.</p><p>Do I need to find some way to install RSA into the SSLContext service?  Am I even looking at the correct services?  Should I not be using RSA?</p><p>I'm new to the whole SSL - Security - Certificates thing, and it just blows me away that each of these different services don't have the same algorithms when they are supposed to be accessing the same certificates.</p>"
"<p>I have gone through the OWASP top ten vulnerabilities and found that Cross-Site Scripting is the one we have to take notes. There was few way recommended solutions. One has stated that Do not use ""blacklist"" validation to detect XSS in input or to encode output. Searching for and replacing just a few characters (<code>&lt;</code> and <code>&gt;</code> and other similar characters or phrases such as <code>script</code>) is weak and has been attacked successfully. Even an unchecked <code>â€œ&lt;b&gt;â€</code> tag is unsafe in some contexts. XSS has a surprising number of variants that make it easy to bypass blacklist validation. Another solution said that Strong output encoding. Ensure that all user-supplied data is appropriately entity encoded (either HTML or XML depending on the output mechanism) before rendering. So, which is the best way to prevent cross site scripting to validate and replace the input or encoding the output ?</p>"
"<p>If I understand <a href=""https://stackoverflow.com/questions/852453/accesscontroller-doprivileged"">AccessController.doPrivileged</a> correctly, it is saying that untrusted code should be able to invoke methods requiring permissions (such as <code>System.getProperty()</code>) through an intermediate method that <em>does</em> have permissions.</p><p>That brings up the question: when should <code>AccessController.doPrivileged()</code> be used? When should untrusted code be allowed to invoke privileged code through intermediate methods? When should it fail?</p><p>Following your reasoning, please explain why ClassLoader creation should always be allowed: <a href=""http://findbugs.sourceforge.net/bugDescriptions.html#DP_CREATE_CLASSLOADER_INSIDE_DO_PRIVILEGED"" rel=""nofollow noreferrer"">http://findbugs.sourceforge.net/bugDescriptions.html#DP_CREATE_CLASSLOADER_INSIDE_DO_PRIVILEGED</a></p>"
"<p>I am beginner to the SAML v2.0 technology and I get the theory knowledge but I didn't find any examples on Google. Can anybody provide me with a step by step example for simple ""SAML for v2.0"".</p><ol><li>Upto now I've gone through the theory part,i.e.., it support <strong>Single sign on</strong> and<br> also I understood about the <strong>Service provider</strong> and <strong>Identity Provider</strong>   .</li><li>Presently I am working on <strong>Linux Environment</strong></li><li>I need basic example in step by step manner how the request is moving from <strong>user ->  Identity Provider->Service Provider</strong> and how to configure the environment .</li><li>Is it possible to execute the example for the SAML v2.0</li><li>Is their any chance to execute SAML example in Java language,If it possible you can<br> provide the example on Java also. </li></ol>"
"<p>I'm interested in Java-NSS libraries, and I'm reading the <a href=""http://download.oracle.com/javase/6/docs/technotes/guides/security/p11guide.html"" rel=""nofollow noreferrer"">Sun's P11 Guide</a>. I am confused on the following:</p><blockquote>  <p>What is the difference between using a PKCS12 keystore and a PKCS11 keystore?</p></blockquote><p>A keystore is just a keystore, right? Are there some differences? Can they be used interchangeably in any aspect?</p>"
"<p>How can one know if the JDBC connection to an SQL server is secure (i.e. uses SSL) or not?  </p><p>Is it obvious for example from the URL. Do all JDBC drivers support SSL connections to the database server, or does the use of SSL just depends on the specific database vendor?</p>"
"<p>I am working on an android application, and I need to use encryption for one aspect of it. I am really indifferent to which algorithm I use (AES, DES, RSA, etc...). I am aware that Java has a crypto package, but I am not familiar with it at all. Can someone post an example on how to do an encrypt/decrypt function?</p>"
"<p>Swing's <a href=""http://java.sun.com/javase/6/docs/api/javax/swing/JPasswordField.html"" rel=""noreferrer""><code>JPasswordField</code></a> has the <a href=""http://java.sun.com/javase/6/docs/api/javax/swing/JPasswordField.html#getPassword()"" rel=""noreferrer""><code>getPassword()</code></a> method that returns a char array. My understanding of this is that the array can be zeroed immediately after use so that you do not have sensitive things hanging around in memory for long. The old way to retrieve the password was to use <code>getText()</code>, which returns a String object, but it has been deprecated.</p><p>So, my question is why it is actually being used by Java during the retrieval process using <code>getPassword()</code>??? To be clearer, I was debugging my test app for something else**, I followed the calls and bang... <code>getText()</code> in <code>JPasswordField</code> was called and, of course, a nice String object with my password has been created and now is hanging around the memory.</p><p>Try it for yourself:</p><pre><code>public class PasswordTest() {    public static void main(String[] args) {        JFrame frame = new JFrame();        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);        JPasswordField passField = new JPasswordField();        pass.addActionListener(new ActionListener() {            public ActionPerformed(ActionEvent evt) {                char[] p = passField.getPassword(); // put breakpoint                // do something with the array            }        });        frame.add(passField);        frame.setVisible(true);        frame.pack();    }}</code></pre><p>Follow up question: is this 'hidden' use of <code>getText()</code> dangerous in any way? Of course a dedicated attacker WILL get your password if it has compromised the system, I am talking about a less dedicated one ;)</p><p>**I came across this while I was looking for a way to actually display some sensitive data on a Swing component without using a <code>String</code> object. Apparently there is no way to do it unless I am willing to rewrite part (all?) of the Swing API.. not gonna happen.</p>"
"<p>Recently, we had a security audit on our code, and one of the problem is that our application is subject to the <strong>Xml EXternal Entity</strong> (XXE) attack.</p><p>Basically, the application is an calculator that receives inputs as XML, through a Web-Service.</p><p>Here is an example of such XXE attack on our application:</p><pre><code>&lt;soapenv:Envelope xmlns:soapenv=""http://schemas.xmlsoap.org/soap/envelope/""&gt;   &lt;soapenv:Header/&gt;   &lt;soapenv:Body&gt;      &lt;foo:calculateStuff&gt;         &lt;!--Optional:--&gt;         &lt;xmlInput&gt;&lt;![CDATA[&lt;?xml version=""1.0"" encoding=""UTF-8"" standalone=""yes""?&gt;&lt;!DOCTYPE currency [     &lt;!ENTITY include SYSTEM ""file:///d:/"" &gt;]&gt;&lt;calcinput&gt;...&lt;/calcinput&gt;]]&gt;&lt;/xmlInput&gt;      &lt;/foo:calculateStuff&gt;   &lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;</code></pre><p>As you can see, we can refers to an entity that points to an external file (<code>""file:///d:/""</code>).</p><p>Regarding the XML input itself (the <code>&lt;calcinput&gt;...&lt;/calcinput&gt;</code> part) is unmarshalled with JAXB (v2.1). The web-service part is based on jaxws-rt (2.1).</p><p>What do I need to do to secure my web-service?</p><p>Thanks.</p>"
"<p>These two seem to be doing the same things. Can anyone explain the main difference between the two?  When would you use one vs the other?  </p><p><a href=""http://docs.oracle.com/javaee/5/api/javax/servlet/http/HttpServletRequest.html#getRemoteUser%28%29"" rel=""noreferrer"">HttpServletRequest.getRemoteUser()</a></p><p><a href=""http://docs.oracle.com/javase/1.5.0/docs/api/java/security/Principal.html#getName()"" rel=""noreferrer"">HttpServletRequest.getUserPrincipal().getName()</a></p>"
"<p>I am trying to Update the SSL certificate in accordance  with <a href=""https://dev.twitter.com/discussions/533"" rel=""noreferrer"">this post</a> . </p><p>I am noob in certificates, so i followed <a href=""http://www.coderanch.com/t/436858/Security/Certificate-configure-it-cacerts-file"" rel=""noreferrer"">this guide</a>. But, when i enter </p><pre><code>keytool -keystore mycacerts -storepass changeit -importcert -file ""C:\Users\Noks\Desktop\cacerts.pem"" -v</code></pre><p>I get the error:</p><pre><code>keytool error: java.lang.Exception: Input not an X.509 certificatejava.lang.Exception: Input not an X.509 certificate        at sun.security.tools.KeyTool.addTrustedCert(KeyTool.java:1913)        at sun.security.tools.KeyTool.doCommands(KeyTool.java:818)        at sun.security.tools.KeyTool.run(KeyTool.java:172)        at sun.security.tools.KeyTool.main(KeyTool.java:166)</code></pre><p>How do i fix this?</p>"
"<p>When trying to read a RSA private key from a file using the method</p><pre><code>public PrivateKey getPrivateKey()        throws NoSuchAlgorithmException,        InvalidKeySpecException, IOException {    final InputStream inputStream = getClass().getClassLoader()                    .getResourceAsStream(""privatekey"");    byte[] privKeyBytes = null;    try {        privKeyBytes = IOUtils.toByteArray(inputStream);    } catch (final IOException exception) {        LOGGER.error("""", exception);        IOUtils.closeQuietly(inputStream);    }    LOGGER.debug(""privKeyBytes: {}"", privKeyBytes);    String BEGIN = ""-----BEGIN RSA PRIVATE KEY-----"";    String END = ""-----END RSA PRIVATE KEY-----"";    String str = new String(privKeyBytes);    if (str.contains(BEGIN) &amp;&amp; str.contains(END)) {        str = str.substring(BEGIN.length(), str.lastIndexOf(END));    }    KeyFactory fac = KeyFactory.getInstance(""RSA"");    EncodedKeySpec privKeySpec =            new PKCS8EncodedKeySpec(Base64.decode(str.getBytes()));    return fac.generatePrivate(privKeySpec);}</code></pre><p>I get the exception</p><pre><code>java.security.spec.InvalidKeySpecException: java.security.InvalidKeyException: IOException : algid parse error, not a sequence    at sun.security.rsa.RSAKeyFactory.engineGeneratePrivate(RSAKeyFactory.java:200) ~[na:1.6.0_23]    at java.security.KeyFactory.generatePrivate(KeyFactory.java:342) ~[na:1.6.0_23]</code></pre><p>at the fac.generatePrivate(privKeySpec) call.</p><p>What does this error mean?</p><p>Thanks</p><p>Dmitri</p>"
"<p>I  want to understand form based security and JDBC realms with glassfishV3, so i decided to create a little app that just allows to sign in and out, i followed the instructions from this <a href=""http://rads.stackoverflow.com/amzn/click/1847199380"" rel=""noreferrer"">book</a> to do so. </p><p>I understand how the hold thing works, but something is wrong and i cant get it to work properly.</p><p><strong>What i did first was create a little database with JPA annotations:</strong></p><pre><code>@Entity@Table(name=""USERS"")public class User implements Serializable {    private static final long serialVersionUID = -1244856316278032177L;    @Id    @GeneratedValue    @Column(nullable = false)    private Long id;    @Column(nullable = false)    private String email;    @Column(nullable = false)    private String password;    @OneToMany(mappedBy = ""user"")    private List&lt;Group&gt; groups;    //GET &amp; SET METHODS...}</code></pre><p><strong>Here the other table that holds the roles for each user</strong></p><pre><code>@Entity@Table(name=""GROUPS"")public class Group implements Serializable {    private static final long serialVersionUID = -7274308564659753174L;    @Id    @GeneratedValue    @Column(nullable = false)    private Long id;    @Column(nullable = false)    private String groupName;    @ManyToOne    @JoinColumn(name = ""USERS_ID"", nullable = false)    private User user;    //GET &amp; SET METHODS...    }</code></pre><p><strong>When the DB was ready i added some data manually</strong></p><p><img src=""https://i.stack.imgur.com/zHZqW.png"" alt=""enter image description here""></p><p><strong>The next step was to configure a security realm.</strong></p><p><img src=""https://i.stack.imgur.com/dPgEY.png"" alt=""enter image description here""></p><p><strong>Then added the security configuration to my web.xml file</strong></p><pre><code>&lt;?xml version=""1.0"" encoding=""UTF-8""?&gt;&lt;web-app xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""    xmlns=""http://java.sun.com/xml/ns/javaee"" xmlns:web=""http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd""    xsi:schemaLocation=""http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd""    version=""3.0""&gt;    &lt;display-name&gt;CHAPTER x 12 Container Managed Authentication and        Authorization&lt;/display-name&gt;    &lt;welcome-file-list&gt;        &lt;welcome-file&gt;index.xhtml&lt;/welcome-file&gt;    &lt;/welcome-file-list&gt;    &lt;servlet&gt;        &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt;        &lt;servlet-class&gt;javax.faces.webapp.FacesServlet&lt;/servlet-class&gt;        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;    &lt;/servlet&gt;    &lt;servlet-mapping&gt;        &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt;        &lt;url-pattern&gt;*.xhtml&lt;/url-pattern&gt;    &lt;/servlet-mapping&gt;    &lt;security-constraint&gt;        &lt;web-resource-collection&gt;            &lt;web-resource-name&gt;VISITOR PERMISIONS&lt;/web-resource-name&gt;                       &lt;url-pattern&gt;/index.xhtml&lt;/url-pattern&gt;                     &lt;url-pattern&gt;/visitorpanel.xhtml&lt;/url-pattern&gt;            &lt;http-method&gt;GET&lt;/http-method&gt;            &lt;http-method&gt;POST&lt;/http-method&gt;        &lt;/web-resource-collection&gt;        &lt;auth-constraint&gt;            &lt;role-name&gt;visitors&lt;/role-name&gt;            &lt;role-name&gt;users&lt;/role-name&gt;            &lt;role-name&gt;administrators&lt;/role-name&gt;        &lt;/auth-constraint&gt;    &lt;/security-constraint&gt;    &lt;security-constraint&gt;        &lt;web-resource-collection&gt;            &lt;web-resource-name&gt;USERS PERMISIONS&lt;/web-resource-name&gt;                     &lt;url-pattern&gt;/userpanel.xhtml&lt;/url-pattern&gt;            &lt;url-pattern&gt;/index.xhtml&lt;/url-pattern&gt;                     &lt;url-pattern&gt;/visitorpanel.xhtml&lt;/url-pattern&gt;            &lt;http-method&gt;GET&lt;/http-method&gt;            &lt;http-method&gt;POST&lt;/http-method&gt;                 &lt;/web-resource-collection&gt;        &lt;auth-constraint&gt;                       &lt;role-name&gt;users&lt;/role-name&gt;            &lt;role-name&gt;administrators&lt;/role-name&gt;        &lt;/auth-constraint&gt;    &lt;/security-constraint&gt;    &lt;security-constraint&gt;        &lt;web-resource-collection&gt;            &lt;web-resource-name&gt;ADMIN PERMISIONS&lt;/web-resource-name&gt;                         &lt;url-pattern&gt;/adminpanel.xhtml&lt;/url-pattern&gt;            &lt;url-pattern&gt;/userpanel.xhtml&lt;/url-pattern&gt;            &lt;url-pattern&gt;/index.xhtml&lt;/url-pattern&gt;                     &lt;url-pattern&gt;/visitorpanel.xhtml&lt;/url-pattern&gt;                      &lt;http-method&gt;GET&lt;/http-method&gt;            &lt;http-method&gt;POST&lt;/http-method&gt;        &lt;/web-resource-collection&gt;        &lt;auth-constraint&gt;                       &lt;role-name&gt;administrators&lt;/role-name&gt;        &lt;/auth-constraint&gt;    &lt;/security-constraint&gt;    &lt;login-config&gt;        &lt;auth-method&gt;FORM&lt;/auth-method&gt;        &lt;realm-name&gt;DBRealm&lt;/realm-name&gt;        &lt;form-login-config&gt;            &lt;form-login-page&gt;/index.xhtml&lt;/form-login-page&gt;            &lt;form-error-page&gt;/error.xhtml&lt;/form-error-page&gt;        &lt;/form-login-config&gt;    &lt;/login-config&gt;    &lt;security-role&gt;    &lt;role-name&gt;visitors&lt;/role-name&gt;    &lt;/security-role&gt;    &lt;security-role&gt;    &lt;role-name&gt;users&lt;/role-name&gt;    &lt;/security-role&gt;    &lt;security-role&gt;    &lt;role-name&gt;administrators&lt;/role-name&gt;    &lt;/security-role&gt;&lt;/web-app&gt;</code></pre><p>My objectives here were:</p><ul><li><p>administrators can see all pages</p></li><li><p>visitors can see only index.xhtml and visitorpanel.xhtml</p></li><li><p>users can see index.xhtml,visitorpanel.xhtml and userpanel.xhtml</p></li></ul><p>I think the configuration is correct.</p><p><strong>Finally the last step was to create the login form in the index.xhtml page:</strong></p><pre><code>&lt;form method=""post"" action=""j_security_check"" name=""loginForm""&gt;        &lt;h:outputLabel id=""userNameLabel"" for=""j_username"" value=""Enter your em@il:""/&gt;        &lt;h:inputText id=""j_username"" autocomplete=""off"" /&gt;        &lt;br/&gt;        &lt;h:outputLabel id=""passwordLabel"" for=""j_password"" value=""Enter your em@il password:""/&gt;        &lt;h:inputSecret id=""j_password"" autocomplete=""off""/&gt;        &lt;br/&gt;        &lt;h:commandButton type=""submit"" value=""Login""/&gt;        &lt;h:commandButton type=""reset"" value=""Clear""/&gt;  &lt;/form&gt;</code></pre><p>The program builds fine, but i have the following problems:</p><p>1- When i try to login as user or as administrator(visitors don't need to login), i get redirected to the error.xhtml page and in the console i see an exception:</p><blockquote>  <p>SEVERE: SEC1112: Cannot validate user [admin@gmail.com] for JDBC  realm. WARNING: Web login failed: Login failed:  javax.security.auth.login.LoginException: Security Exception WARNING:  PWC4011: Unable to set request character encoding to UTF-8 from  context  /CHAPTER_12_x_Container_Managed_Authentication_and_Authorization,  because request parameters have already been read, or  ServletRequest.getReader() has already been called</p></blockquote><p>2- When i try to navigate to some of the pages via the URL, nothing happens. I think that is ok, but when i try to visit visitorpanel.xhtml, it should let me, because there is no need to be logged in to see it. Do i need to remove that page from the security configuration if a want every body to see it? </p><p>3- Also i am curious why i cant use the tag h:form instead of just form, when i implement the login?</p><p>Ill really appreciate some help, ive been a few hours reading the first chapters of the book and trying to implement, my own example but i got stuck. I think i am close to the solution.</p><p><strong>Update</strong></p><p>I changed the Default principal to be the visitors user name. But it still don't work</p><p><img src=""https://i.stack.imgur.com/he7kJ.png"" alt=""enter image description here""></p><p>And i also added some more options to my Realm configuration</p><p><img src=""https://i.stack.imgur.com/m3BVk.png"" alt=""enter image description here""></p><p>But when i try to login i still see an exception that says:</p><blockquote>  <p>SEVERE: SEC1112: Cannot validate user [admin@gmail.com] for JDBC  realm. WARNING: Web login failed: Login failed:  javax.security.auth.login.LoginException: Security Exception WARNING:  PWC4011: Unable to set request character encoding to UTF-8 from  context  /CHAPTER_12_x_Container_Managed_Authentication_and_Authorization,  because request parameters have already been read, or  ServletRequest.getReader() has already been called</p></blockquote><p>I still don't know what is missing.</p><p>-Could it be that the table name should not be upper case?</p><p>-Could it be that the columns names should not be upper case?</p><p>-Could it be that the tables are created wrong?</p><p>-Could it be that i cant use PASSWORD as a column name, because it makes some kind of conflict?</p><p>I really don't understand why that exception. I pinged the database from the admin panel, and all seem to be correct.</p><p>Can someone help me figuring this one out? </p><p><strong>Update 2</strong></p><p>I changed the 'javax.enterprise.system.core.security' logging option to level FINE, to have more information when exceptions occur, this was the result when i tried to login:</p><blockquote>  <p>FINE: Intercept Entry:       intercept: SOAP      defaultServerID: null      defaultClientID:  null FINE: ID Entry:       module class: com.sun.xml.wss.provider.ClientSecurityAuthModule      id: XWS_ClientProvider      type: client      request policy: javax.security.auth.message.MessagePolicy@e95a72      response policy: javax.security.auth.message.MessagePolicy@310a6d      options: {signature.key.alias=s1as, debug=false, dynamic.username.password=false, encryption.key.alias=s1as} FINE: ID  Entry:       module class: com.sun.xml.wss.provider.ClientSecurityAuthModule      id: ClientProvider      type: client      request policy: javax.security.auth.message.MessagePolicy@1829770      response policy: javax.security.auth.message.MessagePolicy@a4461e      options: {signature.key.alias=s1as, debug=false, dynamic.username.password=false, encryption.key.alias=s1as,  security.config=C:\jeeAplicationServer\glassfishv3\glassfish\domains\domain1/config/wss-server-config-1.0.xml}  FINE: ID Entry:       module class: com.sun.xml.wss.provider.ServerSecurityAuthModule      id: XWS_ServerProvider      type: server      request policy: javax.security.auth.message.MessagePolicy@f79c86      response policy: javax.security.auth.message.MessagePolicy@454bf7      options: {signature.key.alias=s1as, debug=false, encryption.key.alias=s1as} FINE: ID Entry:       module class: com.sun.xml.wss.provider.ServerSecurityAuthModule      id: ServerProvider      type: server      request policy: javax.security.auth.message.MessagePolicy@17e85e4      response policy: javax.security.auth.message.MessagePolicy@1887906      options: {signature.key.alias=s1as, debug=false, encryption.key.alias=s1as,  security.config=C:\jeeAplicationServer\glassfishv3\glassfish\domains\domain1/config/wss-server-config-1.0.xml}  FINE: [Web-Security] Setting Policy Context ID: old = null ctxID =  CHAPTER_x_12_Container_Managed_Authentication_and_Authorization/CHAPTER_x_12_Container_Managed_Authentication_and_Authorization  FINE: [Web-Security] hasUserDataPermission perm:  (javax.security.jacc.WebUserDataPermission /j_security_check POST)  FINE: [Web-Security] hasUserDataPermission isGranted: true FINE:  Logging in user [admin@gmail.com] into realm: DBRealm using JAAS  module: jdbcRealm FINE: Login module initialized: class  com.sun.enterprise.security.auth.login.JDBCLoginModule SEVERE:  SEC1112: Cannot validate user [admin@gmail.com] for JDBC realm. FINE:  Cannot validate user javax.security.auth.login.LoginException: Unable  to connect to datasource jdbc/security for database user user.    at  com.sun.enterprise.security.auth.realm.jdbc.JDBCRealm.getConnection(JDBCRealm.java:550)    at  com.sun.enterprise.security.auth.realm.jdbc.JDBCRealm.isUserValid(JDBCRealm.java:393)    at  com.sun.enterprise.security.auth.realm.jdbc.JDBCRealm.authenticate(JDBCRealm.java:311)    at  com.sun.enterprise.security.auth.login.JDBCLoginModule.authenticate(JDBCLoginModule.java:72)    at  com.sun.enterprise.security.auth.login.PasswordLoginModule.authenticateUser(PasswordLoginModule.java:90)    at  com.sun.appserv.security.AppservPasswordLoginModule.login(AppservPasswordLoginModule.java:141)    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)  at  sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)    at  sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)    at java.lang.reflect.Method.invoke(Method.java:597)     at  javax.security.auth.login.LoginContext.invoke(LoginContext.java:769)    at  javax.security.auth.login.LoginContext.access$000(LoginContext.java:186)    at  javax.security.auth.login.LoginContext$4.run(LoginContext.java:683)    at java.security.AccessController.doPrivileged(Native Method)   at  javax.security.auth.login.LoginContext.invokePriv(LoginContext.java:680)    at  javax.security.auth.login.LoginContext.login(LoginContext.java:579)    at  com.sun.enterprise.security.auth.login.LoginContextDriver.doPasswordLogin(LoginContextDriver.java:341)    at  com.sun.enterprise.security.auth.login.LoginContextDriver.login(LoginContextDriver.java:199)    at  com.sun.enterprise.security.auth.login.LoginContextDriver.login(LoginContextDriver.java:152)    at  com.sun.web.security.RealmAdapter.authenticate(RealmAdapter.java:479)    at  com.sun.web.security.RealmAdapter.authenticate(RealmAdapter.java:418)    at  org.apache.catalina.authenticator.FormAuthenticator.authenticate(FormAuthenticator.java:264)    at  org.apache.catalina.authenticator.AuthenticatorBase.processSecurityCheck(AuthenticatorBase.java:1015)    at  org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:614)    at  org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:615)    at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:97)   at  com.sun.enterprise.web.PESessionLockingStandardPipeline.invoke(PESessionLockingStandardPipeline.java:85)    at  org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:185)    at  org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:325)    at  org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:226)    at  com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:165)    at  com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:791)    at  com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:693)    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:954)    at  com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:170)    at  com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:135)    at  com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:102)    at  com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:88)    at  com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:76)    at  com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:53)    at  com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:57)    at com.sun.grizzly.ContextTask.run(ContextTask.java:69)     at  com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:330)    at  com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:309)    at java.lang.Thread.run(Thread.java:662) Caused by:  javax.naming.NamingException: Lookup failed for 'jdbc/security' in  SerialContext  [Root exception is javax.naming.NameNotFoundException:  security not found]   at  com.sun.enterprise.naming.impl.SerialContext.lookup(SerialContext.java:442)    at javax.naming.InitialContext.lookup(InitialContext.java:392)  at  javax.naming.InitialContext.lookup(InitialContext.java:392)   at  com.sun.enterprise.connectors.service.ConnectorResourceAdminServiceImpl.lookup(ConnectorResourceAdminServiceImpl.java:203)    at  com.sun.enterprise.connectors.ConnectorRuntime.lookupNonTxResource(ConnectorRuntime.java:440)    at  com.sun.enterprise.security.auth.realm.jdbc.JDBCRealm.getConnection(JDBCRealm.java:538)    ... 44 more Caused by: javax.naming.NameNotFoundException: security  not found     at  com.sun.enterprise.naming.impl.TransientContext.doLookup(TransientContext.java:197)    at  com.sun.enterprise.naming.impl.TransientContext.lookup(TransientContext.java:168)    at  com.sun.enterprise.naming.impl.TransientContext.lookup(TransientContext.java:172)    at  com.sun.enterprise.naming.impl.SerialContextProviderImpl.lookup(SerialContextProviderImpl.java:58)    at  com.sun.enterprise.naming.impl.LocalSerialContextProviderImpl.lookup(LocalSerialContextProviderImpl.java:101)    at  com.sun.enterprise.naming.impl.SerialContext.lookup(SerialContext.java:430)    ... 49 more</p>    <p>FINE: JAAS authentication aborted. WARNING: Web login failed: Login  failed: javax.security.auth.login.LoginException: Security Exception  FINE: [Web-Security] Policy Context ID was:  CHAPTER_x_12_Container_Managed_Authentication_and_Authorization/CHAPTER_x_12_Container_Managed_Authentication_and_Authorization  FINE: [Web-Security] hasUserDataPermission perm:  (javax.security.jacc.WebUserDataPermission /error.xhtml GET) FINE:  [Web-Security] hasUserDataPermission isGranted: true</p></blockquote><p><strong>Update 3</strong></p><p>Maybe there is something wron with the connection pool.This is how my connection pool looks like:</p><p><img src=""https://i.stack.imgur.com/D8iwH.png"" alt=""enter image description here""></p><p><img src=""https://i.stack.imgur.com/vKZYB.png"" alt=""enter image description here""></p><p><img src=""https://i.stack.imgur.com/kFJ3b.png"" alt=""enter image description here""></p><p>I don't have much properties, maybe something is missing?</p><p>Also now i created a JDBC resource, that looks like this:</p><p><img src=""https://i.stack.imgur.com/TZyfP.png"" alt=""enter image description here""></p><p>(The JNDI name in the Realm, was changed to jdbc/studydb)</p><p>My persistence.xml looks like this:</p><pre><code>&lt;?xml version=""1.0"" encoding=""UTF-8""?&gt;&lt;persistence version=""2.0"" xmlns=""http://java.sun.com/xml/ns/persistence"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xsi:schemaLocation=""http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd""&gt;    &lt;persistence-unit name=""CHAPTER x 12 Container Managed Authentication and Authorization""&gt;        &lt;jta-data-source&gt;jdbc/studydb&lt;/jta-data-source&gt;             &lt;class&gt;entities.User&lt;/class&gt;        &lt;class&gt;entities.Group&lt;/class&gt;    &lt;/persistence-unit&gt;&lt;/persistence&gt;</code></pre><p>I think i made some progress, now the exception i see is:</p><pre><code>&gt; SEVERE: jdbcrealm.invaliduserreason&gt;      FINE: Cannot validate user&gt;      java.sql.SQLSyntaxErrorException: Schema 'ADMIN' does not exist&gt;       at org.apache.derby.client.am.SQLExceptionFactory40.getSQLException(Unknown&gt; Source)&gt;      ....&gt;      &gt;      Caused by: org.apache.derby.client.am.SqlException: Schema 'ADMIN' does not exist&gt;       at org.apache.derby.client.am.Statement.completeSqlca(Unknown Source)&gt;      ...&gt;      FINE: JAAS authentication aborted.&gt;      WARNING: Web login failed: Login failed: javax.security.auth.login.LoginException: Security Exception&gt;      FINE: [Web-Security] Policy Context ID was: CHAPTER_x_12_Container_Managed_Authentication_and_Authorization/CHAPTER_x_12_Container_Managed_Authentication_and_Authorization&gt;      FINE: [Web-Security] hasUserDataPermission perm: (javax.security.jacc.WebUserDataPermission /error.xhtml GET)&gt;      FINE: [Web-Security] hasUserDataPermission isGranted: true&gt;      WARNING: PWC4011: Unable to set request character encoding to UTF-8 from context &gt; /CHAPTER_12_x_Container_Managed_Authentication_and_Authorization, &gt; because request parameters have already been read, or &gt; ServletRequest.getReader() has already been called</code></pre><p><strong>Update 4</strong></p><p>I changed the database, it was wrongly organized so i made some changes in my entities:</p><pre><code>@Entity    @Table(name=""USERS"", schema=""ADMIN"")    public class User implements Serializable {        private static final long serialVersionUID = -1244856316278032177L;        @Id         @Column(nullable = false)        private String userid;          @Column(nullable = false)        private String password;        @ManyToOne        @JoinTable(name=""USER_GROUP"",schema=""ADMIN"", joinColumns = @JoinColumn(name=""userid"", referencedColumnName=""userid""), inverseJoinColumns=@JoinColumn(name=""groupid"", referencedColumnName= ""groupid"") )        private Group group;        //GET &amp; SET METHODS</code></pre><hr><p>@Entity@Table(name=""GROUPS"", schema=""ADMIN"")public class Group implements Serializable {</p><pre><code>private static final long serialVersionUID = -7274308564659753174L;@Id@Column(nullable = false)private String groupid;@OneToMany(mappedBy=""group"")private Set&lt;User&gt; users;</code></pre><p>//GET &amp; SET METHODS</p><p>So i had also to edit the DBRealm, now it looks like this:</p><p><img src=""https://i.stack.imgur.com/Qaw1N.png"" alt=""enter image description here""></p><p>But when i login i get again an exception:</p><pre><code>FINE: [Web-Security] Policy Context ID was: CHAPTER_x_12_Container_Managed_Authentication_and_Authorization/CHAPTER_x_12_Container_Managed_Authentication_and_AuthorizationFINE: [Web-Security] hasUserDataPermission perm: (javax.security.jacc.WebUserDataPermission /j_security_check POST)FINE: [Web-Security] hasUserDataPermission isGranted: trueFINE: Logging in user [user@gmail.com] into realm: DBRealm using JAAS module: jdbcRealmFINE: Login module initialized: class com.sun.enterprise.security.auth.login.JDBCLoginModuleSEVERE: SEC1111: Cannot load group for JDBC realm user [user@gmail.com].FINE: Cannot load groupjava.sql.SQLSyntaxErrorException: Column 'USERID' is either not in any table in the FROM list or appears within a join specification and is outside the scope of the join specification or appears in a HAVING clause and is not in the GROUP BY list. If this is a CREATE or ALTER TABLE  statement then 'USERID' is not a column in the target table.........Caused by: org.apache.derby.client.am.SqlException: Column 'USERID' is either not in any table in the FROM list or appears within a join specification and is outside the scope of the join specification or appears in a HAVING clause and is not in the GROUP BY list. If this is a CREATE or ALTER TABLE  statement then 'USERID' is not a column in the target table.    at org.apache.derby.client.am.Statement.completeSqlca(Unknown Source)........FINE: JAAS login complete.FINE: JAAS authentication committed.FINE: Password login succeeded for : user@gmail.comFINE: permission check done to set SecurityContextFINE: Set security context as user: user@gmail.comFINE: [Web-Security] Policy Context ID was: CHAPTER_x_12_Container_Managed_Authentication_and_Authorization/CHAPTER_x_12_Container_Managed_Authentication_and_AuthorizationFINE: [Web-Security] hasUserDataPermission perm: (javax.security.jacc.WebUserDataPermission  GET)FINE: [Web-Security] hasUserDataPermission isGranted: trueFINE: permission check done to set SecurityContextFINE: SecurityContext: setCurrentSecurityContext method calledFINE: [Web-Security] Policy Context ID was: CHAPTER_x_12_Container_Managed_Authentication_and_Authorization/CHAPTER_x_12_Container_Managed_Authentication_and_AuthorizationFINE: [Web-Security] hasUserDataPermission perm: (javax.security.jacc.WebUserDataPermission /adminpanel.xhtml GET)FINE: [Web-Security] hasUserDataPermission isGranted: trueFINE: [Web-Security] Policy Context ID was: CHAPTER_x_12_Container_Managed_Authentication_and_Authorization/CHAPTER_x_12_Container_Managed_Authentication_and_AuthorizationFINE: [Web-Security] Generating a protection domain for Permission check.FINE: [Web-Security] Checking with Principal : user@gmail.comFINE: [Web-Security] Checking with Principal : visitorsFINE: [Web-Security] Checking with Principal : usersFINE: [Web-Security] Checking with Principal : administratorsFINE: [Web-Security] Codesource with Web URL: file:/CHAPTER_x_12_Container_Managed_Authentication_and_Authorization/CHAPTER_x_12_Container_Managed_Authentication_and_AuthorizationFINE: [Web-Security] Checking Web Permission with Principals : user@gmail.com, visitors, users, administratorsFINE: [Web-Security] Web Permission = (javax.security.jacc.WebResourcePermission /adminpanel.xhtml GET)FINE: [Web-Security] hasResource isGranted: trueFINE: [Web-Security] hasResource perm: (javax.security.jacc.WebResourcePermission /adminpanel.xhtml GET)FINE: SecurityContext: setCurrentSecurityContext method calledWARNING: Resource not found: com/sun/enterprise/v3/admin/adapter/theme/com/sun/webui/jsf/suntheme/images/masthead/masthead_button_over.gif</code></pre>"
"<p>I know that we can access private constructor via reflection as <a href=""https://stackoverflow.com/users/193906/sanjay-t-sharma"">@Sanjay T. Sharma</a> mentioned in his answer of my question: <a href=""https://stackoverflow.com/questions/6636734/does-instanceof-void-always-return-false"">Does â€œinstanceof Voidâ€ always return false?</a></p><p>However, <a href=""https://stackoverflow.com/users/37213/duffymo"">@duffymo</a> <a href=""https://stackoverflow.com/questions/11480181/unit-testing-a-class-with-private-environment-variables/11480226#comment15160872_11480226"">said</a>:</p><blockquote>  <p>you can access private everything with reflection - methods, constructors, data members, everything.</p></blockquote><ol><li>How can I access the private methods and the private data members?</li><li>Is it possible to access local variable via reflection?</li><li>Is there a way to prevent anyone from accessing private constructors, methods, and data members?</li></ol>"
<p>What are competitive free tools for managing java keystores and security certificates?</p><p>Thanks.</p>
"<p>I use BouncyCastle for encryption in my application. When I run it standalone, everything works fine. However, if I put it in the webapp and deploy on JBoss server, I get a following error:</p><pre><code>javax.servlet.ServletException: error constructing MAC: java.security.NoSuchProviderException: JCE cannot authenticate the provider BC(...)root causejava.lang.Exception: error constructing MAC: java.security.NoSuchProviderException: JCE cannot authenticate the provider BC(...)root causejava.io.IOException: error constructing MAC: java.security.NoSuchProviderException: JCE cannot authenticate the provider BC    org.bouncycastle.jce.provider.JDKPKCS12KeyStore.engineLoad(Unknown Source)    java.security.KeyStore.load(Unknown Source)</code></pre><p>Here is a part of the code that causes this error:</p><pre><code>    if (Security.getProvider(BouncyCastleProvider.PROVIDER_NAME) == null)    {        Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider());    }    // Read the Private Key    KeyStore ks = KeyStore.getInstance(""PKCS12"", BouncyCastleProvider.PROVIDER_NAME);    ks.load(new FileInputStream(certificatePath), privateKeyPassword.toCharArray());</code></pre><p>And maven dependency:</p><pre><code>&lt;dependency&gt;    &lt;groupId&gt;bouncycastle&lt;/groupId&gt;    &lt;artifactId&gt;bcmail-jdk16&lt;/artifactId&gt;    &lt;version&gt;140&lt;/version&gt;&lt;/dependency&gt;</code></pre><p>Do you know how could I deploy it?</p>"
"<p>I created a class ""String"" and placed that in package ""java"" [ actually i wanted to create <em>java.lang</em> to see which class is loaded by classLoader as </p><blockquote>  <p>Once a class is loaded into a JVM, the  same class (I repeat, the same  class)  will not be loaded again  </p></blockquote><p>quoted from oreilly ] . But that thing later, why on running this class i am getting<br>java.lang.SecurityException: Prohibited package name: <strong>java</strong>  </p><p>For which security reason java is not allowing me to have a class in <strong>java</strong> package? What one could do if there will not be no such check?</p>"
"<p>I'm currently dealing with a particular issue with my paid application.  Internally it contains a licensing check.  The app is patched by hackers by modifying the app apk/jar.  They are adding a new class which helps bypass the licensing check.</p><p>My goal is to somehow check for this particular patch.  If I find it I know my app has been compromised.  </p><p><strong>Any tips on how to know that something has been modified on the package?</strong>  Doing a hash over the app is not really an option in my case.  </p><p>I thought maybe checking if this class exists would help, but what if they change the name of the class? Then, another idea is somehow check for unexpected includes added to the class.</p><p>Any of these possible? Any suggestions would help :)</p>"
"<p>I've just upgraded JRE to 7u45, and my applet receives a warning message on start-up, saying ""This application will be blocked in a future Java security update because the JAR file manifest does not contain the Permissions attribute."" Then I added the following two attributes to the manifest of my applet Jar file (self-signed):</p><pre><code>Permissions: all-permissionsCodebase: *</code></pre><p>However the warning message didn't disappear. I doubt that I'm missing some other things, but can't find them out after hours of research. Anybody else knows the solution?</p><p><strong>Update</strong></p><p>Trusted applet that is signed with a valid certificate can't run either. The yellow warning message doesn't show up but another error dialog is displayed saying the applet is blocked by the security settings, while changing the security level or something else in Java Control Panel doesn't help.</p>"
"<p>Is there a way to configure Tomcat 7 to create JSESSIONID cookie with a secure flag in all occasions? </p><p>Usual configuration results in Tomcat flagging session cookie with secure flag only if connection is made through https. However in my production scenario, Tomcat is behind a reverse proxy/load balancer which handles (and terminates) the https connection and contacts tomcat over http.</p><p>Can I somehow force secure flag on session cookie with Tomcat, even though connection is made through plain http?</p>"
"<p>A pretty simple requirement. After logging into web J2EE 6 application, how can I have the user logout again? </p><p>Most (all?) the books and tutorials I have seen show how to add a login/loginerror page to their application and demonstrate the use of security principals/roles/realms etc using the ""j_security_check"" method - all good. But then it's not clear how to give the user the power to logout. Indeed, how can I force a logout after, say, the session times out, etc?</p>"
"<p>We use jsp, servlets, beans with mysql database. We don't want to restrict the characters entered by users on form fields. So how do I sanitize the input and how to make sure the output is not changed for malicious activities. Is there way while sending the output I could check if extra code has been sent. Like suppose there is search input field -- the user gives something like <code>&lt;script&gt;alert(""I am here"")&lt;/script&gt;</code>. Is there anway I could know this is a html tag. If the user appends an extra parameter to a link field, is there like a before and after check I could do for the document to realize there has been a extra link field.</p>"
"<p>I'm trying to run a <strong>Java Applet</strong> (html file), but the browser keeps saying: </p><blockquote>  <p>""Your security settings have blocked a local application from running""</p></blockquote><p>I have tried using Chrome and Firefox but i get the same error. I have upgraded to the latest version of Java, but Chrome still says in </p><blockquote>  <p>chrome://plugins/ ""Download Critical Security Update""</p></blockquote><p>even though i can run Java applets (not locally)</p><p>Im using <strong>Ubuntu 13.04 64 bit</strong></p>"
"<p>I have a single installation of java in a system that runs 2 or 3 applications. </p><p>All the applications use the same runtime.</p><p>Is there a way to specify a different keystores for the ca certs than the one in java_home/jre/lib/security. That is, is there an option to specify an ""extra"" keystore that is loaded and added to the certs loaded from java_home/jre/lib/security/cacerts?</p><p>What I want to avoid is having to re-import our local ca every time I upgrade the jdk in the box.</p>"
"<p>I was trying to encrypt data using AES algorithm.However, with the following exception has occurred.</p><pre><code>java.security.NoSuchAlgorithmException:    Cannot find any provider supporting AES/ECB/PKCS7PADDING</code></pre><p>Someone know a solution to this issue?My JDK's version is 1.7.</p>"
"<p>I've been investigating a bit about Java String encryption techniques and unfortunately I haven't find any good tutorial for SHA-512; I read a few blogs about MD5 and Base64, but they are not as secure as I'd like to (actually, Base64 is not an encryption technique), so I prefer SHA-512. </p>"
"<p>After creating secret keys, how do I store them using the Keystore class' methods and how do I load the keys?</p>"
"<p>On my Java EE6, REST service, I want to use authentication tokens for login from mobile devices, User will send their username, password and server will send back a token, which will be used to authorize the user on their further requests for a given time.</p><p>Can I simply create a token myself like this?(I guess I do not need to encrypt this since I will use HTTPS.)</p><pre><code>String token = UUID.randomUUID().toString().toUpperCase()             + ""|"" + ""userid"" + ""|""            + cal.getTimeInMillis();</code></pre><p>Or there is a more standart way to create my tokens? maybe it exists in one of API's </p>"
"<p>Is there any way to completely disable Java security manager? <br/></p><p>I'm experimenting with source code of db4o. It uses reflection to persist objects and it seems that security manager doesn't allow reflection to read and write private or protected fields.</p><p>My code:</p><pre><code>public static void main(String[] args) throws IOException {    System.out.println(""start"");    new File( DB_FILE_NAME ).delete();    ObjectContainer container = Db4o.openFile( DB_FILE_NAME );    String ob = new String( ""test"" );    container.store( ob );    ObjectSet result = container.queryByExample( String.class );    System.out.println( ""retrieved ("" + result.size() + ""):"" );    while( result.hasNext() ) {        System.out.println( result.next() );    }    container.close();    System.out.println(""finish"");}</code></pre><p>Output:</p><pre>start[db4o 7.4.68.12069   2009-04-18 00:21:30]  AccessibleObject#setAccessible() is not available. Private fields can not be stored.retrieved (0):finish</pre><p><br/><a href=""http://developer.db4o.com/forums/permalink/10482/10482/ShowThread.aspx"" rel=""noreferrer""> This thread </a> suggests modifying java.policy file to allow reflection but it doesn't seem to work for me.</p><p>I'm starting JVM with arguments<br><code>-Djava.security.manager -Djava.security.policy==/home/pablo/.java.policy</code> <br/>so specified policy file will be the only policy file used</p><p>The file looks like this:</p><pre>grant {    permission java.security.AllPermission;    permission java.lang.reflect.ReflectPermission ""suppressAccessChecks"";};</pre><p>I spent last 3 hrs on this and don't have any ideas how to make this work.Any help appreciated.</p>"
"<p>Regarding the POODLE vulnerability, if I understand it correctly, it requires a client that automatically downgrades TLS protocol to SSLv3 when failing to establish a secure channel with a server using higher version protocol advertised by the server.</p><p>Do the common java HTTP client libraries, specifically javax.net.ssl.HttpsURLConnection and Apache HttpClient, automatically downgrade the TLS protocol when failing to establish TLS session with a server? If not, am I correct that they are immune from he POODLE attack unless either (a) the server only supports SSLv3, or (b) a logic at a higher level performs the downgrade?</p><p>I'm looking for something like <a href=""http://blog.hagander.net/archives/222-A-few-short-notes-about-PostgreSQL-and-POODLE.html"" rel=""noreferrer"">http://blog.hagander.net/archives/222-A-few-short-notes-about-PostgreSQL-and-POODLE.html</a> but for Java clients.</p>"
"<p>hi I'm trying to follow a simple example about doing a simple login form page that i found in this page <code>http://docs.spring.io/autorepo/docs/spring-security/4.0.x/guides/form.html</code> </p><p>the problem is that iÂ´m getting this error everytime that i try to login i get this error: <code>Expected CSRF token not found. Has your session expired?</code> </p><p>When i get this error i press the back button in my explorer and try a second time to log in and when i do that i get this error: <code>HTTP 403 - Invalid CSRF Token 'null' was found on the request parameter '_csrf' or header 'X-CSRF-TOKEN'</code></p><p>in the tutorial page is this message: <code>We use Thymeleaf to automatically add the CSRF token to our form. If we were not using Thymleaf or Spring MVCs taglib we could also manually add the CSRF token using &lt;input type=""hidden"" name=""${_csrf.parameterName}"" value=""${_csrf.token}""/&gt;</code> </p><p>""so because i am using thymeleaf too i didnt add that tag to my page""</p><p>i found another solution and it works and this solution is adding this to my security config class <code>.csrf().disable()</code> this solution works but i suppose that what this do is to disable csrf protection in my page and i dont want to disable this type of protection. </p><p>this is my security-config class :</p><pre><code>@Configuration@EnableWebSecuritypublic class ConfigSecurity extends WebSecurityConfigurerAdapter {    @Autowired    public void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {        auth            .inMemoryAuthentication()                .withUser(""user"").password(""password"").roles(""USER"");    }    @Override    protected void configure( HttpSecurity http ) throws Exception {        http        //.csrf().disable() is commented because i dont want disable this kind of protection         .authorizeRequests()                .anyRequest().authenticated()                .and()            .formLogin()                .loginPage(""/login"")                .permitAll()                .and()            .logout()                                                    .permitAll();    }}</code></pre><p>my security initialzer :</p><pre><code>public class InitSecurity extends AbstractSecurityWebApplicationInitializer {    public InicializarSecurity() {        super(ConfigSecurity .class);    }}</code></pre><p>my app-config class where i have my thymeleaf configuration</p><pre><code>@EnableWebMvc@ComponentScan(basePackages = {""com.myApp.R10""})@Configurationpublic class ConfigApp extends WebMvcConfigurerAdapter{    @Override    public void addResourceHandlers(ResourceHandlerRegistry registry) {        registry.addResourceHandler(""/css/**"").addResourceLocations(""/css/**"");        registry.addResourceHandler(""/img/**"").addResourceLocations(""/img/**"");        registry.addResourceHandler(""/js/**"").addResourceLocations(""/js/**"");        registry.addResourceHandler(""/sound/**"").addResourceLocations(""/sound/**"");        registry.addResourceHandler(""/fonts/**"").addResourceLocations(""/fonts/**"");    }    @Override    public void configureDefaultServletHandling(DefaultServletHandlerConfigurer configurer) {        configurer.enable();    }    @Bean      public MessageSource messageSource() {        ReloadableResourceBundleMessageSource messageSource = new       ReloadableResourceBundleMessageSource();        messageSource.setBasenames(""classpath:messages/messages"");        messageSource.setUseCodeAsDefaultMessage(true);        messageSource.setDefaultEncoding(""UTF-8"");        messageSource.setCacheSeconds(0);// # -1 : never reload, 0 always reload        return messageSource;    }//  THYMELEAF        @Bean         public ServletContextTemplateResolver templateResolver() {            ServletContextTemplateResolver resolver = new ServletContextTemplateResolver();            resolver.setPrefix(""/WEB-INF/views/pagLogin/"");            resolver.setSuffix("".html"");            resolver.setTemplateMode(""HTML5"");            resolver.setOrder(0);            resolver.setCacheable(false);            return resolver;        }        @Bean         public SpringTemplateEngine templateEngine() {            SpringTemplateEngine engine  =  new SpringTemplateEngine();            engine.setTemplateResolver( templateResolver() );            engine.setMessageSource( messageSource() );            return engine;        }        @Bean         public ThymeleafViewResolver thymeleafViewResolver() {            ThymeleafViewResolver resolver  =  new ThymeleafViewResolver();            resolver.setTemplateEngine( templateEngine() );            resolver.setOrder(1);            resolver.setCache( false );            return resolver;        }        @Bean        public SpringResourceTemplateResolver thymeleafSpringResource() {            SpringResourceTemplateResolver vista = new SpringResourceTemplateResolver();            vista.setTemplateMode(""HTML5"");            return vista;        }}</code></pre><p>my app-config initializer</p><pre><code>public class InicializarApp extends AbstractAnnotationConfigDispatcherServletInitializer {    @Override    protected Class&lt;?&gt;[] getRootConfigClasses() {        return null;    }@Override    protected Class&lt;?&gt;[] getServletConfigClasses() {        return new Class[] { ConfigApp .class };    }    @Override    protected String[] getServletMappings() {        return new String[]{""/""};    }    @Override    protected Filter[] getServletFilters() {        return new Filter[] { new HiddenHttpMethodFilter() };    }}</code></pre><p>my login controller class</p><pre><code>@Controllerpublic class ControllerLogin {    @RequestMapping(value = ""/login"", method = RequestMethod.GET)    public String pageLogin(Model model) {         return ""login"";    }</code></pre><p>my home controller class</p><pre><code>@Controllerpublic class HomeController {        @RequestMapping(value = ""/"", method = RequestMethod.GET)        public String home(Model model) {        return ""home"";        }}</code></pre><p>my login.html</p><pre><code>&lt;html xmlns:th=""http://www.thymeleaf.org"" xmlns:tiles=""http://www.thymeleaf.org""&gt;  &lt;head&gt;    &lt;title tiles:fragment=""title""&gt;Messages : Create&lt;/title&gt;  &lt;/head&gt;  &lt;body&gt;    &lt;div tiles:fragment=""content""&gt;        &lt;form name=""f"" th:action=""@{/login}"" method=""post""&gt;                           &lt;fieldset&gt;                &lt;legend&gt;Please Login&lt;/legend&gt;                &lt;div th:if=""${param.error}"" class=""alert alert-error""&gt;                        Invalid username and password.                &lt;/div&gt;                &lt;div th:if=""${param.logout}"" class=""alert alert-success""&gt;                     You have been logged out.                &lt;/div&gt;                &lt;label for=""username""&gt;Username&lt;/label&gt;                    &lt;input type=""text"" id=""username"" name=""username""/&gt;                        &lt;label for=""password""&gt;Password&lt;/label&gt;                    &lt;input type=""password"" id=""password"" name=""password""/&gt;                    &lt;div class=""form-actions""&gt;                    &lt;button type=""submit"" class=""btn""&gt;Log in&lt;/button&gt;                &lt;/div&gt;                &lt;!-- THIS IS COMMENTED it dont work beacuse i am already using thymeleaf &lt;input type=""hidden"" name=""${_csrf.parameterName}"" value=""${_csrf.token}""/&gt;  --&gt;            &lt;/fieldset&gt;        &lt;/form&gt;    &lt;/div&gt;  &lt;/body&gt;&lt;/html&gt;</code></pre><p>my home.html  page only shows after i log in and the only way i can log in if is a put .csrf().disable() in my Security config class but i dont want to disable that protection , if i dont put that in my security config class i get the errors that i mention at the start of this question.</p>"
"<p>I'm trying to setup a PKCS11 provider for accessing a smartcard.I installed a PKCS11 library on my system and followed the instructions in the <a href=""http://download.oracle.com/javase/1.5.0/docs/guide/security/p11guide.html"" rel=""noreferrer"" title=""Java PKCS#11 Reference Guide"">Java PKCS#11 Reference Guide</a>.In the reference they simply create an instance of <code>sun.security.pkcs11.SunPKCS11</code> and pass the name of the configuration file to the constructor.When I try to compile the following code</p><pre><code>Provider p = new sun.security.pkcs11.SunPKCS11(""pkcs11.cfg"");Security.addProvider(p);</code></pre><p>I get the following error.  </p><blockquote>  <p>Access restriction: The constructor SunPKCS11(String) is not accessible due to restriction on required library /usr/lib/jvm/java-6-sun-1.6.0.24/jre/lib/ext/sunpkcs11.jar</p></blockquote><p>What am I doing wrong?I use Eclipse 3.5 with Java SE 1.6 under Ubuntu x86.</p><p>Best regards. </p>"
"<p>I'm trying to get an application running on top of Tomcat 6 to connect to an LDAP server over SSL.</p><p>I imported certificate of the server to keystore using:</p><pre><code>C:\Program Files\Java\jdk1.6.0_32\jre\lib\security&gt;keytool -importcert -trustcacerts -file mycert -alias ca_alias -keystore ""c:\Program Files\Java\jdk1.6.0_32\jre\lib\security\cacerts""</code></pre><p>When I start Tomcat with SSL debugging turned on, according to logs Tomcat is using the correct certificate file:</p><pre><code>trustStore is: C:\Program Files\Java\jdk1.6.0_32\jre\lib\security\cacerts</code></pre><p>However, Tomcat does not add the cert I just imported - all other certs in the cacerts file are printed to the log - and connection fails:</p><pre><code>handling exception: javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target</code></pre><p>Restarting Tomcat does not help. I have verified with keytool -list command that the new cert indeed exists on the file.</p><p>Why Tomcat keeps on ignoring my new cert?</p><p>EDIT:</p><p>Seems that the issue was caused by Windows 7 VirtualStore. Keytool created a new copy of the cacert file, and Tomcat used the original file.</p>"
"<p>I have a https web service running on java 7. I need to make changes so that this service only accepts tls1.2 connection and reject ssl3, tls1.0 and tls1.1.</p><p>I have added the following java parameter so that tls1.2 is highest priority.</p><pre><code>-Dhttps.protocols=TLSv1.2</code></pre><p>but it also accepts the tls1.0 connections from java clients. if the client is also running with above java parameter, the connection is tls1.2 but if the client is running without this parameter, the connections is tls1.0.</p><p>I did some play around the java.security file in jdk/jre/lib/security folder.</p><p>i currently have following disabled algorithms:</p><pre><code>jdk.certpath.disabledAlgorithms= MD2, MD4, MD5, SHA224, DSA, EC keySize &lt; 256, RSA keySize &lt; 2048, SHA1 keysize &lt; 224jdk.tls.disabledAlgorithms=DSA, DHE, EC keySize &lt; 256, RSA keySize &lt; 2048, SHA1 keysize &lt; 224</code></pre><p>I am using java 7, update 79. I am not inclined towards intercepting each connection and checking the tls version.</p><p>My server certificate is 2048 bit generated with MD5 with RSA algorithm.</p><p>If the disabled algorithm list has RSA in place of RSA keySize &lt; 2048, I get the SSLHandShakeError with error message : no cipher suites in common.</p><p>My test program is running the http server from following URL:<a href=""http://www.herongyang.com/JDK/HTTPS-HttpsEchoer-Better-HTTPS-Server.html"">http://www.herongyang.com/JDK/HTTPS-HttpsEchoer-Better-HTTPS-Server.html</a></p><p>please help how to make java accept only tls 1.2 connections.</p>"
"<p>My co-workers and I are having a problem using Firefox 3.0.6 to access a Java 1.6.0___11 web application we're developing.  Everything works fine anywhere from 1-30 minutes into the session...but eventually, the connection fails and the following error appears:</p><p><code>Secure Connection Failed</code> </p><p><code>An error occurred during a connection to 10.x.x.x.</code></p><p><code>Cannot communicate securely with peer: no common encryption algorithm(s).</code></p><p><code>(Error code: ssl_error_no_cypher_overlap)</code></p><p>IE works fine.  Firefox throws the error in both Windows and Fedora, so the problem doesn't appear to be tied to an OS.  The Java EE application runs on a Tomcat 6.0.16 server.  All pages are encrypted using TLS 1.0 through an Apache 2.2.8 HTTP server with mod_nss.</p><p>Our Apache server is configured to reject SSL 3.0 connections.  One hypothesis we have is that Firefox might be trying to establish a SSL 3.0 connection...but why?</p><p>Based some Googling, we tried the following things, but without success:</p><ul><li><p>using Firefox 2.x (some people reported instances where 2.x worked but 3.x didn't):</p></li><li><p>enabling SSL2</p></li><li><p>disabling SSL3</p></li><li><p>disabling OCSP (Tool > Options > Advanced > Encryption > Validation)</p></li><li><p>ensuring that the anti-virus/firewall of the client computer isn't blocking or scanning port 443 (https port)</p></li></ul><p>Any ideas?</p>"
"<pre><code>final File parentDir = new File(""S:\\PDSPopulatingProgram"");parentDir.mkdir();final String hash = ""popupateData"";final String fileName = hash + "".txt"";final File file = new File(parentDir, fileName);file.createNewFile(); // Creates file PDSPopulatingProgram/popupateData.txt</code></pre><p>I am trying to create a file in a folder but I am getting exception as </p><pre><code>java.security.AccessControlException: Access denied</code></pre><p>I am working in windows environment.  I can create a folder from the Windows Explorer, but not from the Java Code. </p><p>How can I resolve this issue? </p>"
"<p>I guess this is a general question, but I am going through introductory courses to java (SE/ME) and the study material claims that java is often used for ""security purposes"". It does not explain however what they mean by claiming that java incorporates good security. </p><p>Is it hacker proof? Does it produce highly stable software? What? </p><p>Security from my point of view (at the moment) is that it's in the hands of the developer writing the code, not the language itself?</p>"
"<p>I am trying to use ESAPI.jar for providing security to my web application.Basically I have just started using ESAPI.jar.But problem is I am not able to run even a simple program using ESAPI.The small code snippet is:</p><pre><code>String clean = ESAPI.encoder().canonicalize(""someString"");Randomizer r=ESAPI.randomizer();    System.out.println(r);System.out.println(clean);</code></pre><p>I get this error:</p><pre><code>Attempting to load ESAPI.properties via file I/O.Attempting to load ESAPI.properties as resource file via file I/O.Not found in 'org.owasp.esapi.resources' directory or file not readable: D:\Eclipse-Workspace\Test\ESAPI.propertiesNot found in SystemResource Directory/resourceDirectory: .esapi\ESAPI.propertiesNot found in 'user.home' (C:\Documents and Settings\user.user) directory: C:\Documents and Settings\user.user\esapi\ESAPI.propertiesLoading ESAPI.properties via file I/O failed. Exception was: java.io.FileNotFoundExceptionAttempting to load ESAPI.properties via the classpath.ESAPI.properties could not be loaded by any means. Fail. Exception was: java.lang.IllegalArgumentException: Failed to load ESAPI.properties as a classloader resource.Exception in thread ""main"" org.owasp.esapi.errors.ConfigurationException: java.lang.reflect.InvocationTargetException SecurityConfiguration class (org.owasp.esapi.reference.DefaultSecurityConfiguration) CTOR threw exception.    at org.owasp.esapi.util.ObjFactory.make(ObjFactory.java:129)    at org.owasp.esapi.ESAPI.securityConfiguration(ESAPI.java:184)    at org.owasp.esapi.ESAPI.encoder(ESAPI.java:99)    at org.rancore.testJasp.TestEsapi.main(TestEsapi.java:59)Caused by: java.lang.reflect.InvocationTargetException    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)    at java.lang.reflect.Method.invoke(Unknown Source)    at org.owasp.esapi.util.ObjFactory.make(ObjFactory.java:86)    ... 3 moreCaused by: org.owasp.esapi.errors.ConfigurationException: ESAPI.properties could not be loaded by any means. Fail.    at org.owasp.esapi.reference.DefaultSecurityConfiguration.loadConfiguration(DefaultSecurityConfiguration.java:439)    at org.owasp.esapi.reference.DefaultSecurityConfiguration.&lt;init&gt;(DefaultSecurityConfiguration.java:227)    at org.owasp.esapi.reference.DefaultSecurityConfiguration.getInstance(DefaultSecurityConfiguration.java:75)    ... 8 moreCaused by: java.lang.IllegalArgumentException: Failed to load ESAPI.properties as a classloader resource.    at org.owasp.esapi.reference.DefaultSecurityConfiguration.loadConfigurationFromClasspath(DefaultSecurityConfiguration.java:667)    at org.owasp.esapi.reference.DefaultSecurityConfiguration.loadConfiguration(DefaultSecurityConfiguration.java:436)    ... 10 more</code></pre><p>I have tried copying the 3 ESAPI properties files in my source folder and also configuring them on build path but still I have not succeeded. I have tried many permutations and combinations to no avail.</p><p>Please guide me.</p><p>The content of property file is:</p><pre><code># User MessagesError.creating.randomizer=Error creating randomizerThis.is.test.message=This {0} is {1} a test {2} message# Validation Messages# Log Messages</code></pre>"
"<p>I am making a Web application using Backbone.js, Bootstrap, NetBeans IDE 8.0, Java EE 7, JDK 8, WildFly server 8.1.0, JBoss RESTEasy (resteasy-jaxrs-3.0.8), JBoss 2.2.22, JBoss EJB 3.</p><p>I am (relatively) new to Web development, and as such I have only just started to grasp a lot of basic concepts and technologies. I am trying to build a permission system with users and roles into a Web application, but I cannot seem to make the <em>@RolesAllowed annotation</em> to work in my RESTful Web Service. I am already working on this problem for a few days.</p><p>I have a RESTful resource (Java Enterprise/Session Bean?) called <em>UserResource.java</em>, in here I have a method <em>create</em> to create a new user for the application:</p><pre><code>import java.net.URI;import java.security.Principal;import java.util.List;import javax.annotation.security.PermitAll;import javax.annotation.security.RolesAllowed;import javax.ejb.EJB;import javax.ejb.Stateless;import javax.ws.rs.*;import javax.ws.rs.core.*;import org.jboss.ejb3.annotation.SecurityDomain;@Stateless@SecurityDomain(""other"")@Path(""/user"")public class UserResource {    @EJB(name = ""UserServiceImp"")    UserService userService;    @Context    private UriInfo uriInfo;    @RolesAllowed({""admin""})    @Path(""create"")    @POST    public Response create(CreateRequest request) {                try {            System.out.println(""Start of create method"");            User user = userService.createUser(request);            return getCreateResponse(user);        }        catch (Exception e){            return Response.status(401).entity(""Failed to create user"").build();        }    }}</code></pre><p>This <em>create</em> method works if I use the @PermitAll annotation, but it fails with an error if I use the @RolesAllowed annotation.</p><p>I have this Backbone view <em>CreateUserView</em> which provides a form (in HTML) to an end user (with admin rights) for creating new users for the application. On clicking the submit button, JSON data gets send to the url 'rest/user/create' for creating a new user. Before the <em>create</em> method in <em>UserResource.java</em> gets executed, my <em>SecurityInterceptor.java</em> (which implements <em>javax.ws.rs.container.ContainerRequestFilter</em>) checks if the user has the required permissions. I have debugged this thorough and the Security Interceptor is functioning as it should. So after the Security Interceptor gives clear access, something goes wrong in <em>UserResource.java</em>. (As a side note, not sure if this is important, but I believe the Security Interceptor is based on <a href=""http://howtodoinjava.com/2013/07/25/jax-rs-2-0-resteasy-3-0-2-final-security-tutorial/"" rel=""nofollow noreferrer"">this blog post about RESTEasy security</a>. I was working on the application with another guy, he initially implemented it, so I'm not sure.. but it looks almost identical. Anyway that guy has moved on to another project a few weeks ago.)</p><p>The error I am getting (output from the server) is the following:</p><pre><code>16:45:25,775 ERROR [org.jboss.as.ejb3.invocation] (default task-60) JBAS014134: EJB Invocation failed on component UserResource for method public javax.ws.rs.core.Response org.profit.pgb.rest.resource.UserResource.create(org.profit.pgb.rest.api.CreateRequest): javax.ejb.EJBAccessException: JBAS014502: Invocation on method: public javax.ws.rs.core.Response org.profit.pgb.rest.resource.UserResource.create(org.profit.pgb.rest.api.CreateRequest) of bean: UserResource is not allowed    at org.jboss.as.ejb3.security.AuthorizationInterceptor.processInvocation(AuthorizationInterceptor.java:135) [wildfly-ejb3-8.1.0.Final.jar:8.1.0.Final]    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:309)    at org.jboss.as.ejb3.security.SecurityContextInterceptor.processInvocation(SecurityContextInterceptor.java:95) [wildfly-ejb3-8.1.0.Final.jar:8.1.0.Final]    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:309)    at org.jboss.as.ejb3.component.interceptors.ShutDownInterceptorFactory$1.processInvocation(ShutDownInterceptorFactory.java:64) [wildfly-ejb3-8.1.0.Final.jar:8.1.0.Final]    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:309)    at org.jboss.as.ejb3.component.interceptors.LoggingInterceptor.processInvocation(LoggingInterceptor.java:59) [wildfly-ejb3-8.1.0.Final.jar:8.1.0.Final]    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:309)    at org.jboss.as.ee.component.NamespaceContextInterceptor.processInvocation(NamespaceContextInterceptor.java:50)    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:309)    at org.jboss.as.ejb3.component.interceptors.AdditionalSetupInterceptor.processInvocation(AdditionalSetupInterceptor.java:55) [wildfly-ejb3-8.1.0.Final.jar:8.1.0.Final]    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:309)    at org.jboss.invocation.ContextClassLoaderInterceptor.processInvocation(ContextClassLoaderInterceptor.java:64)    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:309)    at org.jboss.invocation.InterceptorContext.run(InterceptorContext.java:326)    at org.wildfly.security.manager.WildFlySecurityManager.doChecked(WildFlySecurityManager.java:448)    at org.jboss.invocation.AccessCheckingInterceptor.processInvocation(AccessCheckingInterceptor.java:61)    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:309)    at org.jboss.invocation.InterceptorContext.run(InterceptorContext.java:326)    at org.jboss.invocation.PrivilegedWithCombinerInterceptor.processInvocation(PrivilegedWithCombinerInterceptor.java:80)    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:309)    at org.jboss.invocation.ChainedInterceptor.processInvocation(ChainedInterceptor.java:61)    at org.jboss.as.ee.component.ViewService$View.invoke(ViewService.java:185)    at org.jboss.as.ee.component.ViewDescription$1.processInvocation(ViewDescription.java:182)    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:309)    at org.jboss.invocation.ChainedInterceptor.processInvocation(ChainedInterceptor.java:61)    at org.jboss.as.ee.component.ProxyInvocationHandler.invoke(ProxyInvocationHandler.java:73)    at org.profit.pgb.rest.resource.UserResource$$$view45.create(Unknown Source) [classes:]    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [rt.jar:1.8.0_11]    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) [rt.jar:1.8.0_11]    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) [rt.jar:1.8.0_11]    at java.lang.reflect.Method.invoke(Method.java:483) [rt.jar:1.8.0_11]    at org.jboss.weld.util.reflection.Reflections.invokeAndUnwrap(Reflections.java:401) [weld-core-impl-2.1.2.Final.jar:2014-01-09 09:23]    at org.jboss.weld.bean.proxy.EnterpriseBeanProxyMethodHandler.invoke(EnterpriseBeanProxyMethodHandler.java:99) [weld-core-impl-2.1.2.Final.jar:2014-01-09 09:23]    at org.jboss.weld.bean.proxy.EnterpriseTargetBeanInstance.invoke(EnterpriseTargetBeanInstance.java:56) [weld-core-impl-2.1.2.Final.jar:2014-01-09 09:23]    at org.jboss.weld.bean.proxy.InjectionPointPropagatingEnterpriseTargetBeanInstance.invoke(InjectionPointPropagatingEnterpriseTargetBeanInstance.java:65) [weld-core-impl-2.1.2.Final.jar:2014-01-09 09:23]    at org.jboss.weld.bean.proxy.ProxyMethodHandler.invoke(ProxyMethodHandler.java:100) [weld-core-impl-2.1.2.Final.jar:2014-01-09 09:23]    at org.profit.pgb.rest.resource.UserResource$Proxy$_$$_Weld$EnterpriseProxy$.create(Unknown Source) [classes:]    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [rt.jar:1.8.0_11]    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) [rt.jar:1.8.0_11]    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) [rt.jar:1.8.0_11]    at java.lang.reflect.Method.invoke(Method.java:483) [rt.jar:1.8.0_11]    at org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:137) [resteasy-jaxrs-3.0.8.Final.jar:]    at org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTarget(ResourceMethodInvoker.java:296) [resteasy-jaxrs-3.0.8.Final.jar:]    at org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:250) [resteasy-jaxrs-3.0.8.Final.jar:]    at org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:237) [resteasy-jaxrs-3.0.8.Final.jar:]    at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:356) [resteasy-jaxrs-3.0.8.Final.jar:]    at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:179) [resteasy-jaxrs-3.0.8.Final.jar:]    at org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:220) [resteasy-jaxrs-3.0.8.Final.jar:]    at org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:56) [resteasy-jaxrs-3.0.8.Final.jar:]    at org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:51) [resteasy-jaxrs-3.0.8.Final.jar:]    at javax.servlet.http.HttpServlet.service(HttpServlet.java:790) [jboss-servlet-api_3.1_spec-1.0.0.Final.jar:1.0.0.Final]    at io.undertow.servlet.handlers.ServletHandler.handleRequest(ServletHandler.java:85) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.servlet.handlers.security.ServletSecurityRoleHandler.handleRequest(ServletSecurityRoleHandler.java:61) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.servlet.handlers.ServletDispatchingHandler.handleRequest(ServletDispatchingHandler.java:36) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at org.wildfly.extension.undertow.security.SecurityContextAssociationHandler.handleRequest(SecurityContextAssociationHandler.java:78)    at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:25) [undertow-core-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.servlet.handlers.security.SSLInformationAssociationHandler.handleRequest(SSLInformationAssociationHandler.java:113) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.servlet.handlers.security.ServletAuthenticationCallHandler.handleRequest(ServletAuthenticationCallHandler.java:56) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:25) [undertow-core-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.security.handlers.AuthenticationConstraintHandler.handleRequest(AuthenticationConstraintHandler.java:51) [undertow-core-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.security.handlers.AbstractConfidentialityHandler.handleRequest(AbstractConfidentialityHandler.java:45) [undertow-core-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.servlet.handlers.security.ServletConfidentialityConstraintHandler.handleRequest(ServletConfidentialityConstraintHandler.java:61) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.servlet.handlers.security.ServletSecurityConstraintHandler.handleRequest(ServletSecurityConstraintHandler.java:56) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.security.handlers.AuthenticationMechanismsHandler.handleRequest(AuthenticationMechanismsHandler.java:58) [undertow-core-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.servlet.handlers.security.CachedAuthenticatedSessionHandler.handleRequest(CachedAuthenticatedSessionHandler.java:70) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.security.handlers.SecurityInitialHandler.handleRequest(SecurityInitialHandler.java:76) [undertow-core-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:25) [undertow-core-1.0.15.Final.jar:1.0.15.Final]    at org.wildfly.extension.undertow.security.jacc.JACCContextIdHandler.handleRequest(JACCContextIdHandler.java:61)    at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:25) [undertow-core-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:25) [undertow-core-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.servlet.handlers.ServletInitialHandler.handleFirstRequest(ServletInitialHandler.java:240) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.servlet.handlers.ServletInitialHandler.dispatchRequest(ServletInitialHandler.java:227) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.servlet.handlers.ServletInitialHandler.access$000(ServletInitialHandler.java:73) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.servlet.handlers.ServletInitialHandler$1.handleRequest(ServletInitialHandler.java:146) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.server.Connectors.executeRootHandler(Connectors.java:177) [undertow-core-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.server.HttpServerExchange$1.run(HttpServerExchange.java:727) [undertow-core-1.0.15.Final.jar:1.0.15.Final]    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [rt.jar:1.8.0_11]    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [rt.jar:1.8.0_11]    at java.lang.Thread.run(Thread.java:745) [rt.jar:1.8.0_11]16:45:25,957 ERROR [io.undertow.request] (default task-60) UT005023: Exception handling request to /pgb/rest/user/create: org.jboss.resteasy.spi.UnhandledException: javax.ejb.EJBAccessException: JBAS014502: Invocation on method: public javax.ws.rs.core.Response org.profit.pgb.rest.resource.UserResource.create(org.profit.pgb.rest.api.CreateRequest) of bean: UserResource is not allowed    at org.jboss.resteasy.core.ExceptionHandler.handleApplicationException(ExceptionHandler.java:76) [resteasy-jaxrs-3.0.8.Final.jar:]    at org.jboss.resteasy.core.ExceptionHandler.handleException(ExceptionHandler.java:212) [resteasy-jaxrs-3.0.8.Final.jar:]    at org.jboss.resteasy.core.SynchronousDispatcher.writeException(SynchronousDispatcher.java:149) [resteasy-jaxrs-3.0.8.Final.jar:]    at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:372) [resteasy-jaxrs-3.0.8.Final.jar:]    at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:179) [resteasy-jaxrs-3.0.8.Final.jar:]    at org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:220) [resteasy-jaxrs-3.0.8.Final.jar:]    at org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:56) [resteasy-jaxrs-3.0.8.Final.jar:]    at org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:51) [resteasy-jaxrs-3.0.8.Final.jar:]    at javax.servlet.http.HttpServlet.service(HttpServlet.java:790) [jboss-servlet-api_3.1_spec-1.0.0.Final.jar:1.0.0.Final]    at io.undertow.servlet.handlers.ServletHandler.handleRequest(ServletHandler.java:85) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.servlet.handlers.security.ServletSecurityRoleHandler.handleRequest(ServletSecurityRoleHandler.java:61) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.servlet.handlers.ServletDispatchingHandler.handleRequest(ServletDispatchingHandler.java:36) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at org.wildfly.extension.undertow.security.SecurityContextAssociationHandler.handleRequest(SecurityContextAssociationHandler.java:78)    at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:25) [undertow-core-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.servlet.handlers.security.SSLInformationAssociationHandler.handleRequest(SSLInformationAssociationHandler.java:113) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.servlet.handlers.security.ServletAuthenticationCallHandler.handleRequest(ServletAuthenticationCallHandler.java:56) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:25) [undertow-core-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.security.handlers.AuthenticationConstraintHandler.handleRequest(AuthenticationConstraintHandler.java:51) [undertow-core-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.security.handlers.AbstractConfidentialityHandler.handleRequest(AbstractConfidentialityHandler.java:45) [undertow-core-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.servlet.handlers.security.ServletConfidentialityConstraintHandler.handleRequest(ServletConfidentialityConstraintHandler.java:61) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.servlet.handlers.security.ServletSecurityConstraintHandler.handleRequest(ServletSecurityConstraintHandler.java:56) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.security.handlers.AuthenticationMechanismsHandler.handleRequest(AuthenticationMechanismsHandler.java:58) [undertow-core-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.servlet.handlers.security.CachedAuthenticatedSessionHandler.handleRequest(CachedAuthenticatedSessionHandler.java:70) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.security.handlers.SecurityInitialHandler.handleRequest(SecurityInitialHandler.java:76) [undertow-core-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:25) [undertow-core-1.0.15.Final.jar:1.0.15.Final]    at org.wildfly.extension.undertow.security.jacc.JACCContextIdHandler.handleRequest(JACCContextIdHandler.java:61)    at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:25) [undertow-core-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:25) [undertow-core-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.servlet.handlers.ServletInitialHandler.handleFirstRequest(ServletInitialHandler.java:240) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.servlet.handlers.ServletInitialHandler.dispatchRequest(ServletInitialHandler.java:227) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.servlet.handlers.ServletInitialHandler.access$000(ServletInitialHandler.java:73) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.servlet.handlers.ServletInitialHandler$1.handleRequest(ServletInitialHandler.java:146) [undertow-servlet-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.server.Connectors.executeRootHandler(Connectors.java:177) [undertow-core-1.0.15.Final.jar:1.0.15.Final]    at io.undertow.server.HttpServerExchange$1.run(HttpServerExchange.java:727) [undertow-core-1.0.15.Final.jar:1.0.15.Final]    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [rt.jar:1.8.0_11]    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [rt.jar:1.8.0_11]    at java.lang.Thread.run(Thread.java:745) [rt.jar:1.8.0_11]Caused by: javax.ejb.EJBAccessException: JBAS014502: Invocation on method: public javax.ws.rs.core.Response org.profit.pgb.rest.resource.UserResource.create(org.profit.pgb.rest.api.CreateRequest) of bean: UserResource is not allowed    at org.jboss.as.ejb3.security.AuthorizationInterceptor.processInvocation(AuthorizationInterceptor.java:135) [wildfly-ejb3-8.1.0.Final.jar:8.1.0.Final]    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:309)    at org.jboss.as.ejb3.security.SecurityContextInterceptor.processInvocation(SecurityContextInterceptor.java:95) [wildfly-ejb3-8.1.0.Final.jar:8.1.0.Final]    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:309)    at org.jboss.as.ejb3.component.interceptors.ShutDownInterceptorFactory$1.processInvocation(ShutDownInterceptorFactory.java:64) [wildfly-ejb3-8.1.0.Final.jar:8.1.0.Final]    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:309)    at ... etc. (not fully shown due to SO's character limit on questions..)</code></pre><p>I've seen other people ask similar questions, some which remain unanswered to this day (e.g. <a href=""https://stackoverflow.com/questions/19863311/jax-rs-service-rolesallowed-annotation-throwing-exception"">jax-rs service RolesAllowed Annotation throwing exception</a>) and others which have solutions that either do not work for me or maybe I do not apply the solution correctly (e.g. <a href=""https://stackoverflow.com/questions/24591782/resteasy-support-for-jax-rs-rolesallowed"">RESTEasy support for JAX-RS @RolesAllowed</a>).</p><p>I found this: <a href=""https://developer.jboss.org/thread/177728?start=0&amp;tstart=0"" rel=""nofollow noreferrer"">https://developer.jboss.org/thread/177728?start=0&amp;tstart=0</a> (titled: <em>""@RolesAllowed, @DenyAll require presence of org.jboss.ejb3.annotation.SecurityDomain?""</em>), In tried the solution but I cannot get it to work for my project. Not sure if the solution is not applicable for my situation or if I'm just doing it wrong.</p><p>I found this: <a href=""https://developer.jboss.org/message/720815"" rel=""nofollow noreferrer"">https://developer.jboss.org/message/720815</a> (titled: <em>""is this a defect for processing org.jboss.ejb3.annotation.SecurityDomain ?""</em>), but I do not understand where my <em>jboss-ejb-client.properties</em> are supposed to be. I think they set their project up quite different from me. So no luck with that.</p><p>I found <a href=""https://github.com/jboss-eap/quickstart/tree/master-eap6/ejb-security"" rel=""nofollow noreferrer"">a guide on EJB3 security</a>, as suggested there, I provided the following code in my <em>standalone.xml</em>-file:</p><pre><code>&lt;security-domain name=""other"" cache-type=""default""&gt;    &lt;authentication&gt;        &lt;login-module code=""Remoting"" flag=""optional""&gt;            &lt;module-option name=""password-stacking"" value=""useFirstPass""/&gt;        &lt;/login-module&gt;        &lt;login-module code=""RealmDirect"" flag=""required""&gt;            &lt;module-option name=""password-stacking"" value=""useFirstPass""/&gt;        &lt;/login-module&gt;    &lt;/authentication&gt;&lt;/security-domain&gt;</code></pre><p>But that did not solve anything at all. I am not sure if it did anything.</p><p>Finally, I found this SO question: <a href=""https://stackoverflow.com/questions/24591782/resteasy-support-for-jax-rs-rolesallowed"">RESTEasy support for JAX-RS @RolesAllowed</a> (which references to the <a href=""http://docs.jboss.org/resteasy/docs/3.0.5.Final/userguide/html/Securing_JAX-RS_and_RESTeasy.html"" rel=""nofollow noreferrer"">RESTEasy Documentation</a>). Even though I also mentioned this question a few paragraphs up as containing a solution that does not work for me, it did change the error to another error. As suggested there I added a <em>&lt;context-param&gt;</em>-block to my <em>web.xml</em>-file:</p><pre><code>&lt;?xml version=""1.0"" encoding=""UTF-8""?&gt;&lt;web-app version=""2.5"" xmlns=""http://java.sun.com/xml/ns/javaee"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xsi:schemaLocation=""http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd""&gt;    &lt;security-constraint&gt;        &lt;web-resource-collection&gt;            &lt;web-resource-name&gt;PGB&lt;/web-resource-name&gt;            &lt;url-pattern&gt;/*&lt;/url-pattern&gt;            &lt;http-method&gt;GET&lt;/http-method&gt;            &lt;http-method&gt;POST&lt;/http-method&gt;        &lt;/web-resource-collection&gt;        &lt;user-data-constraint&gt;            &lt;!-- use of SSL is required when CONFIDENTIAL is specified --&gt;            &lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt;        &lt;/user-data-constraint&gt;    &lt;/security-constraint&gt;    &lt;context-param&gt;      &lt;param-name&gt;resteasy.role.based.security&lt;/param-name&gt;      &lt;param-value&gt;true&lt;/param-value&gt;   &lt;/context-param&gt;&lt;/web-app&gt;</code></pre><p>Which results in the following error if I try to create a new user (not completely posted here due to character limit of SO questions):</p><pre><code>16:58:45,992 WARN  [org.jboss.resteasy.core.ExceptionHandler] (default task-61) failed to execute: javax.ws.rs.ForbiddenException: HTTP 403 Forbidden    at org.jboss.resteasy.plugins.interceptors.RoleBasedSecurityFilter.filter(RoleBasedSecurityFilter.java:45) [resteasy-jaxrs-3.0.8.Final.jar:]    at ... etc.</code></pre><p>This error is not very helpful either, in fact, I find even less information when I search on that error than when I search on the previous error. So, I am not sure if that is a step into the right direction. What is better to have returned from the server? A status 500 (Internal Server Error) or a status 403 (Forbidden)? Also, if after applying that ""solution"" I change the annotation to @PermitAll, then the creation of a new user works just as before, so it didn't really make the situation any worse.</p><p>However, I can find <a href=""https://github.com/resteasy/Resteasy/blob/master/jaxrs/resteasy-jaxrs/src/main/java/org/jboss/resteasy/plugins/interceptors/RoleBasedSecurityFilter.java"" rel=""nofollow noreferrer"">the source code of RoleBasedSecurityFilter</a>, which shows that it throws the <code>ForbiddenException</code>. It shows that a certain <em>isUserInRole</em> method must return true, but it does not do that in my application. I can't get it to return true. It makes me wonder, <a href=""https://stackoverflow.com/q/26039920/2541501"">Is it possible to disable RoleBasedSecurityFilter.java of RESTEasy?</a></p><p>I also found the following SO question: <a href=""https://stackoverflow.com/questions/15188895/rolesallowed-cannot-be-resolved-with-jersey"">@RolesAllowed cannot be resolved with Jersey</a>, which is answered by Abhijit Sarkar, and he refers to <a href=""http://www-01.ibm.com/support/knowledgecenter/SSAW57_8.5.5/com.ibm.websphere.nd.multiplatform.doc/ae/twbs_jaxrs_impl_securejaxrs_webcont.html?cp=SSAW57_8.5.5%2F3-3-0-42-3-0"" rel=""nofollow noreferrer"">an IBM article</a>. Maybe the solution to my problem lies in there, but I have not found it yet.. Anyway, it is suggested there that either adding a <em>security-role</em> block to my <em>web.xml</em>-file or adding a <em>@DeclareRoles</em> annotation to my <em>UserResource.java</em> file should solve the problem, but the HTTP 403 Forbidden warning still remains after I do so. It is very frustrating.</p><p>My <em>security-role</em> block (in web.xml) looks as follows:</p><pre><code>&lt;security-role id=""role_admin""&gt;    &lt;description&gt;This is role 1 (admin)&lt;/description&gt;    &lt;role-name&gt;admin&lt;/role-name&gt;&lt;/security-role&gt;</code></pre><p>And I added the following <em>security-constraint</em> block (in web.xml): (note the <em>auth-constraint</em>)</p><pre><code>&lt;security-constraint&gt;    &lt;web-resource-collection&gt;        &lt;web-resource-name&gt;PGB&lt;/web-resource-name&gt;        &lt;url-pattern&gt;/rest/user/create&lt;/url-pattern&gt;        &lt;http-method&gt;GET&lt;/http-method&gt;        &lt;http-method&gt;POST&lt;/http-method&gt;    &lt;/web-resource-collection&gt;    &lt;auth-constraint id=""AuthConstraint_createUser""&gt;        &lt;description&gt; Only admin can create a new user&lt;/description&gt;        &lt;role-name&gt;admin&lt;/role-name&gt;    &lt;/auth-constraint&gt;    &lt;user-data-constraint&gt;        &lt;!-- use of SSL is required when CONFIDENTIAL is specified --&gt;        &lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt;    &lt;/user-data-constraint&gt;&lt;/security-constraint&gt;</code></pre><p>I realize now that my problem lies either in the deployment descriptors (<em>web.xml</em>) or the server configuration (WildFly's <em>standalone-full.xml</em>).</p><p>I added a <code>login-config</code> element (with <a href=""http://docs.oracle.com/cd/E19798-01/821-1841/bncbn/index.html"" rel=""nofollow noreferrer"">FORM authentication</a>) to my <em>web.xml</em> file. Changed my login HTML page to fit <a href=""http://docs.oracle.com/cd/E19798-01/821-1841/bncca/index.html"" rel=""nofollow noreferrer"">the required format</a>. I followed some of the step of this article on <a href=""http://docs.oracle.com/cd/E19798-01/821-1841/bncca/index.html"" rel=""nofollow noreferrer"">migrating a Java EE App from GlassFish to WildFly</a>, but I think I still did something wrong because I always get at the login error page when trying to log in with valid user credentials.</p><p>See here the <code>security-domain</code> element I added to my WildFly configuration:</p><pre><code>&lt;security-domain name=""app"" cache-type=""default""&gt;    &lt;authentication&gt;        &lt;login-module code=""Database"" flag=""required""&gt;            &lt;module-option name=""dsJndiName"" value=""java:jboss/datasources/mySQL_pool_rel""/&gt;            &lt;module-option name=""principalsQuery"" value=""select hashed_password from user where email_address=?""/&gt;            &lt;module-option name=""rolesQuery"" value=""select role_name, 'Roles' from role r inner join user u on r.role_type = u.role_type where u.email_address = ?""/&gt;            &lt;module-option name=""hashAlgorithm"" value=""SHA-256""/&gt;            &lt;module-option name=""hashEncoding"" value=""BASE64""/&gt;            &lt;module-option name=""unauthenticatedIdentity"" value=""guest""/&gt;        &lt;/login-module&gt;        &lt;login-module code=""RoleMapping"" flag=""required""&gt;             &lt;module-option name=""rolesProperties"" value=""file:${jboss.server.config.dir}/app.properties""/&gt;             &lt;module-option name=""replaceRole"" value=""false""/&gt;        &lt;/login-module&gt;    &lt;/authentication&gt;&lt;/security-domain&gt;</code></pre><p>I think something is wrong with my <em>rolesQuery</em> defined there, but I can't figure out what.</p><p>I would love to know how to implement role-based security for my Web application. Therefore, I also accept other approaches to role-based security, as long as it works. Suggestions are welcome.</p><p>I also placed <a href=""https://developer.jboss.org/thread/248877"" rel=""nofollow noreferrer"">my question on developer.jboss.org</a>, but I also got no response there yet.</p><p>I provided one workaround solution to my problem as an answer to this question, but it is not a real solution (as explained in that answer). I am still interested in doing this the right way.</p>"
"<p>I am trying to save additional data in de user principal object.</p><p>What i did was:</p><p>implement the ""UserDetails"" interface to my existing user class where my additional data is saved ( like email address etc. ).</p><pre><code>@Entitypublic class User implements UserDetails {</code></pre><p>Then i created a UserDetailsService implementation:</p><pre><code>@Servicepublic class UserDetailsServiceImpl implements UserDetailsService {    @Autowired    UserDAO userDAO;    @Override    public UserDetails loadUserByUsername(String username)            throws UsernameNotFoundException {        User user = userDAO.findOneByUsername(username);        if (user == null)            throw new UsernameNotFoundException(""username "" + username                    + "" not found"");        System.out.println(""---------------------&gt; FOUND -------------&gt;""                + user.getEmail());        return user;    }}</code></pre><p>Last step was to add the UserDetailsService in my Security configuration.</p><pre><code>@Configuration@EnableWebMvcSecuritypublic class SecurityConfiguration extends WebSecurityConfigurerAdapter {@AutowiredUserDetailsService userDetailsService;@Overrideprotected void configure(AuthenticationManagerBuilder auth)        throws Exception {    auth.userDetailsService(userDetailsService());// ...}@Overrideprotected void configure(HttpSecurity http) throws Exception {    http.userDetailsService(userDetailsService());// ...}@Overrideprotected UserDetailsService userDetailsService() {    return userDetailsService;}</code></pre><p>I see in my console that ""loadUserByName"" gets called twice ( because of the ""Found"" output ).</p><p>When i try to access the principal object in my controller -></p><pre><code>System.out.println(SecurityContextHolder.getContext()                .getAuthentication().getPrincipal());</code></pre><p>I dont get my additional data.When i try to cast it to my User object i get a could not cast exception.</p><p>Is there anything I am missing??</p><p>Thank you in advance.</p>"
"<p>I am having a very big problem. That is ""How to Create License for my software"". </p><p>OK, Think this is my License key - 12345YW</p><p>when the user enter this license key , the software should allow him to use the software. All right, once the user enter the license key, my software must remember he has entered the valid key, right?(because from next time onwards, it don't have to prompt license dialog) My question is, How can I make my software to remember the user had entered the license? In windows based apps, what most of they do is entering an entry to the windows registry. Can I do the same? (Then what about Ubuntu and Mac?) </p><p>I thought of writing a .txt file so m software can read it and find whether license is entered or not. However that is the most secureless system I can think of. </p><p>So, if I enter the above license key, how can I make my software to remember it? I am really glad if you can give me a code example too (i.e: I don't know how to edit the registry, in case of windows registry, etc). Please help me...</p>"
<p>I created Java keystore programmatically of type jks (i.e. default type).<br>It is initially empty so I created a DSA certificate.  </p><pre><code>keytool -genkey -alias myCert -v -keystore trivial.keystore</code></pre><p>How can I see the public and private keys?<br>I.e. is there a command that prints the private key of my certificate?<br>I could only find <code>keytool -certreq</code> which in my understanding prints the certificate as a whole:</p><pre><code>-----BEGIN NEW CERTIFICATE REQUEST-----MIICaTCCAicCAQAwZTELMAkGA1UEBhMCR1IxDzANBgNVBAgTBkdyZWVjZTEPMA0GA1UEBxMGQXRoBQADLwAwLAIUQZbY/3Qq0G26fsBbWiHMbuVd3VICFE+gwtUauYiRbHh0caAtRj3qRTwl-----END NEW CERTIFICATE REQUEST-----</code></pre><p>I assume this is the whole certificate. How can I see private (or public key) via keytool?  </p>
"<p>In JBoss AS 5, I have a datasource defined in *-ds.xml but put username/encrypted password in *-jboss-beans.xml.</p><p>Now in JBoss AS 7.1, the datasource is defined in standalone.xml or domain.xml.Where do I put the encrypted password in AS 7.1?</p><p>In other words, how is a clear password encrypted and secured in AS 7?</p>"
"<p>I want to use Windows NTLM authentication in my Java application to authenticate intranet users transparently. The users should not notice any authentication if using their browsers (single sign-on).</p><p>I've found a few libs with NTLM support, but don't know which one to use:</p><ul><li><a href=""http://spnego.sourceforge.net/"">http://spnego.sourceforge.net/</a></li><li><a href=""http://sourceforge.net/projects/ntlmv2auth/"">http://sourceforge.net/projects/ntlmv2auth/</a></li><li><a href=""http://jcifs.samba.org/"">http://jcifs.samba.org/</a></li><li><a href=""http://www.ioplex.com/jespa.html"">http://www.ioplex.com/jespa.html</a></li><li><a href=""http://www.luigidragone.com/software/ntlm-authentication-in-java/"">http://www.luigidragone.com/software/ntlm-authentication-in-java/</a></li></ul><p>Any suggestions where to start?</p>"
"<p>I convert the secretkey into bytes with following code</p><pre><code>SecretKey key = KeyGenerator.getInstance(""DES"").generateKey();byte[] bkey=key.getEncoded();</code></pre><p>Now how do I get the key from <code>bkey</code>? I tried:</p><pre><code>SecretKeySpec secretkey = new SecretKeySpec(bkey,""DES"");   SecretKeyFactory sfkey = SecretKeyFactory.getInstance(""DES"");SecretKey skey = sfkey.generateSecret(secretkey);</code></pre><p>I get the following error:</p><pre><code>Error during Exception java.security.spec.InvalidKeySpecException: Inappropriate key specification</code></pre>"
"<p>I generate a certificate using the keytool command:</p><pre><code>keytool -genkeypair -alias myRSAKey -keyalg RSA -keysize 1024 -keystore test.p12 -storepass test -storetype pkcs12</code></pre><p>Then if I try to load it using java security API, after getting the file as a byte[] :</p><pre><code>KeyStore ks = KeyStore.getInstance(""PKCS12"");try{   ks.load(new ByteArrayInputStream(data), ""test"".toCharArray())} catch (Exception e){   ...}</code></pre><p>I get a DerInputStream.getLength(): lengthTag=127, too big exception.</p><p>What is wrong?</p>"
"<p>I have a Java Applet inserted on a simple HTML page located at <a href=""http://localhost:8080/index.html"" rel=""noreferrer"">http://localhost:8080/index.html</a>:</p><pre><code>&lt;applet id=""applet"" code=""SomeCode.class"" archive=""lib.jar"" Width=""1"" Height=""1""&gt;&lt;/applet&gt;</code></pre><p>The Java Applet has a method that looks similar to the code below:</p><pre><code>public void PostStuffToServer() {  String server = ""http://localhost:8080/PostHandler.ashx"";  URL u = new URL(server);  URLConnection con = u.openConnection();  con.setDoOutput(true);  con.getOutputStream().write(stream.toByteArray());  con.connect();}</code></pre><p>When I execute the applet code from JavaScript like so:</p><pre><code>obj = document.getElementById('applet');obj.getClipboardImageURL();</code></pre><p>I get the following error:</p><p><em>access denied (java.net.SocketPermission 127.0.0.1:8080 connect,resolve)</em></p><p>It seems like the Java code resolves the domain <em>localhost</em> to its equivalent IP address and therefore raises a cross domain security restrain. It works fine when I execute the same code from <a href=""http://127.0.0.1:8080/index.html"" rel=""noreferrer"">http://127.0.0.1:8080/index.html</a>. The lib.jar file is signed.</p><p>Is there anyway to avoid this?</p>"
"<p>I wrote a custom security provider for AES/CBC/PKCS5Padding. That works fine.</p><p>What settings do I need to add to the <code>Provider</code> in order for Java to recognize it as a valid provider for the above algorithm? I already have</p><pre><code>public class FooBarProvider extends Provider {  public FooBarProvider() {    super(""FooBar"", 1.0, ""Provider for AES."");    put(""Cipher.AES"", ""foo.bar.AESCipher"");  }}</code></pre><p>where the latter argument is the actual <code>CipherSpi</code> that does the work. Where do I register the fact that it supports CBC and PKCS5Padding? Currently asking for a relevant <code>Cipher</code> does not return an instance of my class:</p><pre><code>Security.insertProviderAt(new FooBarProvider(), 1);Cipher cip = Cipher.getInstance(""AES/CBC/PKCS5Padding"");System.out.println(cip.getProvider()); //prints ""SunJCE version 1.7""</code></pre>"
<p>I have a website powered by Jetty.</p><p>I'd like to make the site password protected (or similar).</p><p>Is there a way to do this by configuration alone (without touching the code).</p><p>All help much appreciated.</p><p>Dan</p>
<p>How do you generate a secure random (or pseudo-random) alphanumeric string in Java efficiently?</p>
"<p>I need to connect to an LDAP directory over SSL.</p><p>In non-production environments, we use self-signed certificates which, of course, fails to validate with:</p><pre><code>javax.naming.CommunicationException: simple bind failed: ldapserver:636 [Root exception is javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target] at com.sun.jndi.ldap.LdapClient.authenticate(LdapClient.java:197) at com.sun.jndi.ldap.LdapCtx.connect(LdapCtx.java:2694) at com.sun.jndi.ldap.LdapCtx.&lt;init&gt;(LdapCtx.java:293) at com.sun.jndi.ldap.LdapCtxFactory.getUsingURL(LdapCtxFactory.java:175) at com.sun.jndi.ldap.LdapCtxFactory.getUsingURLs(LdapCtxFactory.java:193) at com.sun.jndi.ldap.LdapCtxFactory.getLdapCtxInstance(LdapCtxFactory.java:136) at com.sun.jndi.ldap.LdapCtxFactory.getInitialContext(LdapCtxFactory.java:66) at javax.naming.spi.NamingManager.getInitialContext(NamingManager.java:667) at javax.naming.InitialContext.getDefaultInitCtx(InitialContext.java:288) at javax.naming.InitialContext.init(InitialContext.java:223) at javax.naming.ldap.InitialLdapContext.&lt;init&gt;(InitialLdapContext.java:134)</code></pre><p>I am aware of how to use a <a href=""https://stackoverflow.com/questions/859111/how-do-i-accept-a-self-signed-certificate-with-a-java-httpsurlconnection"">custom trust manager for SSL-enabled connections</a>, but don't know how to use one in connection with the JNDI API where I don't manage the actual connection. That is, where is the following standard setup will I be able to plug the trust manager?</p><p>Thanks in advance.</p><pre><code>Hashtable env = new Hashtable();env.put(Context.INITIAL_CONTEXT_FACTORY, ""com.sun.jndi.ldap.LdapCtxFactory"");env.put(Context.PROVIDER_URL, ""ldaps://ldapserver:636"");env.put(Context.SECURITY_PROTOCOL, ""ssl"");env.put(Context.SECURITY_AUTHENTICATION, ""simple"");env.put(Context.SECURITY_PRINCIPAL, ""myUser"");env.put(Context.SECURITY_CREDENTIALS, ""myPassword"");LdapContext ctx = new InitialLdapContext(env, null);ctx.search (...)</code></pre>"
"<p>I'm looking at the <code>JSSE</code> reference guide, I need to obtain an instance of <code>SSLContext</code> in order to create a <code>SSLEngine</code>, so I can use it with <code>Netty</code> to enable security.</p><p>To obtain an instance of <code>SSLContext</code>, I use <code>SSLContext.getInstance()</code>. I see that the method is overridden multiple times, so I can chose the protocol and security provider to use.</p><p><a href=""http://docs.oracle.com/javase/6/docs/technotes/guides/security/StandardNames.html#SSLContext"">Here</a>, I can see the list of algorithms that can be used. Which algorithm should I use to enable secure communication?</p><p>Also, since it is possible to specify the security provider to use, which provider should I use?</p><p>Thanks</p>"
"<p>I have an enterprise java application that has plenty of jars that are downloaded to the client's jvm cache by a jnlp file. When I start the application I get the following stack trace on Java Console:</p><pre><code>        Exception in thread ""AWT-EventQueue-1"" java.lang.NullPointerExceptionat com.sun.deploy.ui.DialogTemplate.imageAvailable(Unknown Source)at com.sun.deploy.ui.DialogTemplate.finalImageAvailable(Unknown Source)at com.sun.deploy.ui.ImageLoader$2.run(Unknown Source)at java.awt.event.InvocationEvent.dispatch(Unknown Source)at java.awt.EventQueue.dispatchEventImpl(Unknown Source)at java.awt.EventQueue.access$200(Unknown Source)at java.awt.EventQueue$3.run(Unknown Source)at java.awt.EventQueue$3.run(Unknown Source)at java.security.AccessController.doPrivileged(Native Method)at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)at java.awt.EventQueue.dispatchEvent(Unknown Source)at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)at java.awt.EventDispatchThread.pumpEvents(Unknown Source)at java.awt.EventDispatchThread.pumpEvents(Unknown Source)at java.awt.EventDispatchThread.run(Unknown Source)       Exception in thread ""AWT-EventQueue-1"" java.lang.NullPointerExceptionat com.sun.deploy.ui.DialogTemplate.imageAvailable(Unknown Source)at com.sun.deploy.ui.DialogTemplate.finalImageAvailable(Unknown Source)at com.sun.deploy.ui.ImageLoader$2.run(Unknown Source)at java.awt.event.InvocationEvent.dispatch(Unknown Source)at java.awt.EventQueue.dispatchEventImpl(Unknown Source)at java.awt.EventQueue.access$200(Unknown Source)at java.awt.EventQueue$3.run(Unknown Source)at java.awt.EventQueue$3.run(Unknown Source)at java.security.AccessController.doPrivileged(Native Method)at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)at java.awt.EventQueue.dispatchEvent(Unknown Source)at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)at java.awt.EventDispatchThread.pumpEvents(Unknown Source)at java.awt.EventDispatchThread.pumpEvents(Unknown Source)at java.awt.EventDispatchThread.run(Unknown Source)    #### Java Web Start Error:    #### The Java security settings have prevented this application from running. You may change this behavior in the Java Control Panel.</code></pre><p>My JNLP File is like the following with some censored descriptions:</p><pre><code>&lt;?xml version=""1.0"" encoding=""utf-8""?&gt;&lt;jnlp spec=""1.0+"" codebase=""http://10.100.10.9/ikarusdelhitest/"" href=""ikarus.jnlp""&gt;&lt;information&gt;    &lt;title&gt;ikarus&lt;/title&gt;    &lt;vendor&gt;my company&lt;/vendor&gt;    &lt;homepage href=""http://www.mycompanyaddress.com"" /&gt;    &lt;description&gt;My enterprise java ee swing application&lt;/description&gt;    &lt;icon href=""ikarus.jpg"" /&gt;    &lt;offline-allowed /&gt;&lt;/information&gt;&lt;security&gt;    &lt;all-permissions /&gt;&lt;/security&gt; &lt;resources&gt;     &lt;jar href=""jars/ikarus/ikarusClient.jar"" /&gt;    &lt;jar href=""jars/ikarus/ikarusDelegators.jar"" /&gt;    &lt;jar href=""jars/ikarus/clientRules.jar"" /&gt;    &lt;jar href=""jars/ikarus/ruleImps.jar"" /&gt;    &lt;jar href=""jars/ikarus/ikarusUtil.jar"" /&gt;    &lt;jar href=""jars/ikarus/ikarusResources.jar"" /&gt;    &lt;jar href=""jars/ikarus/domain.jar"" /&gt;    &lt;jar href=""jars/ikarus/domain_repository.jar"" /&gt;    &lt;jar href=""jars/ikarus/domain_service.jar"" /&gt;    &lt;jar href=""jars/ikarus/app_repository.jar"" /&gt;    &lt;jar href=""jars/ikarus/app_service.jar"" /&gt;    &lt;jar href=""jars/ikarus/infrastructure.jar"" /&gt;    &lt;jar href=""jars/ikarus/integration_domain.jar"" /&gt;    &lt;jar href=""jars/jboss_ejb_auth/ejb3-persistence.jar"" /&gt;    &lt;jar href=""jars/jboss_ejb_auth/jboss-ejb3x.jar"" /&gt;    &lt;jar href=""jars/jboss_ejb_auth/jbossall-client.jar"" /&gt;    &lt;jar href=""jars/jasper/commons-beanutils-1.8.0.jar"" /&gt;    &lt;jar href=""jars/jasper/commons-collections-3.2.1.jar"" /&gt;    &lt;jar href=""jars/jasper/commons-digester-1.7.jar"" /&gt;    &lt;jar href=""jars/jasper/commons-logging-1.1.jar"" /&gt;    &lt;jar href=""jars/jasper/iText-2.1.0.jar"" /&gt;    &lt;jar href=""jars/jasper/jasperreports-3.6.0.jar"" /&gt;    &lt;jar href=""jars/jasper/poi-3.2-FINAL-20081019.jar"" /&gt;    &lt;property name=""jnlp.localization"" value=""Delhi""/&gt;&lt;/resources&gt;&lt;application-desc main-class=""com.celebi.ikarus.main.Ikarus"" /&gt;</code></pre><p></p><p>ALso note that I get some different exception details on the more information panel:</p><pre><code>com.sun.deploy.security.BlockedException: The Java security settings have prevented this application from running. You may change this behavior in the Java Control Panel.at com.sun.deploy.security.SandboxSecurity.showBlockedDialog(Unknown Source)at com.sun.javaws.security.AppPolicy.grantUnrestrictedAccess(Unknown Source)at com.sun.javaws.security.AppPolicy.addPermissions(Unknown Source)at com.sun.jnlp.JNLPClassLoader.getTrustedCodeSources(Unknown Source)at com.sun.deploy.security.CPCallbackHandler$ParentCallback.strategy(Unknown Source)at com.sun.deploy.security.CPCallbackHandler$ParentCallback.openClassPathElement(Unknown Source)at com.sun.deploy.security.DeployURLClassPath$JarLoader.getJarFile(Unknown Source)at com.sun.deploy.security.DeployURLClassPath$JarLoader.access$1000(Unknown Source)at com.sun.deploy.security.DeployURLClassPath$JarLoader$1.run(Unknown Source)at java.security.AccessController.doPrivileged(Native Method)at com.sun.deploy.security.DeployURLClassPath$JarLoader.ensureOpen(Unknown Source)at com.sun.deploy.security.DeployURLClassPath$JarLoader.&lt;init&gt;(Unknown Source)at com.sun.deploy.security.DeployURLClassPath$3.run(Unknown Source)at java.security.AccessController.doPrivileged(Native Method)at com.sun.deploy.security.DeployURLClassPath.getLoader(Unknown Source)at com.sun.deploy.security.DeployURLClassPath.getLoader(Unknown Source)at com.sun.deploy.security.DeployURLClassPath.getResource(Unknown Source)at java.net.URLClassLoader$1.run(Unknown Source)at java.net.URLClassLoader$1.run(Unknown Source)at java.security.AccessController.doPrivileged(Native Method)at java.net.URLClassLoader.findClass(Unknown Source)at com.sun.jnlp.JNLPClassLoader.findClass(Unknown Source)at java.lang.ClassLoader.loadClass(Unknown Source)at java.lang.ClassLoader.loadClass(Unknown Source)at java.lang.ClassLoader.defineClass1(Native Method)at java.lang.ClassLoader.defineClass(Unknown Source)at java.security.SecureClassLoader.defineClass(Unknown Source)at java.net.URLClassLoader.defineClass(Unknown Source)at java.net.URLClassLoader.access$100(Unknown Source)at java.net.URLClassLoader$1.run(Unknown Source)at java.net.URLClassLoader$1.run(Unknown Source)at java.security.AccessController.doPrivileged(Native Method)at java.net.URLClassLoader.findClass(Unknown Source)at com.sun.jnlp.JNLPClassLoader.findClass(Unknown Source)at java.lang.ClassLoader.loadClass(Unknown Source)at java.lang.ClassLoader.loadClass(Unknown Source)at java.lang.ClassLoader.loadClass(Unknown Source)at com.sun.javaws.Launcher.doLaunchApp(Unknown Source)at com.sun.javaws.Launcher.run(Unknown Source)at java.lang.Thread.run(Unknown Source)Caused by: java.lang.SecurityException: Invalid Permissions value: all-permissions  at com.sun.deploy.security.DeployManifestChecker.verify(Unknown Source)at com.sun.deploy.security.DeployManifestChecker.verify(Unknown Source)... 39 more</code></pre><p>I dont have any security restrictions for security on java control panel. It is at the medium level as follows: <img src=""https://i.stack.imgur.com/GgItP.jpg"" alt=""here""></p><p>Thanks for any help</p><p><strong>New Edit: I got more explanatory stacktrace when I tried to run this jnlp from a jvm 1.6 machine as follows:</strong></p><pre><code>java.lang.NoClassDefFoundError: javax/ejb/EJBAccessExceptionat java.lang.Class.getDeclaredMethods0(Native Method)at java.lang.Class.privateGetDeclaredMethods(Unknown Source)at java.lang.Class.getMethod0(Unknown Source)at java.lang.Class.getMethod(Unknown Source)at com.sun.javaws.Launcher.executeApplication(Unknown Source)at com.sun.javaws.Launcher.executeMainClass(Unknown Source)at com.sun.javaws.Launcher.doLaunchApp(Unknown Source)at com.sun.javaws.Launcher.run(Unknown Source)at java.lang.Thread.run(Unknown Source)Caused by: java.lang.ClassNotFoundException: javax.ejb.EJBAccessExceptionat java.net.URLClassLoader$1.run(Unknown Source)at java.security.AccessController.doPrivileged(Native Method)at java.net.URLClassLoader.findClass(Unknown Source)at com.sun.jnlp.JNLPClassLoader.findClass(Unknown Source)at java.lang.ClassLoader.loadClass(Unknown Source)at java.lang.ClassLoader.loadClass(Unknown Source)</code></pre>"
"<p>Hi  I am working on XSS(cross site scripting) issue. my application develop on oracle weblogic portal.  we use Servlet 2.5 version.</p><p>I have added below 3 lines of code in the filter for setting httponly and secure cookies.and it is working fine.</p><pre><code>String sessionid = req.getSession().getId();res.setHeader(""Set-Cookie"", ""JSESSIONID="" +  sessionid + "";HttpOnly"");res.setHeader(""SET-COOKIE"", ""JSESSIONID="" + sessionid + ""; secure"");</code></pre><p>The issue is when I logout and login immediately in the same browser I am able to login but after that on the jsp pages I am getting session timeout issue.  we use weblogic related apis.  request.getuserprinical() api is returning null..  guess it is setting to null.</p><p>any idea please share.</p><p>if there are any other ways to set httponly or secure flag please help.</p>"
"<p>I need to use HDFS cluster from remote desktop through Java API. Everything works OK until it comes to write access. If I'm trying to create any file I receive access permission exception. Path looks good but exception indicates my remote desktop user name which is of course is not what I need to access needed HDFS directory.</p><p>The question is:- Is there any way to represent different user name using 'simple' authentication in Java API?- Could you please point some good explanation of authentication / authorization schemes in hadoop / HDFS preferable with Java API examples?</p><p>Yes, I already know 'whoami' could be overloaded in this case using shell alias but I prefer to avoid solutions like this. Also specifics here is I dislike usage of some tricks like pipes through SSH and scripts. I'd like to perform everything using just Java API.Thank you in advance.</p>"
"<p>So here is the problem. When a user logs out of my website, they can still hit the back button and continue using the site. To keep track of whether the user is logged in or not, I created a session attribute ""isActive"". The attribute is set to true when the user logs in, and is (redundantly) removed right before the session is invalidated at logout. Also on every page I check if the attribute is present.</p><p>I also specify that pages should not be cached in their head tags.</p><p>Despite this users are still able to hit back on the browser, and continue to use the site as if they never logged off.</p><p>Any idea on how to fix this?</p><p>Here is the code:</p><p><strong>Login Servlet:</strong></p><pre><code>...session.setAttribute(""isActive"", true);//Redirect to home page.</code></pre><p><strong>Check Logged In JSP:</strong></p><pre><code>&lt;c:if test='${empty sessionScope.isActive || sessionScope.isActive != true}'&gt;     &lt;c:redirect url=""/index.jsp?message=Session Timed Out.""/&gt;&lt;/c:if&gt;</code></pre><p><strong>Logout Servlet:</strong></p><pre><code>request.getSession().removeAttribute(""isActive"");request.getSession().invalidate();response.sendRedirect(""index.jsp"");</code></pre><p><strong>Inside Head Tag:</strong></p><pre><code>&lt;meta http-equiv=""Pragma"" content=""no-cache""&gt;&lt;meta http-equiv=""Cache-Control"" content=""no-cache""&gt;&lt;meta http-equiv=""Expires"" content=""Sat, 01 Dec 2001 00:00:00 GMT""&gt;</code></pre><p>Thanks</p>"
"<p>I can't believe I'm the only person to run up against this problem.  I've been googling for hours and have not had any luck. The Java security documentation doesn't seem to address PKCS12 certificates thoroughly.</p><p>I am trying to setup Java for user specific PKCS12 certificates.  Among other things, this will be used so that, in Eclipse, I can access a Trac server that is authenticated via certificates.  I am using the Trac Mylyn integration plugin for eclipse.</p><p>Here is the setup:</p><ul><li>user home directories are at /home</li><li>multiuser mount at /central</li><li>each user has a personal certificate at: ~/user.p12</li><li>password for personal certificates is: pass1234</li><li>the users password is stored in a 0400 file at ~/password.txt</li><li>a read-only trust store for the ca is at: /central/ca.jks</li><li>no password for the truststore</li><li>JDK 1.6 installed at /central/jdk_1.6.0</li><li>Eclipse 3.4 installed at /central/eclipse_3.4.0</li><li>JAVA_HOME=/central/jdk_1.6.0</li><li>JAVA_HOME is set to the JDK location because Eclipse needs this</li><li>ECLIPSE_HOME=/central/eclipse_3.4.0</li><li>JRE lives at $JAVA_HOME/jre</li><li>each user has a ~/.java.policy file</li><li>there is a trac server running at <a href=""https://trac.internal/trac"" rel=""noreferrer"">https://trac.internal/trac</a></li><li>the trac server authenticates using certificates</li></ul><p>Now, I want to be able to have each user simply modify some file that they own (like the ~/.java.policy file, for example), and be able to launch the central Eclipse application and access the Trac repository.  Seems simple enough.</p><p>Right now, the only way I can get this to work is to edit the $ECLIPSE_HOME/eclipse.ini file and add </p><pre><code>-Djavax.net.ssl.keyStore=""/home/user/user.p12""-Djavax.net.ssl.keyStoreType=""PKCS12""-Djavax.net.ssl.keyStorePassword=""pass1234""-Djavax.net.ssl.trustStore=""/central/ca.jks""</code></pre><p>Ok, that works, but there are two problems with it:</p><ul><li>Each user has to have their own ecipse install. (or can eclipse read that from a user file?)</li><li>It is Eclipse specific, I'd ultimately like to have this as a Java configuration.</li></ul><p>Also, I remember from some time back that you can edit the $JAVA_HOME/jre/lib/security/java.security file and add</p><pre><code>keystore=/home/user/user.p12keystore.type=PKCS12keystore.password=pass1234truststore=/central/ca.jks</code></pre><p>But Eclipse doesn't seem to pick that up.  Could it be because my JAVA_HOME points to a JDK, and not the JDK's nested JRE?</p><p>I've seen the <a href=""http://download.java.net/jdk7/docs/technotes/guides/security/p11guide.html"" rel=""noreferrer"">Java PKCS#11 Reference</a> that references the following properties:keyStoreURL=""NONE"" keyStoreType=""PKCS11"" keyStorePasswordURL=some_pin_url </p><p>There was another reference I saw that said you could edit the ~/.java.policy file to include:</p><pre><code>keyStore ""file:///home/user/user.p12"", ""PKCS12"", ""SunJSSE"";keyStorePasswordUrl ""file:///home/user/password.txt"";</code></pre><p>But that doesn't get picked up either.  Maybe it actually does work and its not getting read for the same reason the java.security file doesn't work, or maybe it just doesn't work at all.</p><p>Some system properties I've seen:</p><pre><code>javax.net.ssl.keyStore=""/home/user/user.p12""javax.net.ssl.keyStoreType=""PKCS12""javax.net.ssl.keyStorePassword=""password""javax.net.ssl.keyStoreProvider=""SunJSSE""javax.net.ssl.trustStore=""/home/user/ca.jks""javax.net.ssl.trustStoreType=""JKS""javax.net.ssl.trustStorePassword=""""javax.net.ssl.trustStoreProvider=""Sun""</code></pre><p>So, right now, I guess I'm stuck with having each user to have their own Eclipse intall.  I know it sounds like a complicated setup, but this shouldn't really have anything to do with Eclipse as far as the certificate setup... its really a Java setup for user specific certificates.</p><p>Any ideas?</p>"
<p>For my School project I had to show that I can utilize file handling within a program. For this I made a very simple login process that you can create an account on that writes a username and password to a text file located in the resource folder. Obviously this has no security at all as it wasn't designed to be secure just to showcase file handling however my teacher has said that I should attempt to add some encryption to the file as well to get a better grade.</p><p>I have done some research and many people are recommending DES.</p><p>The problem I'm having is I don't have much time left for my project and need to finish it asap. Using DES seems like it would take a while to implement all the extra code. </p><p>In my program I am using a simple lineNumberReader to read the files line by line. To write to the files I am using a BufferedWriter. </p><p>Is there anyway to encrypt this data very simply? It doesn't have to be very secure but I need to show that I have atleast attempted to encrypt the data. The encryption and decryption would all be completed on the same application as data isn't being transferred. </p><p>Potentially a way I can create a very simple encryption and decryption algorithm myself?</p>
"<p>I'm creating a web application using spring mvc. I have started to incorporate the Spring Security libraries. I'm now getting the following error in the tomcat log when I try to deploy it to tomcat with eclipse.</p><p>I'm using the following jar versions in my library</p><ul><li>spring framework version 3.1.1.RELEASE </li><li>spring framework security version 3.1.0.RELEASE</li></ul><p>I'm also using STS version of eclipse, maven and  vmware vfabric tc Server (bundled with sts).</p><p>Here's the tomcat log</p><pre><code>    SEVERE: Exception starting filter springSecurityFilterChainjava.lang.NoClassDefFoundError: org/springframework/context/EnvironmentAwareat java.lang.ClassLoader.defineClass1(Native Method)at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)at java.lang.ClassLoader.defineClass(ClassLoader.java:615)at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:2820)at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:1150)at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1645)at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1523)at java.lang.ClassLoader.defineClass1(Native Method)at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)at java.lang.ClassLoader.defineClass(ClassLoader.java:615)at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:2820)at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:1150)at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1645)at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1523)at org.apache.catalina.core.DefaultInstanceManager.loadClass(DefaultInstanceManager.java:415)at org.apache.catalina.core.DefaultInstanceManager.loadClassMaybePrivileged(DefaultInstanceManager.java:397)at org.apache.catalina.core.DefaultInstanceManager.newInstance(DefaultInstanceManager.java:118)at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:252)at org.apache.catalina.core.ApplicationFilterConfig.setFilterDef(ApplicationFilterConfig.java:372)at org.apache.catalina.core.ApplicationFilterConfig.&lt;init&gt;(ApplicationFilterConfig.java:98)at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4584)at org.apache.catalina.core.StandardContext$2.call(StandardContext.java:5262)at org.apache.catalina.core.StandardContext$2.call(StandardContext.java:5257)at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)at java.util.concurrent.FutureTask.run(FutureTask.java:138)at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)at java.lang.Thread.run(Thread.java:680)Caused by: java.lang.ClassNotFoundException: org.springframework.context.EnvironmentAwareat org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1678)at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1523)... 30 more</code></pre><p>and here's my web.xml file</p><pre><code>&lt;?xml version=""1.0"" encoding=""UTF-8""?&gt;&lt;web-app xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""xmlns=""http://java.sun.com/xml/ns/javaee""xmlns:web=""http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd""xsi:schemaLocation=""http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd""id=""WebApp_ID"" version=""2.5""&gt;&lt;!--    Display Name is used vides a short name for the application,     which will be displayed in the Tomcat Manager application.    When used in &lt;security-constraint&gt;, this tag provides a name     for the security constraint.  --&gt;&lt;display-name&gt;ImaginateFramework&lt;/display-name&gt;&lt;welcome-file-list&gt;    &lt;welcome-file&gt;index.jsp&lt;/welcome-file&gt;&lt;/welcome-file-list&gt;&lt;servlet&gt;    &lt;servlet-name&gt;spring&lt;/servlet-name&gt;    &lt;servlet-class&gt;        org.springframework.web.servlet.DispatcherServlet    &lt;/servlet-class&gt;    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;&lt;/servlet&gt;&lt;servlet-mapping&gt;    &lt;servlet-name&gt;spring&lt;/servlet-name&gt;    &lt;url-pattern&gt;/&lt;/url-pattern&gt;&lt;/servlet-mapping&gt;&lt;servlet-mapping&gt;    &lt;servlet-name&gt;spring&lt;/servlet-name&gt;    &lt;url-pattern&gt;*.html|*.htm|*.xhtm|*.jsp|*.jsf|*.php|*.pl|*.cf&lt;/url-pattern&gt;&lt;/servlet-mapping&gt;&lt;!-- Security Config --&gt;&lt;filter&gt;    &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;    &lt;filter-class&gt;org.springframework.web.filter.DelegatingFilterProxy&lt;/filter-class&gt;&lt;/filter&gt;&lt;filter-mapping&gt;    &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;&lt;/filter-mapping&gt;</code></pre><p></p><p>and here's my spring-servlet.xml file</p><pre class=""lang-xml prettyprint-override""><code>&lt;?xml  version=""1.0"" encoding=""UTF-8""?&gt;&lt;beans xmlns=""http://www.springframework.org/schema/beans""xmlns:security=""http://www.springframework.org/schema/security""xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xmlns:aop=""http://www.springframework.org/schema/aop""xmlns:context=""http://www.springframework.org/schema/context""xmlns:jee=""http://www.springframework.org/schema/jee"" xmlns:lang=""http://www.springframework.org/schema/lang""xmlns:p=""http://www.springframework.org/schema/p"" xmlns:tx=""http://www.springframework.org/schema/tx""xmlns:util=""http://www.springframework.org/schema/util"" xmlns:mvc=""http://www.springframework.org/schema/mvc""xsi:schemaLocation=""http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd    http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd    http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee.xsd    http://www.springframework.org/schema/lang http://www.springframework.org/schema/lang/spring-lang.xsd    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd    http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd    http://www.springframework.org/schema/mvc    http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd    http://www.springframework.org/schema/security    http://www.springframework.org/schema/security/spring-security-3.1.xsd""&gt;&lt;security:ldap-server /&gt;&lt;security:http auto-config='true'&gt;    &lt;security:intercept-url pattern=""/**"" access=""ROLE_USER"" /&gt;&lt;/security:http&gt;&lt;security:authentication-manager&gt;    &lt;security:authentication-provider&gt;        &lt;security:user-service&gt;            &lt;security:user name=""admin"" password=""password""                authorities=""ROLE_USER, ROLE_ADMIN"" /&gt;            &lt;security:user name=""bob"" password=""bob"" authorities=""ROLE_USER"" /&gt;        &lt;/security:user-service&gt;    &lt;/security:authentication-provider&gt;&lt;/security:authentication-manager&gt;&lt;context:annotation-config /&gt;&lt;context:component-scan base-package=""com.imaginatelabs.imaginate_framework.mvc"" /&gt;&lt;mvc:annotation-driven /&gt;&lt;mvc:resources location=""/images/"" mapping=""/images/**"" /&gt;&lt;mvc:resources location=""/scripts/"" mapping=""/scripts/**"" /&gt;&lt;mvc:resources location=""/themes/"" mapping=""/themes/**"" /&gt;&lt;mvc:interceptors&gt;    &lt;bean id=""localeChangeInterceptor""        class=""org.springframework.web.servlet.i18n.LocaleChangeInterceptor""&gt;        &lt;property name=""paramName"" value=""lang"" /&gt;    &lt;/bean&gt;    &lt;bean id=""themeChangeInterceptor""        class=""org.springframework.web.servlet.theme.ThemeChangeInterceptor""&gt;        &lt;property name=""paramName"" value=""theme"" /&gt;    &lt;/bean&gt;&lt;/mvc:interceptors&gt;&lt;bean id=""jspViewResolver""    class=""org.springframework.web.servlet.view.InternalResourceViewResolver""&gt;    &lt;property name=""viewClass""        value=""org.springframework.web.servlet.view.JstlView"" /&gt;    &lt;property name=""prefix"" value=""/WEB-INF/jsp/"" /&gt;    &lt;property name=""suffix"" value="".jsp"" /&gt;    &lt;property name=""order"" value=""1"" /&gt;&lt;/bean&gt;&lt;bean id=""propertyConfigurer""    class=""org.springframework.beans.factory.config.PropertyPlaceholderConfigurer""    p:location=""/WEB-INF/jdbc.properties"" /&gt;&lt;bean id=""dataSource"" class=""org.apache.commons.dbcp.BasicDataSource""    destroy-method=""close"" p:driverClassName=""${jdbc.driverClassName}""    p:url=""${jdbc.databaseurl}"" p:username=""${jdbc.username}"" p:password=""${jdbc.password}"" /&gt;&lt;!-- Hibernate Components --&gt;&lt;bean id=""sessionFactory""    class=""org.springframework.orm.hibernate3.LocalSessionFactoryBean""&gt;    &lt;property name=""dataSource"" ref=""dataSource"" /&gt;    &lt;property name=""configLocation""&gt;        &lt;value&gt;classpath:hibernate.cfg.xml&lt;/value&gt;    &lt;/property&gt;    &lt;property name=""configurationClass""&gt;        &lt;value&gt;org.hibernate.cfg.AnnotationConfiguration&lt;/value&gt;    &lt;/property&gt;    &lt;property name=""hibernateProperties""&gt;        &lt;props&gt;            &lt;prop key=""hibernate.dialect""&gt;${jdbc.dialect}&lt;/prop&gt;            &lt;prop key=""hibernate.show_sql""&gt;true&lt;/prop&gt;        &lt;/props&gt;    &lt;/property&gt;&lt;/bean&gt;&lt;tx:annotation-driven /&gt;&lt;bean id=""transactionManager""    class=""org.springframework.orm.hibernate3.HibernateTransactionManager""&gt;    &lt;property name=""sessionFactory"" ref=""sessionFactory"" /&gt;&lt;/bean&gt;&lt;!-- Tiles Components --&gt;&lt;bean id=""tilesViewResolver""    class=""org.springframework.web.servlet.view.UrlBasedViewResolver""&gt;    &lt;property name=""viewClass""        value=""org.springframework.web.servlet.view.tiles2.TilesView"" /&gt;    &lt;property name=""order"" value=""0"" /&gt;&lt;/bean&gt;&lt;bean id=""tilesConfigurer""    class=""org.springframework.web.servlet.view.tiles2.TilesConfigurer""&gt;    &lt;property name=""definitions""&gt;        &lt;list&gt;            &lt;value&gt;/WEB-INF/tiles.xml&lt;/value&gt;        &lt;/list&gt;    &lt;/property&gt;&lt;/bean&gt;&lt;!-- Language Components --&gt;&lt;bean id=""messageSource""    class=""org.springframework.context.support.ReloadableResourceBundleMessageSource""&gt;    &lt;property name=""basename"" value=""classpath:messages"" /&gt;    &lt;property name=""defaultEncoding"" value=""UTF-8"" /&gt;&lt;/bean&gt;&lt;bean id=""localeResolver""    class=""org.springframework.web.servlet.i18n.CookieLocaleResolver""&gt;    &lt;property name=""defaultLocale"" value=""en"" /&gt;&lt;/bean&gt;&lt;!-- Theme Components --&gt;&lt;bean id=""themeSource""    class=""org.springframework.ui.context.support.ResourceBundleThemeSource""&gt;    &lt;property name=""basenamePrefix"" value=""theme-"" /&gt;    &lt;!-- Can I configure this to look in a directory on the server? --&gt;&lt;/bean&gt;&lt;bean id=""themeResolver""    class=""org.springframework.web.servlet.theme.CookieThemeResolver""&gt;    &lt;property name=""defaultThemeName"" value=""default"" /&gt;&lt;/bean&gt;</code></pre><p></p><p>(edit)pom.xml</p><pre><code>&lt;project xmlns=""http://maven.apache.org/POM/4.0.0"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""xsi:schemaLocation=""http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd""&gt;&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;&lt;groupId&gt;myapp&lt;/groupId&gt;&lt;artifactId&gt;MyApp&lt;/artifactId&gt;&lt;packaging&gt;war&lt;/packaging&gt;&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;&lt;name&gt;App&lt;/name&gt;&lt;build&gt;    &lt;plugins&gt;        &lt;plugin&gt;            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;            &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;            &lt;version&gt;2.1.1&lt;/version&gt;        &lt;/plugin&gt;        &lt;plugin&gt;            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;            &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;            &lt;version&gt;2.3.2&lt;/version&gt;            &lt;configuration&gt;                &lt;source&gt;1.6&lt;/source&gt;                &lt;target&gt;1.6&lt;/target&gt;            &lt;/configuration&gt;        &lt;/plugin&gt;    &lt;/plugins&gt;&lt;/build&gt;&lt;properties&gt;    &lt;org.springframework.version&gt;3.1.1.RELEASE&lt;/org.springframework.version&gt;    &lt;org.springframework.security.version&gt;3.1.0.RELEASE&lt;/org.springframework.security.version&gt;    &lt;org.apache.tiles&gt;3.0.0&lt;/org.apache.tiles&gt;    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;&lt;/properties&gt;&lt;dependencies&gt;    &lt;dependency&gt;        &lt;groupId&gt;commons-beanutils&lt;/groupId&gt;        &lt;artifactId&gt;commons-beanutils&lt;/artifactId&gt;        &lt;version&gt;1.8.0&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;commons-digester&lt;/groupId&gt;        &lt;artifactId&gt;commons-digester&lt;/artifactId&gt;        &lt;version&gt;2.0&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;log4j&lt;/groupId&gt;        &lt;artifactId&gt;log4j&lt;/artifactId&gt;        &lt;version&gt;1.2.16&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.slf4j&lt;/groupId&gt;        &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;        &lt;version&gt;1.5.8&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.slf4j&lt;/groupId&gt;        &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;        &lt;version&gt;1.4.2&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.apache.tiles&lt;/groupId&gt;        &lt;artifactId&gt;tiles-api&lt;/artifactId&gt;        &lt;version&gt;${org.apache.tiles}&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.apache.tiles&lt;/groupId&gt;        &lt;artifactId&gt;tiles-core&lt;/artifactId&gt;        &lt;version&gt;${org.apache.tiles}&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.apache.tiles&lt;/groupId&gt;        &lt;artifactId&gt;tiles-jsp&lt;/artifactId&gt;        &lt;version&gt;${org.apache.tiles}&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.apache.tiles&lt;/groupId&gt;        &lt;artifactId&gt;tiles-servlet&lt;/artifactId&gt;        &lt;version&gt;${org.apache.tiles}&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.apache.tiles&lt;/groupId&gt;        &lt;artifactId&gt;tiles-template&lt;/artifactId&gt;        &lt;version&gt;${org.apache.tiles}&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;javax.servlet&lt;/groupId&gt;        &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;        &lt;version&gt;2.5&lt;/version&gt;    &lt;/dependency&gt;    &lt;!--     &lt;dependency&gt;         &lt;groupId&gt;org.springframework.webflow&lt;/groupId&gt;         &lt;artifactId&gt;spring-webflow&lt;/artifactId&gt;         &lt;version&gt;2.3.1.RELEASE&lt;/version&gt;     &lt;/dependency&gt;     --&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;        &lt;artifactId&gt;spring-security-web&lt;/artifactId&gt;        &lt;version&gt;${org.springframework.security.version}&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;        &lt;artifactId&gt;spring-security-config&lt;/artifactId&gt;        &lt;version&gt;${org.springframework.security.version}&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.springframework&lt;/groupId&gt;        &lt;artifactId&gt;spring-beans&lt;/artifactId&gt;        &lt;version&gt;${org.springframework.version}&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.springframework&lt;/groupId&gt;        &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;        &lt;version&gt;${org.springframework.version}&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.springframework&lt;/groupId&gt;        &lt;artifactId&gt;spring-web&lt;/artifactId&gt;        &lt;version&gt;${org.springframework.version}&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.springframework&lt;/groupId&gt;        &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;        &lt;version&gt;${org.springframework.version}&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.springframework&lt;/groupId&gt;        &lt;artifactId&gt;spring-orm&lt;/artifactId&gt;        &lt;version&gt;${org.springframework.version}&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;hibernate&lt;/groupId&gt;        &lt;artifactId&gt;hibernate-entitymanager&lt;/artifactId&gt;        &lt;version&gt;3.4.0.GA&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;taglibs&lt;/groupId&gt;        &lt;artifactId&gt;standard&lt;/artifactId&gt;        &lt;version&gt;1.1.2&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;javax.servlet&lt;/groupId&gt;        &lt;artifactId&gt;jstl&lt;/artifactId&gt;        &lt;version&gt;1.2&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;mysql&lt;/groupId&gt;        &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;        &lt;version&gt;5.1.10&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;commons-dbcp&lt;/groupId&gt;        &lt;artifactId&gt;commons-dbcp&lt;/artifactId&gt;        &lt;version&gt;20030825.184428&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;commons-pool&lt;/groupId&gt;        &lt;artifactId&gt;commons-pool&lt;/artifactId&gt;        &lt;version&gt;20030825.183949&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;        &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;        &lt;version&gt;3.1&lt;/version&gt;    &lt;/dependency&gt;&lt;/dependencies&gt;</code></pre><p></p>"
"<p>In my server (production server), I have a goDaddy ssl certificate. I have both iOS and Android apps connecting with the server, iOS connecting with no problems, android with versions 4.* everything is good, but with devices with 2.3.* I always get a SSLHandshakeException.</p><p>I did exactly like on Android Developers page (<a href=""https://developer.android.com/training/articles/security-ssl.html"" rel=""nofollow noreferrer"">https://developer.android.com/training/articles/security-ssl.html</a>).</p><p>I already saw similar threads here in stackoverflow (<a href=""https://stackoverflow.com/questions/21306336/android-2-3-x-javax-net-ssl-sslhandshakeexception-java-security-cert-certpathva"">here</a>) but none is helping.</p><p>Then I saw <a href=""https://code.google.com/p/android/issues/detail?id=22171"" rel=""nofollow noreferrer"">this</a> thread talking about Extended Key Usage, but when debugging I get the following information:</p><pre><code>[2]: OID: 2.5.29.37, Critical: falseExtended Key Usage: [ ""1.3.6.1.5.5.7.3.1"", ""1.3.6.1.5.5.7.3.2"" ]</code></pre><p>So I guess the certificate is not ""forcing"" Extended Key Usage.</p><p>Also on <a href=""https://stackoverflow.com/questions/9574870/no-peer-certificate-error-in-android-2-3-but-not-in-4"">this</a> thread there are some other possible causes such as date/time being completly wrong, wich are all not existent.</p><p>Taking that into consideration, I now don't know where the problem might be.</p><p>Any suggestions?</p><p><strong>EDIT:</strong>StackTrace below:</p><pre><code>08-04 16:54:30.139: W/System.err(4832): Caused by: java.security.cert.CertificateException: java.security.cert.CertPathValidatorException: Trust anchor for certification path not found.08-04 16:54:30.149: W/System.err(4832):     at org.apache.harmony.xnet.provider.jsse.TrustManagerImpl.checkServerTrusted(TrustManagerImpl.java:161)08-04 16:54:30.149: W/System.err(4832):     at org.apache.harmony.xnet.provider.jsse.OpenSSLSocketImpl.verifyCertificateChain(OpenSSLSocketImpl.java:664)08-04 16:54:30.149: W/System.err(4832):     at org.apache.harmony.xnet.provider.jsse.NativeCrypto.SSL_do_handshake(Native Method)08-04 16:54:30.159: W/System.err(4832):     at org.apache.harmony.xnet.provider.jsse.OpenSSLSocketImpl.startHandshake(OpenSSLSocketImpl.java:474)</code></pre>"
"<p>I got this following error when my website was being audited. I have developed my website using jsp, servlets, java classes.     </p><blockquote>  <p>Missing HttpOnly Attribute in Session Cookie</p></blockquote><p>Security Risks   </p><blockquote>  <p>It is possible to steal or manipulate customer session and cookies, which might be       used to impersonate a legitimate user, allowing the hacker to view or alter user records,       and to perform transactions as that user</p></blockquote><p>Causes:</p><blockquote>  <p>The web application sets session cookies without the HttpOnly  attribute</p></blockquote><p>Remediation Tasks:</p><blockquote>  <p>Add the 'HttpOnly' attribute to all session cookies</p></blockquote><p>I am passing java security token as hidden parameter while clicking on submit button. How can i add this HttpOnly attribute in that token?</p>"
"<p>The question is, <strong>How to solve ""The certificate is not valid and cannot be used to verify the identity of this website"" error?</strong>.</p><p>Here are the details:</p><p>I have a signed applet that has been working fine, until I updated Java to 8u25 (1.8.0_25-b18). Now, the application shows an alert message ""Do you want to continue? The connection to this website is untrusted"". There is a note in this message too, ""<code>The certificate is not valid and cannot be used to verify the identity of this website</code>"".</p><p>The applet is loaded without problems. But when the user tries to use a specific function of that application, the warning message is displayed.</p><p>I've checked the java console when this happens, and this warning message is displayed right after these lines:</p><pre><code>security: Obtain certificate collection in SSL Root CA certificate storesecurity: Invalid certificate from HTTPS servernetwork: Cache entry not found [url: https://sub.domain.net:9876, version: null]</code></pre><p>The application is downloaded from a different domain, say ""<a href=""https://app.domain.net/"" rel=""noreferrer"">https://app.domain.net/</a>....."", so no jars are downloaded from ""<a href=""https://sub.domain.net:9876"" rel=""noreferrer"">https://sub.domain.net:9876</a>"", but the applet connects to ""<a href=""https://sub.domain.net:9876"" rel=""noreferrer"">https://sub.domain.net:9876</a>"" to send/receive data.</p><p>The applet is signed correctly, and so far, it meets all the security requirements according to Java. This issue seems to happen when the application tries to connect internally with an HTTPS url like <code>https://sub.domain.net:9876</code>. That sites' SSL certificate is valid, issued by GoDaddy and has not expired.</p><p>Again, this started to happen after updating my JRE to 8u25. I've tested adding the offending URL to Java security exception list, with no success.</p><p>Here are a few screenshot of this problem:</p><p>This is the warning message displayed:<img src=""https://i.stack.imgur.com/fMdYC.png"" alt=""Warning message""><img src=""https://i.stack.imgur.com/8XdAz.png"" alt=""More information about the warning message""><img src=""https://i.stack.imgur.com/uyH4D.png"" alt=""Certificate basic information 1""><img src=""https://i.stack.imgur.com/UqHKn.png"" alt=""Certificate basic information 2""></p><hr><p><strong>Edit 10/18/2014:</strong></p><p>Question posted in ""Oracle Community"" too, to increase answer options:<a href=""https://community.oracle.com/message/12684985"" rel=""noreferrer"">Question in Oracle Community</a>.</p><hr><p><strong>Edit 10/21/2014:</strong></p><p>I noticed this: When I click the link ""More Information"" displayed in the ""Security Warning"" dialog, the reason displayed says:</p><blockquote>  <p>The application is being downloaded from a site other than the one  specified by the security certificate.</p>    <ul>  <li><p>Downloading from ""sub.domain.net""</p></li>  <li><p>Expecting ""*.DOMAIN.NET""</p></li>  </ul></blockquote><p>This message says the application is BEING DOWNLOADED FROM ""sub.domain.com"", and that is false. The application (applet) is already downloaded, and it is only using that domain in an internal HTTPS request, to get/send business data, not to download additional Jars, JNLPs, etc.</p>"
"<p>There are three hosts that an android app do the authentication and authorization. Final host is the REST API. For the first time using Oauth authentication and authorization process it works without issue. </p><p>But if <strong>user kills the app</strong> after login and accessing the services provided by REST API and then again open the app, this issue arise. <strong>In this time authentication and authorization process is not happening, only the REST API.</strong> It caused to <code>java.security.cert.CertPathValidatorException</code> <strong>but it was working during the first use (login and then use the app).</strong></p><p>Can someone explains the scenario behind this exception and whats wrong with the app. This works if certification exceptions are ignored as bellow according to <a href=""https://stackoverflow.com/a/8694377/2341815"">this SO answer</a>.</p><pre><code>SSLSocketFactory sslSocketFactory = null;        try {            TrustManagerFactory tmf = TrustManagerFactory.getInstance(                    TrustManagerFactory.getDefaultAlgorithm());            // Initialise the TMF as you normally would, for example:            try {                tmf.init((KeyStore)null);            } catch(KeyStoreException e) {                e.printStackTrace();            }            TrustManager[] trustManagers = tmf.getTrustManagers();            final X509TrustManager origTrustmanager = (X509TrustManager)trustManagers[0];            // Create a trust manager that does not validate certificate chains            TrustManager[] wrappedTrustManagers = new TrustManager[]{                    new X509TrustManager() {                        public java.security.cert.X509Certificate[] getAcceptedIssuers() {                            return origTrustmanager.getAcceptedIssuers();                        }                        public void checkClientTrusted(X509Certificate[] certs, String authType) {                            try {                                origTrustmanager.checkClientTrusted(certs, authType);                            } catch(CertificateException e) {                                e.printStackTrace();                            }                        }                        public void checkServerTrusted(X509Certificate[] certs, String authType) {                            try {                                origTrustmanager.checkServerTrusted(certs, authType);                            } catch(CertificateException e) {                                e.printStackTrace();                            }                        }                    }            };            //TrustManager[] trustAllCerts = TrustManagerFactory.getInstance(""SSL"").getTrustManagers();            // Install the all-trusting trust manager            final SSLContext sslContext = SSLContext.getInstance(""TLS"");            sslContext.init(null, wrappedTrustManagers, new java.security.SecureRandom());            // Create an ssl socket factory with our all-trusting manager            sslSocketFactory = sslContext.getSocketFactory();        } catch (NoSuchAlgorithmException | KeyManagementException e) {            e.printStackTrace();        }        return sslSocketFactory;</code></pre><p>I am using Okhttp 3 for the http requests. Any suggestion would help to solve the issue. And please let me know if I use above code snippet, is it a security violation? will it effect to the security of the app?</p>"
<p>I want to make an desktop application that only runs on machines that have key or licence.How this can be achieved?</p>
"<p>How do I create a random password that meets the system's length and character set requirements in Java? </p><p>I have to create a random password that is 10-14 characters long and has at least one uppercase, one lowercase, and one special character. Unfortunately, some special characters are <i>too</i> special and cannot be used, so I cannot use just printed ASCII.</p><p>Many of the examples on this site generate a random password or session key without enough entropy in the characters or without realistic requirements in a business setting like the ones given above, so I'm asking more pointed question to get a better answer.</p><p>My character set, every special character on a standard US keyboard except for a space:    </p><pre><code>A-Za-z0-9~`!@#$%^&amp;*()-_=+[{]}\|;:'"",&lt;.&gt;/?</code></pre>"
"<p>I have a web application that call a SOAP Web service secured via SSL .<code>(https://zzzzzzzzzzzz/xxxxx</code>). </p><p>The server send two certificates (Root and Leaf) so i import the two certificate using the property : <code>com.ibm.websphere.ssl.retrieveLeafCert</code> .</p><p>To enable ssl validation on websphere i just add the certificates Into websphere : </p><p>SSL certificate and key management -> key stores and certificate -> NodeDefaultTrustStore -> Signer cerificates -> Retrieve from port : </p><ul><li>host  : hostname  </li><li>port  : 443</li><li>alias : alias</li></ul><p>The problem is that webshphere not trust the certificate and give me this stacktrace, </p><pre><code>used by: javax.net.ssl.SSLHandshakeException: SSLHandshakeException invoking `https://------------------------------` : com.ibm.jsse2.util.j: PKIX path building failed: java.security.cert.CertPathBuilderException: PKIXCertPathBuilderImpl could not build a valid CertPath.; internal cause is:     java.security.cert.CertPathValidatorException: T`he certificate issued by CN=-------------------------------------------------------------------- is not trusted`; internal cause is:     java.security.cert.CertPathValidatorException: Certificate chaining error    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[na:1.6.0]    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:56) ~[na:1.6.0]    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:39) ~[na:1.6.0]    at java.lang.reflect.Constructor.newInstance(Constructor.java:527) ~[na:1.6.0]    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.mapException(HTTPConduit.java:1338) ~[cxf-rt-transports-http-2.7.4.jar:2.7.4]    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:1322) ~[cxf-rt-transports-http-2.7.4.jar:2.7.4]    at org.apache.cxf.transport.AbstractConduit.close(AbstractConduit.java:56) ~[cxf-api-2.7.4.jar:2.7.4]    at org.apache.cxf.transport.http.HTTPConduit.close(HTTPConduit.java:622) ~[cxf-rt-transports-http-2.7.4.jar:2.7.4]    at org.apache.cxf.interceptor.MessageSenderInterceptor$MessageSenderEndingInterceptor.handleMessage(MessageSenderInterceptor.java:62) ~[cxf-api-2.7.4.jar:2.7.4]    at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:271) ~[cxf-api-2.7.4.jar:2.7.4]    at org.apache.cxf.endpoint.ClientImpl.doInvoke(ClientImpl.java:530) ~[cxf-api-2.7.4.jar:2.7.4]    at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:463) ~[cxf-api-2.7.4.jar:2.7.4]    at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:366) ~[cxf-api-2.7.4.jar:2.7.4]    at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:319) ~[cxf-api-2.7.4.jar:2.7.4]    at org.apache.cxf.endpoint.ClientImpl.invokeWrapped(ClientImpl.java:354) ~[cxf-api-2.7.4.jar:2.7.4]    at org.apache.cxf.jaxws.DispatchImpl.invoke(DispatchImpl.java:385) ~[cxf-rt-frontend-jaxws-2.7.4.jar:2.7.4]    ... 100 common frames omitted`Caused by: javax.net.ssl.SSLHandshakeException`: com.ibm.jsse2.util.j: PKIX path building failed: java.security.cert.CertPathBuilderException: PKIXCertPathBuilderImpl could not build a valid CertPath.; internal cause is:     java.security.cert.CertPathValidatorException: `The certificate issued by CN=--------------------------------------------------------- is not trusted`; internal cause is:     java.security.cert.CertPathValidatorException: Certificate chaining error    at com.ibm.jsse2.o.a(o.java:8) ~[na:6.0 build_20130515]    at com.ibm.jsse2.SSLSocketImpl.a(SSLSocketImpl.java:549) ~[na:6.0 build_20130515]    at com.ibm.jsse2.kb.a(kb.java:355) ~[na:6.0 build_20130515]    at com.ibm.jsse2.kb.a(kb.java:130) ~[na:6.0 build_20130515]    at com.ibm.jsse2.lb.a(lb.java:135) ~[na:6.0 build_20130515]    at com.ibm.jsse2.lb.a(lb.java:368) ~[na:6.0 build_20130515]    at com.ibm.jsse2.kb.s(kb.java:442) ~[na:6.0 build_20130515]    at com.ibm.jsse2.kb.a(kb.java:136) ~[na:6.0 build_20130515]    at com.ibm.jsse2.SSLSocketImpl.a(SSLSocketImpl.java:495) ~[na:6.0 build_20130515]    at com.ibm.jsse2.SSLSocketImpl.h(SSLSocketImpl.java:223) ~[na:6.0 build_20130515]    at com.ibm.jsse2.SSLSocketImpl.a(SSLSocketImpl.java:724) ~[na:6.0 build_20130515]    at com.ibm.jsse2.SSLSocketImpl.startHandshake(SSLSocketImpl.java:81) ~[na:6.0 build_20130515]    at com.ibm.net.ssl.www2.protocol.https.c.afterConnect(c.java:8) ~[na:6.0 build_20130515]    at com.ibm.net.ssl.www2.protocol.https.d.connect(d.java:20) ~[na:6.0 build_20130515]    at sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1043) ~[na:1.6.0]    at com.ibm.net.ssl.www2.protocol.https.b.getOutputStream(b.java:85) ~[na:6.0 build_20130515]    at org.apache.cxf.transport.http.URLConnectionHTTPConduit$URLConnectionWrappedOutputStream.setupWrappedStream(URLConnectionHTTPConduit.java:168) ~[cxf-rt-transports-http-2.7.4.jar:2.7.4]    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.handleHeadersTrustCaching(HTTPConduit.java:1282) ~[cxf-rt-transports-http-2.7.4.jar:2.7.4]    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.onFirstWrite(HTTPConduit.java:1233) ~[cxf-rt-transports-http-2.7.4.jar:2.7.4]    at org.apache.cxf.transport.http.URLConnectionHTTPConduit$URLConnectionWrappedOutputStream.onFirstWrite(URLConnectionHTTPConduit.java:195) ~[cxf-rt-transports-http-2.7.4.jar:2.7.4]    at org.apache.cxf.io.AbstractWrappedOutputStream.write(AbstractWrappedOutputStream.java:47) ~[cxf-api-2.7.4.jar:2.7.4]    at org.apache.cxf.io.AbstractThresholdOutputStream.write(AbstractThresholdOutputStream.java:69) ~[cxf-api-2.7.4.jar:2.7.4]    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:1295) ~[cxf-rt-transports-http-2.7.4.jar:2.7.4]    ... 110 common frames omitted`Caused by: com.ibm.jsse2.util.j: PKIX path building failed:` java.security.cert.CertPathBuilderException: PKIXCertPathBuilderImpl could not build a valid CertPath.; internal cause is:     java.security.cert.CertPathValidatorException: T`he certificate issued by CN=--------------------------------------------  is not trusted`; internal cause is:     java.security.cert.CertPathValidatorException: Certificate chaining error    at com.ibm.jsse2.util.h.b(h.java:39) ~[na:6.0 build_20130515]    at com.ibm.jsse2.util.h.b(h.java:21) ~[na:6.0 build_20130515]    at com.ibm.jsse2.util.g.a(g.java:1) ~[na:6.0 build_20130515]    at com.ibm.jsse2.pc.a(pc.java:36) ~[na:6.0 build_20130515]    at com.ibm.jsse2.pc.checkServerTrusted(pc.java:19) ~[na:6.0 build_20130515]    at com.ibm.jsse2.pc.b(pc.java:51) ~[na:6.0 build_20130515]    at com.ibm.jsse2.lb.a(lb.java:65) ~[na:6.0 build_20130515]    ... 128 common frames omittedCaused by: java.security.cert.CertPathBuilderException: PKIXCertPathBuilderImpl could not build a valid CertPath.    at com.ibm.security.cert.PKIXCertPathBuilderImpl.engineBuild(PKIXCertPathBuilderImpl.java:411) ~[na:na]    at java.security.cert.CertPathBuilder.build(CertPathBuilder.java:258) ~[na:na]    at com.ibm.jsse2.util.h.b(h.java:107) ~[na:6.0 build_20130515]    ... 134 common frames omittedCaused by: java.security.cert.CertPathValidatorException: The certificate issued by CN=-------------------------------------------------------    at com.ibm.security.cert.BasicChecker.&lt;init&gt;(BasicChecker.java:111) ~[na:na]    at com.ibm.security.cert.PKIXCertPathValidatorImpl.engineValidate(PKIXCertPathValidatorImpl.java:178) ~[na:na]    at com.ibm.security.cert.PKIXCertPathBuilderImpl.myValidator(PKIXCertPathBuilderImpl.java:737) ~[na:na]    at com.ibm.security.cert.PKIXCertPathBuilderImpl.buildCertPath(PKIXCertPathBuilderImpl.java:649) ~[na:na]    at com.ibm.security.cert.PKIXCertPathBuilderImpl.buildCertPath(PKIXCertPathBuilderImpl.java:595) ~[na:na]    at com.ibm.security.cert.PKIXCertPathBuilderImpl.engineBuild(PKIXCertPathBuilderImpl.java:357) ~[na:na]    ... 136 common frames omittedCaused by: java.security.cert.CertPathValidatorException: Certificate chaining error    at com.ibm.security.cert.CertPathUtil.findIssuer(CertPathUtil.java:298) ~[na:na]    at com.ibm.security.cert.BasicChecker.&lt;init&gt;(BasicChecker.java:108) ~[na:na]    ... 141 common frames omitted</code></pre><p>The same code is tested in my local environement with the simple use of <a href=""https://code.google.com/p/java-use-examples/source/browse/trunk/src/com/aw/ad/util/InstallCert.java"">Installcert.java</a> and running my tests with -Djavax.net.ssl.trustStore=jssecacerts (jssecacerts is the file generated by InstallCert.java). </p>"
"<p>Hello I'm trying to access the keystore from my smartcard in Java. And I'm using the following code..</p><p>I'm using the Pkcs11 implementation of OpenSc <a href=""http://www.opensc-project.org/opensc"" rel=""noreferrer"">http://www.opensc-project.org/opensc</a></p><p><strong>File windows.cnf</strong> =   </p><pre><code>name=dnielibrary=C:\WINDOWS\system32\opensc-pkcs11.dll</code></pre><p><strong>Java Code</strong> =</p><pre><code>String configName = ""windows.cnf"" String PIN = ""####""; Provider p = new sun.security.pkcs11.SunPKCS11(configName); Security.addProvider(p); KeyStore keyStore = KeyStore.getInstance(""PKCS11"", ""SunPKCS11-dnie"");  =)(=  char[] pin = PIN.toCharArray(); keyStore.load(null, pin);</code></pre><p>When the execution goes by the line with <strong>=)(=</strong>  throws me the following exception </p><pre><code>java.security.KeyStoreException: PKCS11 not found    at java.security.KeyStore.getInstance(KeyStore.java:635)    at ObtenerDatos.LeerDatos(ObtenerDatos.java:52)    at ObtenerDatos.obtenerNombre(ObtenerDatos.java:19)    at main.main(main.java:27)Caused by: java.security.NoSuchAlgorithmException: no such algorithm: PKCS11 for provider SunPKCS11-dnie        at sun.security.jca.GetInstance.getService(GetInstance.java:70)        at sun.security.jca.GetInstance.getInstance(GetInstance.java:190)        at java.security.Security.getImpl(Security.java:662)        at java.security.KeyStore.getInstance(KeyStore.java:632)</code></pre><p>I think the problem is ""SunPKCS11-dnie"", but I don't know to put there. I had tried with a lot of combinations...</p><p>Anyone can help me... </p>"
<p>I need to save a db password as an encrypted string and then decrypt before connecting.</p><p>Can anyone refer me a good two-way encryption library in Java?</p>
"<p>I have a web application in which when users login they reach the <code>mainjsp.jsp</code> page.</p><p>In this page there are few text-box for dates and based on dates and selection from another drop-down, data is submitted. This data is retrieved by a <code>servlet</code> and brought back to the <code>mainjsp</code> page.</p><p>My concern is about security. Now when I copy paste the <code>mainjsp.jsp</code> page's URL and paste it in any browser this page appears as it is. I don't want this to happen. I want the users to login first and hence I want my web application secure.</p><p>I don't have any idea how to do this. Could you please tell me how can I achieve this?</p><p>Also please tell me how do I achieve this for any of the pages in the web-application. Users should not be able to access any page if they haven't logged in.</p>"
"<p>i find out that i must write a policy file to grant permission for my applet...</p><p>but i really confused with it... :(</p><p>i want to write a applet that is a map viewer, i need to save image tiles on client that run my applet to locally access tiles for gain speed and time safely viewing map which is benefit to user...</p><p>so, the applet needs grant permission to read/write and make directory on client tempdir.</p><p>now, i want to write a policy file to gain permission to my applet,i don't want to involve  the users to this,instead of, i want to write policy file by myself to grant permission for applet...</p><p>now where is the policy file location? in applet jar file?how the applet use policy file? </p><p>please help me</p>"
"<p>I am working on project written by <strong>pure jsps(scriptlets)</strong> without using any frameworks.</p><p>jboss version: jboss-as-7.1.0.Final</p><p>I am now trying to add simple authentication on it. So when user try to browser the jsps,  say, <code>http://localhost/myContextPath/hello.jsp</code>, it requires a login first.</p><p><strong>web.xml</strong></p><pre><code>&lt;security-constraint&gt;    &lt;web-resource-collection&gt;        &lt;web-resource-name&gt;All Access&lt;/web-resource-name&gt;        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;        &lt;http-method&gt;DELETE&lt;/http-method&gt;        &lt;http-method&gt;PUT&lt;/http-method&gt;        &lt;http-method&gt;HEAD&lt;/http-method&gt;        &lt;http-method&gt;OPTIONS&lt;/http-method&gt;        &lt;http-method&gt;TRACE&lt;/http-method&gt;        &lt;http-method&gt;GET&lt;/http-method&gt;        &lt;http-method&gt;POST&lt;/http-method&gt;    &lt;/web-resource-collection&gt;    &lt;user-data-constraint&gt;        &lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt;    &lt;/user-data-constraint&gt;&lt;/security-constraint&gt;&lt;login-config&gt;    &lt;auth-method&gt;BASIC&lt;/auth-method&gt;&lt;/login-config&gt;</code></pre><p><strong>jboss-web.xml</strong></p><pre><code>&lt;jboss-web&gt;&lt;security-domain&gt;other&lt;/security-domain&gt;&lt;/jboss-web&gt;</code></pre><p><strong>standalone.xml([jboss_home]\standalone\configuration folder)</strong></p><pre><code>&lt;subsystem xmlns=""urn:jboss:domain:security:1.1""&gt;        &lt;security-domains&gt;            &lt;security-domain name=""other"" cache-type=""default""&gt;                &lt;authentication&gt;                    &lt;login-module code=""UsersRoles"" flag=""required""&gt;                        &lt;module-option name=""usersProperties"" value=""users.properties""/&gt;                        &lt;module-option name=""rolesProperties"" value=""roles.properties""/&gt;                    &lt;/login-module&gt;                &lt;/authentication&gt;            &lt;/security-domain&gt;            &lt;security-domain name=""form-auth""&gt;                &lt;authentication&gt;                    &lt;login-module code=""UsersRoles"" flag=""required""&gt;                        &lt;module-option name=""usersProperties"" value=""users.properties""/&gt;                        &lt;module-option name=""rolesProperties"" value=""roles.properties""/&gt;                    &lt;/login-module&gt;                &lt;/authentication&gt;            &lt;/security-domain&gt;        &lt;/security-domains&gt;    &lt;/subsystem&gt;</code></pre><p><strong>users.properties(putting under webapp classes folder)</strong></p><pre><code>user1=jboss7</code></pre><p><strong>roles.properties(putting under webapp classes folder)</strong></p><pre><code>user1=Admin</code></pre><p>After all these modifications, I try to browser my hello jsp. I works as usual. No authentication and also no exception.</p><p>I am not sure am I going to a right direction, or security constraint is a completely different things.Please help, thanks!!!</p>"
"<p>In my application I am encrypting and decrypting data using secretKey. For that I am using AES algorithm. But I am getting exception in decrypt, one value out of three already encrypted values using secret key. </p><p><strong>Exception is:</strong> </p><pre><code>Illegal Block Size Exception Input length must be multiple of 16 when decrypting with padded cipher.</code></pre><p>Below is my code:</p><p><strong>Function to encyrpt value</strong></p><pre><code>public static String symmetricEncrypt(String text, String secretKey) {    BASE64Decoder decoder = new BASE64Decoder();    byte[] raw;    String encryptedString;    SecretKeySpec skeySpec;    BASE64Encoder bASE64Encoder = new BASE64Encoder();    byte[] encryptText = text.getBytes();    Cipher cipher;    try {        raw = decoder.decodeBuffer(secretKey);        skeySpec = new SecretKeySpec(raw, ""AES"");        cipher = Cipher.getInstance(""AES"");        cipher.init(Cipher.ENCRYPT_MODE, skeySpec);        encryptedString = bASE64Encoder.encode(cipher.doFinal(encryptText));    }     catch (Exception e) {        e.printStackTrace();        return ""Error"";    }    return encryptedString;}</code></pre><p><strong>Function to decrypt value</strong></p><pre><code>public static String symmetricDecrypt(String text, String secretKey) {    BASE64Decoder decoder = new BASE64Decoder();    BASE64Decoder base64Decoder = new BASE64Decoder();    Cipher cipher;    String encryptedString;    byte[] encryptText = null;    byte[] raw;    SecretKeySpec skeySpec;    try {        raw = decoder.decodeBuffer(secretKey);        skeySpec = new SecretKeySpec(raw, ""AES"");        encryptText = base64Decoder.decodeBuffer(text);        cipher = Cipher.getInstance(""AES"");        cipher.init(Cipher.DECRYPT_MODE, skeySpec);        encryptedString = new String(cipher.doFinal(encryptText));    } catch (Exception e) {        e.printStackTrace();        return ""Error"";    }    return encryptedString;}</code></pre><p>Following are the values that I am encrypting and decrypting</p><pre><code>String secretKey = ""XMzDdG4D03CKm2IxIWQw7g=="";String value1= ""ABCD"";String enctypedValue1= ""3uweh4pzoVyH1uODQmVNJA=="";String enctypedValue2= ""37PTC20w4DMZYjG3f+GWepSvAbEJUccMXwS/lXilLav1qM/PrCTdontw5/82OdC1zzyhDEsFVRGo rV6gXAQcm+Zai15hliiUQ8l8KRMtUl4="";String value4= ""20000"";/**  Ecnryption and decryption of value1 **/String encryptedValue1= symmetricEncrypt(value1, secretKey);String decryptedValue1 = symmetricDecrypt(encryptedValue1, secretKey);/**  Decryption of  enctypedValue1 **/String decryptedValue2 = symmetricDecrypt(enctypedValue1, secretKey);System.out.println(decryptedValue2);/**  Decryption of  enctypedValue2 (Not decrypted)**/String decryptedValue3 = symmetricDecrypt(enctypedValue2, secretKey);System.out.println(decryptedValue3);/**  Ecnryption and decryption of value4 **/String encryptedValue4= symmetricEncrypt(value4, secretKey);String decryptedValue4 = symmetricDecrypt(encryptedValue4, secretKey);</code></pre><p>In the test function, I have written the following three test cases.</p><ol><li>A new value (value1) being encrypted and decrypted using a secret key.</li><li>Two example encrypted values (enctypedValue1, enctypedValue2) which are being decrypted using same secret key. encryptedValue2 which got a problem while decrypting using same secret key.</li><li>A new value (value4) being encrypted and decrypted using a secret key.</li></ol><p>On decrypting encryptedValue2 I am getting the following exception:</p><pre><code>Illegal Block Size Exception Input length must be multiple of 16 when decrypting with padded cipher</code></pre><p>Following is what I have derived till now.</p><ol><li><p>The problematic value seems to have a problem while decoding it, it returns 81 length array which is unable to get decrypted?</p></li><li><p>If this problem was to happen it should have happened to all the values.</p></li><li><p>Is this a value specific problem or it is something related to padding or it can have a different behavior on different browser, different os?</p></li></ol>"
"<p>I want to manually bypass the user from spring Security using the following code:</p><pre><code>User localeUser = new User();UsernamePasswordAuthenticationToken auth = new UsernamePasswordAuthenticationToken(localeUser ,null, localeUser .getAuthorities());SecurityContext securityContext = SecurityContextHolder.getContext();        securityContext.setAuthentication(auth);        // Create a new session and add the security context.        HttpSession session = request.getSession(true);        session.setAttribute(""SPRING_SECURITY_CONTEXT"", securityContext);return ""dummyLogin"";</code></pre><p>The dummy login page(handled by tiles)internally calls a different Request Mapping in the same controller where i am trying to get the Authentication something like this.</p><pre><code>SecurityContextHolder.getContext().getAuthentication()</code></pre><p>Where i am getting null!!!.</p><p>Please helpp!</p>"
"<p>I am testing SSL in java with SSLServerSocket and other classes in the java.ssl package. When I run the following code, I get the exception java.io.IOException: Invalid keystore format. My code:</p><pre><code>package testing;import java.io.BufferedReader;import java.io.FileInputStream;import java.io.InputStream;import java.io.InputStreamReader;import java.io.PrintWriter;import java.net.Socket;import java.security.KeyStore;import javax.net.ServerSocketFactory;import javax.net.ssl.KeyManagerFactory;import javax.net.ssl.SSLContext;import javax.net.ssl.SSLServerSocket;import javax.net.ssl.TrustManager;public class SSLServerTest {    public static void main(String[] args) {        try {            int port = 3000;            SSLContext sc = SSLContext.getInstance(""TLSv1.2"");            KeyStore ks = KeyStore.getInstance(""JKS"");            InputStream ksIs = new FileInputStream(""key.txt"");            try {                ks.load(ksIs, ""Bennett556"".toCharArray());            } finally {                if (ksIs != null) {                    ksIs.close();                }            }            KeyManagerFactory kmf = KeyManagerFactory.getInstance(""SunX509"");            kmf.init(ks, ""Bennett556"".toCharArray());            sc.init(kmf.getKeyManagers(), new TrustManager[] {}, null);            ServerSocketFactory ssocketFactory = sc.getServerSocketFactory();            SSLServerSocket ssocket = (SSLServerSocket) ssocketFactory                    .createServerSocket(port);            ssocket.setEnabledProtocols(new String[] { ""SSLv3"" });            Socket socket = ssocket.accept();            BufferedReader in = new BufferedReader(new InputStreamReader(                    socket.getInputStream()));            PrintWriter out = new PrintWriter(socket.getOutputStream());            out.println(""Hello, Securly!"");            out.close();            in.close();            out.close();        } catch (Exception e) {            e.printStackTrace();        }    }}</code></pre><p>File key.txt:1268312345812304612348712634283427346I am guessing I should put something else in the key.txt file, but I do not know what to put in it. Probably a searilized object.</p><p><strong>EDIT: Client Code:</strong></p><pre><code>package testing;import java.io.BufferedReader;import java.io.FileInputStream;import java.io.InputStream;import java.io.InputStreamReader;import java.security.KeyStore;import javax.net.SocketFactory;import javax.net.ssl.KeyManagerFactory;import javax.net.ssl.SSLContext;import javax.net.ssl.SSLSocket;import javax.net.ssl.TrustManager;public class SSLClientTest {    public static void main(String[] args) {        int port = 3000;        String host = ""localhost"";        try {            SSLContext sc = SSLContext.getInstance(""TLSv1.2"");            KeyStore ks = KeyStore.getInstance(""JKS"");            InputStream ksIs = new FileInputStream(""key.txt"");            try {                ks.load(ksIs, ""Bennett556"".toCharArray());            } finally {                if (ksIs != null) {                    ksIs.close();                }            }            KeyManagerFactory kmf = KeyManagerFactory.getInstance(""SunX509"");            kmf.init(ks, ""Bennett556"".toCharArray());            sc.init(kmf.getKeyManagers(), new TrustManager[] {}, null);            SocketFactory factory = sc.getSocketFactory();            SSLSocket socket = (SSLSocket) factory.createSocket(host, port);            socket.startHandshake();            BufferedReader in = new BufferedReader(new InputStreamReader(                    socket.getInputStream()));            String str = """";            while ((str = in.readLine()) != null)                System.out.println(str);            in.close();            socket.close();        } catch (Exception e) {            e.printStackTrace();        }    }}</code></pre>"
"<p>I'm writing a small application for transferring files, more or less as a way to learn more of the programmatic encryption underpinnings.  The idea is to generate an RSA keypair, exchange public keys, and send the AES iv and key over for further decryption.  I want to encrypt the AES key with the receivers RSA public key, like so:</p><pre><code>// encode the SecretKeySpecprivate byte[] EncryptSecretKey (){    Cipher cipher = null;    byte[] key = null;    try    {        cipher = Cipher.getInstance(""RSA/ECB/NOPADDING"");        // contact.getPublicKey returns a public key of type Key        cipher.init(Cipher.ENCRYPT_MODE, contact.getPublicKey() );        // skey is the SecretKey used to encrypt the AES data        key = cipher.doFinal(skey.getEncoded());    }    catch(Exception e )    {        System.out.println ( ""exception encoding key: "" + e.getMessage() );        e.printStackTrace();    }    return key;}</code></pre><p>I then write out the key value to the receiver, and decrypt it like so:</p><pre><code>private SecretKey decryptAESKey(byte[] data ){    SecretKey key = null;    PrivateKey privKey = null;    Cipher cipher = null;    System.out.println ( ""Data as hex: "" + utility.asHex(data) );    System.out.println ( ""data length: "" + data.length );    try    {        // assume this loads our private key        privKey = (PrivateKey)utility.loadLocalKey(""private.key"", false);        cipher = Cipher.getInstance(""RSA/ECB/NOPADDING"");        cipher.init(Cipher.DECRYPT_MODE, privKey );        key = new SecretKeySpec(cipher.doFinal(data), ""AES"");        System.out.println ( ""Key decrypted, length is "" + key.getEncoded().length );        System.out.println ( ""data: "" + utility.asHex(key.getEncoded()));    }    catch(Exception e)    {        System.out.println ( ""exception decrypting the aes key: "" + e.getMessage() );        e.printStackTrace();        return null;    }    return key;}</code></pre><p>In console, on the other side, I get this as output:</p><pre><code>read_bytes for key: 16data length: 16Data as hex: &lt;hex string&gt;Key decrypted, length is 256java.security.InvalidKeyException: Invalid AES key length: 256 bytes</code></pre><p>Furthermore, if I create a byte array of size 16 and put the cipher.doFinal(data) output into it, the array is seemingly resized to 256 bytes (.length says so, at least).  Why would this be, and further, what am I doing incorrectly?</p><p><strong>edit</strong><br>I solved this, and thought I'd post the issue in case someone runs into this.  The problem, it turns out, was the RSA/ECB/NOPADDING.  For some odd reason it was screwing up my creation of the SecretKey when I transferred it over to the client.  It <em>might</em> have something to do with how I'm generating keypairs (i'm using getInstance(""RSA"") for that), but I'm not entirely sure. </p>"
"<p>What's wrong with this?</p><pre><code>for (Object obj : java.security.Security.getAlgorithms(""Cipher"")) {  System.out.println(obj);}javax.crypto.SecretKeyFactory.getInstance(""AES"");</code></pre><p>This is the output (JDK 1.6 on Mac OS 10.6):</p><pre><code>BLOWFISHARCFOURPBEWITHMD5ANDDESRC2RSAPBEWITHMD5ANDTRIPLEDESPBEWITHSHA1ANDDESEDEDESEDEAESWRAPAESDESDESEDEWRAPPBEWITHSHA1ANDRC2_40java.security.NoSuchAlgorithmException: AES SecretKeyFactory not available at javax.crypto.SecretKeyFactory.&lt;init&gt;(DashoA13*..) at javax.crypto.SecretKeyFactory.getInstance(DashoA13*..) ...</code></pre>"
"<p>I have created Java <code>signed applet</code>, it runs perfectly if I set my <strong>Java(JRE 8) security level</strong> <strong><em>high</em></strong> and add my <em>site url</em> in <em>exception site list</em>.</p><p>But if we do not add site url in exception site list, java security exception comes as explained here : <a href=""https://blogs.oracle.com/java-platform-group/entry/upcoming_exception_site_list_in"" rel=""nofollow noreferrer"">add url in exception site list</a></p><p>I have created a signed applet using a third part certificate.</p><p>Here is my manifest file after creating signed applet:</p><p>Is there any option available to <em>avoid these security blocking popups</em> by adding some changes in manifest file while creating signed applet, or any script, java code to avoid these popups without adding site url in exception site list?</p><p>Or is it really <strong>mandatory from Java</strong> that <strong>we must need to add site url in exception site list to avoid such blocking error.</strong></p><p><strong>Basically is there any option available to add our url in exception site list through manifest file or any Java code ?</strong><img src=""https://i.stack.imgur.com/yLJzl.png"" alt=""Blocking popup comes if we don&#39;t set url in exception list ""></p><p>Is it mandatory if I want to sign my applet using signed certificate then it must be a code signing certificate? wildcard or ssl certificate will not work?</p><p>As I am getting self signed applet block issue though I have signed my applet with wildcard certificate.</p>"
"<p>I am trying to access client's temp directory through my applet on my web project.<br>When I run the applet by itself, it gets the <code>tempdir</code> with no problem. </p><p>When I try to get it on my project using javascript and calling the applet method, I am having <code>accessControlException</code> on my javascript console. Also I am getting the same exception when I try to read a file under the temp directory. </p><p>This is what I see exactly:</p><pre><code>java.security.accesscontrolexception access denied (java.util.propertypermission java.io.tmpdir read)java.security.accesscontrolexception access denied (java.io.filepermission read)</code></pre><p>How to solve <code>java.security.AccessControlException</code>?</p>"
"<p>What are the main reasons that cause the exception reported?</p><p>Same trusted signed applet (Digicert certificate), works great on some PCs, doesn't work on other. Exception occurs when i try to get an attachment stream through <code>URLConnection</code></p><p>Where it doesn't works, i resolve with</p><pre><code>grant {     permission java.security.AllPermission; };</code></pre><p>in <pre>java.policy</pre> but i would like to avoid to update every PC.</p><p>Could be a <code>port</code> (8081) issue? What should I investigate?</p>"
"<p>We have a Java application that uses RxTx to update the firmware of our game console. To avoid security alerts when the users starts the Java application on our website through WebStart we have bought a trusted certificate and signed the application with that. All checks indicate that it is successfully signed and if I launch the application via Safari on my Mac(OS X 10.6.8) with Java 1.6.0_41 it starts without any complains.</p><p>But if I launch it using IE9 on a Windows 8 machine I get an alert saying ""Do you want to run this application? This application will run with unrestricted access which may put your computer and personal information at risk. Run this application only if you trust the publisher. This application's digital signature has expired. More Information"".</p><p>If I click the More Information I get ""This application will run with unrestricted access to your personal files and other facilities(webcam, microphone) on your computer.</p><p>Although the application has a digital signature, the application's associated file(JNLP) does not have one. A digital signature ensures that a file is from the vendor and that it has not been altered.</p><p>The digital signature was generated with a trusted certificate.""I have tried to find a solution how to not get this message and think what I need to do is sign the JNLP file(i.e. copy it into the jar as pointed out <a href=""https://www.servoy.com/forum/viewtopic.php?f=6&amp;t=15329#p82360"" rel=""nofollow"">here</a>) but what I cannot find is how to get NetBeans to do that! I'm using NetBeans 6.9.1. Anyone know how to do this and if it is enough to sign the JNLP?</p><p>To verify that the file was correctly signed I did the following:</p><pre><code>jarsigner -verify -certs -verbose OribooDesktopClient.jar     6396 Thu Feb 28 17:14:14 CET 2013 META-INF/MANIFEST.MF    6354 Thu Feb 28 17:14:14 CET 2013 META-INF/MOVINTOF.SF    1843 Thu Feb 28 17:14:14 CET 2013 META-INF/MOVINTOF.RSA       0 Thu Feb 28 17:07:28 CET 2013 META-INF/       0 Thu Feb 28 17:07:26 CET 2013 oribooDesktopClient/       0 Thu Feb 28 17:07:26 CET 2013 oribooDesktopClient/resources/       0 Thu Feb 28 17:07:26 CET 2013 oribooDesktopClient/resources/busyicons/sm      3912 Thu Feb 28 17:07:26 CET 2013 oribooDesktopClient/BBDatabase.class  X.509, CN=Movinto fun AB, O=Movinto fun AB, STREET=?rev?gen 138, L=?re, ST=J?mtland, OID.2.5.4.17=83013, C=SE  [certificate is valid from 2/28/13 1:00 AM to 3/1/14 12:59 AM]sm      2497 Thu Feb 28 17:07:26 CET 2013 oribooDesktopClient/Binary.class  X.509, CN=Movinto fun AB, O=Movinto fun AB, STREET=?rev?gen 138, L=?re, ST=J?mtland, OID.2.5.4.17=83013, C=SE  [certificate is valid from 2/28/13 1:00 AM to 3/1/14 12:59 AM]....</code></pre>"
"<p>i have three java based web application app1,app2 and app3 at production. All 3 are verified by verified CA's and hosted on 3 different web servers and on https. app1,app2 is verified by secure trust.app3 is verified by trustwave .</p><p>Below is the  hierarchy of certificates of certificates ,i can see when i hit any of these app thru web browser.</p><p>app1,app2 certificate hirerarchy is same .e</p><pre><code> Entrust.net Secure Server Certification Authority---&gt; SecureTrust CA-------&gt;*.myAppDomain.com</code></pre><p>app3 certificate hirerarchy is </p><pre><code>           Entrust.net Secure Server Certification Authority---&gt; SecureTrust CA-------&gt;TrustWave Organization Validation CA, L-------&gt;*.myApp3.com</code></pre><p>Now  when app1 connect to app2 , works fine. But when app1 connects to app3 gets below exception</p><pre><code>   javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed:    sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target</code></pre><p>Now i had a look on cacert file(i.e trust store) inside jdk on web server hosting app1 . I tried to found the entries for Entrust,SecureTrust,TrustWave but found only entries like entrustevca, entrust2048ca etc. So if i go by the logic that  if root certificate (which is Entrust for both the applications app2 and app3 ) lies in trust store of contacting application(app3) ,which i can see in cacert file on app3 ,then i should not get the above mentioned error when app1 tries  to contact app3 thru httpsURLConnection. <strong>I am not gettting the cause of this? i am not sure do we need to include the trustwave also , though the root certificate i.e Entrust which internally authenticate trustwave already there?</strong></p><p><strong>If i need to include trustwave certificate(used by app2) in cacert file on app3 then by that logic i should also inlcude        securetrust(used by app2) in cacert file on app3 but it is working Fine?</strong></p>"
"<p>I have a simple test applet that's supposed to draw a little triangle (and works fine using <code>appletviewer Triangle.class</code> from the command line), but when I try to view <code>Triangle.htm</code> in my browser, I get this message (from Java itself, as far as I can tell, not my Firefox or Chrome):</p><blockquote>  <p><strong>""Your security settings have blocked a local application from running.""</strong></p></blockquote><p>However, I can't figure out what settings to change. I tried just putting the general settings at their lowest (called ""medium"" ha ha what is this like cup sizes in a coffee shop-- Oh. Right.) but that didn't work, and if the solution is buried somewhere in the more advanced options, it's painfully non-obvious to me... :/</p><p>This question <em>sounded</em> like my problem:</p><p><a href=""https://stackoverflow.com/questions/16196425/java-error-your-security-settings-have-blocked-a-local-application-from-runnin"">Java Error: &quot;Your security settings have blocked a local application from running&quot;</a></p><p>But the original poster said, ""Resolved: the problem was that the compiler used JDK6 instead of JDK7.""</p><p>And I checked I had the latest version before re-compiling the class file:</p><pre><code>&gt; java -versionjava version ""1.7.0_25""Java(TM) SE Runtime Environment (build 1.7.0_25-b17)Java HotSpot(TM) Client VM (build 23.25-b01, mixed mode, sharing)&gt; javac Triangle.java</code></pre><p>Anyway, can anyone see if they get the same problem and tell me how you fix it?</p><p>For easy replication, this is the source of the class file:</p><p><code>Triangle.java</code>:</p><pre><code>import java.awt.*;import java.applet.Applet;public class Triangle extends Applet {    public void paint (Graphics g){        int bottomX=80;        int bottomY=200;        int base=100;        int height=100;        g.drawLine(bottomX,bottomY,bottomX+base,bottomY);        g.drawLine(bottomX+base,bottomY,bottomX+base/2,bottomY-height);        g.drawLine(bottomX+base/2,bottomY-height, bottomX,bottomY);    }}</code></pre><p>And this is the htm that's in the folder with the class file:</p><p><code>Triangle.htm</code>:</p><pre><code>&lt;applet code=""Triangle.class"" width=400 height=400&gt;&lt;/applet&gt;</code></pre>"
"<p><strong>How to modify Java Control Panel selections (corresponding to deployment.properties file) from windows command prompt?</strong>Specifically, I am looking for command(s) which can effect change in <code>""Action for local applets""</code> selection, in <code>""Custom Security Level Settings""</code> window <em>(click the ""Settings..."" button next to ""Custom"" setting for the ""Security Level"" slider in the Security tab in Java Control Panel)</em>, from <code>""Prompt user""</code> to <code>""Run without prompt""</code>. This setting's default value changed with update 11 of Java 7 and it interferes with operation of an automated-test program, which I am fixing now, by having a Security Warning dialog window pop-up when IE starts java.exe, unless this Java Control Panel setting is adjusted a priori. This test program launches IE to run a local Java applet, which is written using AWT, and which doesn't access any websites.</p><p>Note, this problem has been discussed recently -- see <a href=""https://service.parachat.com/knowledgebase/273/I-see-a-Do-you-want-to-run-this-application-security-warning.html"" rel=""nofollow"">https://service.parachat.com/knowledgebase/273/I-see-a-Do-you-want-to-run-this-application-security-warning.html</a></p><p>For my task, modifying this Java Control Panel setting manually is the least desirable way to solve the problem because the program, which I am fixing, is a part of an automated test suite, which is deployed on many machines, and requiring manual intervention makes the deployment process error-prone. I need these commands to run from a windows command prompt batch file.</p><p>I found that these security level selections are recorded in Java deployment.properties file and in 2 Windows registry under keys with names ending in <code>""Software\JavaSoft\DeploymentProperties"".</code>deployment.properties file is discussed comprehensively in <a href=""http://docs.oracle.com/javase/7/docs/technotes/guides/deployment/deployment-guide/properties.html"" rel=""nofollow"">Oracle Java SE Documentation ""Deployment Configuration File and Properties""</a> but nothing obvious is mentioned about <code>""Action for local applets""</code>, maybe because this property is a recent addition (?)When I adjust Java Security Level and <code>""Action for local applets""</code> in the Java Control Panel, I see the changes reflected in the deployment.properties file as well as in the DeploymentProperties registry keys.</p><p>So I can do the following:</p><ol><li>adjust the deployment.properties file via script <em>(saving the original)</em></li><li>start Java Control Panel via script -- I observed that this copies the updates from the deployment.properties file to the registry keys DeploymentProperties</li><li><p>terminate the javaw process which runs the Java Control Panel</p><ul><li>then run the program which uses my local Java applet within IE</li><li>then revert the deployment.properties file to the original, start Java Control Panel via script, and terminate the javaw process which runs the Java Control Panel.</li></ul></li></ol><p>I also tried it vice versa -- update the registry key -- but the file does not change and Java Control Panel reverts the registry keys' value set back to agree with the unmodified deployment.properties file! So updating the registry keys is a <em>wrong</em> way to do it.</p><p><strong>Is there a better way to do this?</strong> My 3-step solution above (to modify the properties) is a kluge for what it is meant to accomplish. <strong>Is there a Java command-line utility which can modify a given deployment property?</strong> Is there a way to pass these deployment properties to JVM via applet tag's attributes, to be effective only within the given Java applet?</p><p>I used Windows XP (both 32-bit and 64-bit) and Windows 7 (64-bit) and Internet Explorer 7, 8 and 9. It would be good to have a (simple) solution which works on Windows XP, Windows Vista, Windows 7 and Windows 8.</p>"
<p>I update Java 6 to Java 8u25 and now appear two messages:</p><p><strong>First message:</strong> Do you want to run this application? Name: ----.jar</p><p><strong>Second message:</strong> Warning - Unavailable Version of Java Requested:This application would like to use a version of Java (1.6) that is not intalled on your system.</p><p>These messages appear when a client run the java application (jnlp) and I would like to disable or hide their. The clients download the java application from a server.</p><p>I don't know if there are commands to disable their or with windows registry. </p><p>I know that there is a file called <strong>deployment.properties</strong> to add or remove parameters but I do not think it works in my case.</p>
"<p><a href=""https://stackoverflow.com/questions/23270818/application-blocked-by-security-settings-error-on-client-windows8-os"">Application blocked by security settings error on client&#39; Windows8 OS</a> </p><p>I checked above question but it didn't help me so looking for other solution.</p><p>Few days back our code signing certificate for applet is expired. We renewed it and I created new jar again and signed this applet with renewed certificate and now I'm getting an exception.</p><pre><code>com.sun.deploy.security.BlockedException: Your security settings have blocked an application signed with an expired or not-yet-valid certificate from running    at com.sun.deploy.security.SandboxSecurity.showBlockedDialog(Unknown Source)    at com.sun.deploy.security.TrustDecider.askUser(Unknown Source)    at com.sun.deploy.security.TrustDecider.validateChain(Unknown Source)    at com.sun.deploy.security.TrustDecider.isAllPermissionGranted(Unknown Source)    at sun.plugin2.applet.Plugin2ClassLoader.isTrustedByTrustDecider(Unknown Source)    at sun.plugin2.applet.Plugin2ClassLoader.getTrustedCodeSources(Unknown Source)    at com.sun.deploy.security.CPCallbackHandler$ParentCallback.strategy(Unknown Source)    at com.sun.deploy.security.CPCallbackHandler$ParentCallback.openClassPathElement(Unknown Source)    at com.sun.deploy.security.DeployURLClassPath$JarLoader.getJarFile(Unknown Source)    at com.sun.deploy.security.DeployURLClassPath$JarLoader.access$1000(Unknown Source)    at com.sun.deploy.security.DeployURLClassPath$JarLoader$1.run(Unknown Source)    at java.security.AccessController.doPrivileged(Native Method)    at com.sun.deploy.security.DeployURLClassPath$JarLoader.ensureOpen(Unknown Source)    at com.sun.deploy.security.DeployURLClassPath$JarLoader.&lt;init&gt;(Unknown Source)    at com.sun.deploy.security.DeployURLClassPath$3.run(Unknown Source)    at java.security.AccessController.doPrivileged(Native Method)    at com.sun.deploy.security.DeployURLClassPath.getLoader(Unknown Source)    at com.sun.deploy.security.DeployURLClassPath.getLoader(Unknown Source)    at com.sun.deploy.security.DeployURLClassPath.getResource(Unknown Source)    at sun.plugin2.applet.Plugin2ClassLoader$2.run(Unknown Source)    at java.security.AccessController.doPrivileged(Native Method)    at sun.plugin2.applet.Plugin2ClassLoader.findClassHelper(Unknown Source)    at sun.plugin2.applet.Applet2ClassLoader.findClass(Unknown Source)    at sun.plugin2.applet.Plugin2ClassLoader.loadClass0(Unknown Source)    at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)    at sun.plugin2.applet.Plugin2ClassLoader.loadClass0(Unknown Source)    at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)    at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)    at java.lang.ClassLoader.loadClass(Unknown Source)    at sun.plugin2.applet.Plugin2ClassLoader.loadCode(Unknown Source)    at sun.plugin2.applet.Plugin2Manager.initAppletAdapter(Unknown Source)    at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Unknown Source)    at java.lang.Thread.run(Unknown Source)</code></pre><p>I removed all existing certificate from Java Control Panel and I open our website where I'm getting new certificate details in applet. Latest expiry date but when I click on <code>Run</code> its throwing an exception.</p><p><img src=""https://i.stack.imgur.com/gIRSz.png"" alt=""enter image description here""></p><p>I checked Java Control Panel again then its showing old certificate why new certificate is not used by Java?</p><p><img src=""https://i.stack.imgur.com/sgeiO.png"" alt=""enter image description here""></p>"
"<p>When launching my program the next error pops out</p><blockquote>  <p>java.lang.NoClassDefFoundError: Could not initialize class javax.crypto.SunJCE_b</p></blockquote><p>which means this class is missing although I've found this class manually, works via jar/ide but doesn't works prefectly via service.</p><p>Maybe I need to make a few modifications? but which?Thanks in advance</p>"
"<p>Do I have to do anything to activate Tomcat handling the call to j_security_check? The config &amp; HTML code is below. I am getting this error:</p><p><strong>Error Message</strong></p><p><em>type</em> Status report</p><p><em>message</em> /(context path)/ProviderManager/j_security_check</p><p><em>description</em> The requested resource (/(context path)/ProviderManager/j_security_check) is not available.</p><p><strong>web.xml</strong></p><pre class=""lang-xml prettyprint-override""><code>&lt;?xml version=""1.0"" encoding=""UTF-8""?&gt;&lt;web-app version=""3.0"" xmlns=""http://java.sun.com/xml/ns/javaee"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xsi:schemaLocation=""http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd""&gt;    &lt;session-config&gt;        &lt;session-timeout&gt;            30        &lt;/session-timeout&gt;    &lt;/session-config&gt;    &lt;security-constraint&gt;        &lt;display-name&gt;Constraint1&lt;/display-name&gt;        &lt;web-resource-collection&gt;            &lt;web-resource-name&gt;ProviderManager&lt;/web-resource-name&gt;            &lt;description/&gt;            &lt;url-pattern&gt;/ProviderManager/*&lt;/url-pattern&gt;        &lt;/web-resource-collection&gt;        &lt;auth-constraint&gt;            &lt;description/&gt;            &lt;role-name&gt;tomcat&lt;/role-name&gt;        &lt;/auth-constraint&gt;    &lt;/security-constraint&gt;    &lt;login-config&gt;        &lt;auth-method&gt;FORM&lt;/auth-method&gt;        &lt;form-login-config&gt;            &lt;form-login-page&gt;/ProviderManager/login.jsp&lt;/form-login-page&gt;            &lt;form-error-page&gt;/ProviderManager/error.jsp&lt;/form-error-page&gt;        &lt;/form-login-config&gt;    &lt;/login-config&gt;    &lt;security-role&gt;        &lt;description/&gt;        &lt;role-name&gt;tomcat&lt;/role-name&gt;    &lt;/security-role&gt;&lt;/web-app&gt;</code></pre><p><strong>tomcat-users.xml</strong></p><pre class=""lang-xml prettyprint-override""><code>&lt;tomcat-users&gt;  &lt;role rolename=""tomcat""/&gt;  &lt;role rolename=""role1""/&gt;  &lt;user username=""tomcat"" password=""tomcat"" roles=""tomcat""/&gt;  &lt;user username=""both"" password=""tomcat"" roles=""tomcat,role1""/&gt;  &lt;user username=""role1"" password=""tomcat"" roles=""role1""/&gt;  &lt;user username=""ide"" password=""mgPNx5x5"" roles=""manager-script,admin""/&gt;&lt;/tomcat-users&gt;</code></pre><p><strong>login.html</strong></p><pre class=""lang-xml prettyprint-override""><code>&lt;%@page contentType=""text/html"" pageEncoding=""UTF-8""%&gt;&lt;!DOCTYPE html&gt;&lt;html&gt;    &lt;head&gt;        &lt;meta http-equiv=""Content-Type"" content=""text/html; charset=UTF-8""&gt;        &lt;title&gt;JSP Page&lt;/title&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;form action=""j_security_check"" method=""POST""&gt;           Username:&lt;input type=""text"" name=""j_username""&gt;&lt;br&gt;           Password:&lt;input type=""password"" name=""j_password""&gt;           &lt;input type=""submit"" value=""Login""&gt;        &lt;/form&gt;    &lt;/body&gt;&lt;/html&gt;</code></pre><p>Thanks-in-advance,</p><p>Guido</p>"

